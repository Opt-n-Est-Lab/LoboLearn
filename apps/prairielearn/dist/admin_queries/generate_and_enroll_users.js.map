{"version":3,"file":"generate_and_enroll_users.js","sourceRoot":"","sources":["../../src/admin_queries/generate_and_enroll_users.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,wBAAwB,EAAE,MAAM,+BAA+B,CAAC;AACzE,OAAO,EAAE,gBAAgB,EAAE,MAAM,qBAAqB,CAAC;AACvD,OAAO,EAAE,sBAAsB,EAAE,MAAM,yBAAyB,CAAC;AAIjE,MAAM,OAAO,GAAG;IACd,SAAS;IACT,KAAK;IACL,MAAM;IACN,WAAW;IACX,QAAQ;IACR,oBAAoB;IACpB,iBAAiB;CAClB,CAAC;AAEF,MAAM,CAAC,OAAO,CAAC,KAAK,WAAW,EAC7B,KAAK,EACL,kBAAkB,GAInB;IACC,MAAM,eAAe,GAAG,MAAM,wBAAwB,CAAC,kBAAkB,CAAC,CAAC;IAC3E,IAAI,CAAC,eAAe,EAAE,CAAC;QACrB,OAAO,EAAE,IAAI,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC;IAC/B,CAAC;IACD,MAAM,MAAM,GAAG,MAAM,gBAAgB,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;IACjE,MAAM,KAAK,GAAG,MAAM,sBAAsB,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,kBAAkB,EAAE,CAAC,CAAC;IACzF,OAAO;QACL,IAAI,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC;YAC3C,OAAO;YACP,GAAG;YACH,IAAI;YACJ,SAAS,EAAE,MAAM,CAAC,EAAE;YACpB,MAAM,EAAE,MAAM,CAAC,UAAU;YACzB,kBAAkB;YAClB,eAAe,EAAE,eAAe,CAAC,UAAU;SAC5C,CAAC,CAAC;QACH,OAAO;KACR,CAAC;AACJ,CAAC","sourcesContent":["import { selectCourseInstanceById } from '../models/course-instances.js';\nimport { selectCourseById } from '../models/course.js';\nimport { generateAndEnrollUsers } from '../models/enrollment.js';\n\nimport type { AdministratorQueryResult } from './util.js';\n\nconst columns = [\n  'user_id',\n  'uid',\n  'name',\n  'course_id',\n  'course',\n  'course_instance_id',\n  'course_instance',\n];\n\nexport default async function ({\n  count,\n  course_instance_id,\n}: {\n  count: string;\n  course_instance_id: string;\n}): Promise<AdministratorQueryResult> {\n  const course_instance = await selectCourseInstanceById(course_instance_id);\n  if (!course_instance) {\n    return { rows: [], columns };\n  }\n  const course = await selectCourseById(course_instance.course_id);\n  const users = await generateAndEnrollUsers({ count: Number(count), course_instance_id });\n  return {\n    rows: users.map(({ user_id, uid, name }) => ({\n      user_id,\n      uid,\n      name,\n      course_id: course.id,\n      course: course.short_name,\n      course_instance_id,\n      course_instance: course_instance.short_name,\n    })),\n    columns,\n  };\n}\n"]}