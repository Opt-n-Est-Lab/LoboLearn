{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/api/trpc/index.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,WAAW,MAAM,+BAA+B,CAAC;AAC7D,OAAO,EAAE,MAAM,EAAE,MAAM,SAAS,CAAC;AAEjC,OAAO,EAAE,MAAM,EAAE,MAAM,sBAAsB,CAAC;AAC9C,OAAO,KAAK,MAAM,MAAM,sBAAsB,CAAC;AAE/C,OAAO,EAAE,iBAAiB,EAAE,MAAM,iCAAiC,CAAC;AACpE,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAC;AAE1C,OAAO,EAAE,iBAAiB,EAAE,CAAC;AAG7B,MAAM,MAAM,GAAG,MAAM,EAAE,CAAC;AAExB,MAAM,CAAC,GAAG,CACR,eAAe,EACf,WAAW,CAAC,uBAAuB,CAAC;IAClC,MAAM,EAAE,iBAAiB;IACzB,aAAa;IACb,OAAO,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE;QACrB,IAAI,KAAK,CAAC,IAAI,KAAK,uBAAuB,EAAE,CAAC;YAC3C,MAAM,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;YAC/B,MAAM,CAAC,KAAK,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;QACpC,CAAC;IACH,CAAC;CACF,CAAC,CACH,CAAC;AAEF,eAAe,MAAM,CAAC","sourcesContent":["import * as trpcExpress from '@trpc/server/adapters/express';\nimport { Router } from 'express';\n\nimport { logger } from '@prairielearn/logger';\nimport * as Sentry from '@prairielearn/sentry';\n\nimport { courseFilesRouter } from './routers/course-files/index.js';\nimport { createContext } from './trpc.js';\n\nexport { courseFilesRouter };\nexport type CourseFilesRouter = typeof courseFilesRouter;\n\nconst router = Router();\n\nrouter.use(\n  '/course_files',\n  trpcExpress.createExpressMiddleware({\n    router: courseFilesRouter,\n    createContext,\n    onError: ({ error }) => {\n      if (error.code === 'INTERNAL_SERVER_ERROR') {\n        Sentry.captureException(error);\n        logger.error('tRPC error', error);\n      }\n    },\n  }),\n);\n\nexport default router;\n"]}