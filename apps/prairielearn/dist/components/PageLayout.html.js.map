{"version":3,"file":"PageLayout.html.js","sourceRoot":"","sources":["../../src/components/PageLayout.html.ts"],"names":[],"mappings":"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","sourcesContent":["import clsx from 'clsx';\n\nimport { compiledScriptTag, compiledStylesheetTag } from '@prairielearn/compiled-assets';\nimport { type HtmlValue, html } from '@prairielearn/html';\n\nimport { getNavPageTabs } from '../lib/navPageTabs.js';\n\nimport { AssessmentNavigation } from './AssessmentNavigation.html.js';\nimport { HeadContents } from './HeadContents.html.js';\nimport { Navbar } from './Navbar.html.js';\nimport type { NavContext } from './Navbar.types.js';\nimport { ContextNavigation } from './NavbarContext.html.js';\nimport { SideNav } from './SideNav.html.js';\n\nexport function PageLayout({\n  resLocals,\n  pageTitle,\n  navContext,\n  options = {},\n  headContent,\n  preContent,\n  content,\n  postContent,\n}: {\n  /** The locals object from the Express response. */\n  resLocals: Record<string, any>;\n  /** The title of the page in the browser. */\n  pageTitle: string;\n  /** The information used to configure the navbar. */\n  navContext: NavContext;\n  options?: {\n    /** Whether the main container should span the entire width of the page. */\n    fullWidth?: boolean;\n    /** Whether the main container should have a bottom margin of mb-4 in Bootstrap. */\n    marginBottom?: boolean;\n    /** A note to display after the pageTitle, shown in parenthesis. */\n    pageNote?: string;\n    /** Enables an htmx extension for an element and all its children */\n    hxExt?: string;\n    /** Sets the html and body tag heights to 100% */\n    fullHeight?: boolean;\n  };\n  /** Include scripts and other additional head content here. */\n  headContent?: HtmlValue;\n  /** The content of the page in the body before the main container. */\n  preContent?: HtmlValue;\n  /** The main content of the page within the main container. */\n  content: HtmlValue;\n  /** The content of the page in the body after the main container. */\n  postContent?: HtmlValue;\n}) {\n  const marginBottom = options.marginBottom ?? true;\n\n  if (resLocals.has_enhanced_navigation) {\n    // The side navbar is only available if the user is in a page within a course or course instance.\n    const sideNavEnabled =\n      resLocals.course && navContext.type !== 'student' && navContext.type !== 'public';\n\n    const sideNavExpanded = sideNavEnabled && resLocals.side_nav_expanded;\n\n    let showContextNavigation = true;\n\n    // ContextNavigation is shown if either:\n    // The side nav is not shown.\n    // The side nav is shown and additional navigation capabilities are needed, such as on the course admin settings pages.\n    if (navContext.page === 'course_admin') {\n      const navPageTabs = getNavPageTabs(true);\n\n      const courseAdminSettingsNavSubPages = navPageTabs.course_admin\n        ?.map((tab) => tab.activeSubPage)\n        .flat();\n\n      // If the user is on a course admin settings subpage, show ContextNavigation\n      if (navContext.subPage && courseAdminSettingsNavSubPages?.includes(navContext.subPage)) {\n        showContextNavigation = true;\n      } else {\n        showContextNavigation = false;\n      }\n    } else if (navContext.page === 'instance_admin') {\n      const navPageTabs = getNavPageTabs(true);\n\n      const instanceAdminSettingsNavSubPages = navPageTabs.instance_admin\n        ?.map((tab) => tab.activeSubPage)\n        .flat();\n\n      // If the user is on a instance admin settings subpage, show ContextNavigation\n      if (navContext.subPage && instanceAdminSettingsNavSubPages?.includes(navContext.subPage)) {\n        showContextNavigation = true;\n      } else {\n        showContextNavigation = false;\n      }\n    }\n\n    return html`\n      <!doctype html>\n      <html lang=\"en\">\n        <head>\n          ${HeadContents({\n            resLocals,\n            pageTitle,\n            pageNote: options.pageNote,\n          })}\n          ${compiledStylesheetTag('pageLayout.css')} ${headContent}\n          ${sideNavEnabled ? compiledScriptTag('pageLayoutClient.ts') : ''}\n        </head>\n        <body\n          class=\"${options.fullHeight ? 'd-flex flex-column h-100' : ''}\"\n          hx-ext=\"${options.hxExt ?? ''}\"\n        >\n          <div\n            id=\"app-container\"\n            class=\"${clsx(\n              'app-container',\n              sideNavEnabled && 'side-nav-enabled',\n              !sideNavExpanded && 'collapsed',\n            )}\"\n          >\n            <div class=\"app-top-nav\">\n              ${Navbar({\n                resLocals,\n                navPage: navContext.page,\n                navSubPage: navContext.subPage,\n                navbarType: navContext.type,\n                isInPageLayout: true,\n              })}\n            </div>\n            ${sideNavEnabled\n              ? html`\n                  <div class=\"app-side-nav\">\n                    ${SideNav({\n                      resLocals,\n                      page: navContext.page,\n                      subPage: navContext.subPage,\n                    })}\n                  </div>\n                `\n              : ''}\n            <div class=\"${sideNavEnabled ? 'app-main' : ''}\">\n              <div class=\"${sideNavEnabled ? 'app-main-container' : ''}\">\n                ${resLocals.assessment &&\n                resLocals.assessments &&\n                AssessmentNavigation({\n                  subPage: navContext.subPage,\n                  courseInstance: resLocals.course_instance,\n                  assessment: resLocals.assessment,\n                  assessments: resLocals.assessments,\n                })}\n                ${showContextNavigation\n                  ? ContextNavigation({\n                      resLocals,\n                      navPage: navContext.page,\n                      navSubPage: navContext.subPage,\n                    })\n                  : ''}\n                ${preContent}\n                <main\n                  id=\"content\"\n                  class=\"${clsx(\n                    options.fullWidth ? 'container-fluid' : 'container',\n                    marginBottom && 'mb-4',\n                    options.fullHeight && 'flex-grow-1',\n                    'pt-3',\n                    sideNavEnabled && 'px-3',\n                  )}\"\n                >\n                  ${content}\n                </main>\n                ${postContent}\n              </div>\n            </div>\n          </div>\n        </body>\n      </html>\n    `.toString();\n  } else {\n    return html`\n      <!doctype html>\n      <html lang=\"en\" class=\"${options.fullHeight ? 'h-100' : ''}\">\n        <head>\n          ${HeadContents({\n            resLocals,\n            pageTitle,\n            pageNote: options.pageNote,\n          })}\n          ${headContent}\n        </head>\n        <body\n          class=\"${options.fullHeight ? 'd-flex flex-column h-100' : ''}\"\n          hx-ext=\"${options.hxExt ?? ''}\"\n        >\n          ${Navbar({\n            resLocals,\n            navPage: navContext.page,\n            navSubPage: navContext.subPage,\n            navbarType: navContext.type,\n          })}\n          ${preContent}\n          <main\n            id=\"content\"\n            class=\"\n            ${options.fullWidth ? 'container-fluid' : 'container'} \n            ${marginBottom ? 'mb-4' : ''}\n            ${options.fullHeight ? 'flex-grow-1' : ''}\n          \"\n          >\n            ${content}\n          </main>\n          ${postContent}\n        </body>\n      </html>\n    `.toString();\n  }\n}\n"]}