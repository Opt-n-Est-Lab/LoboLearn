{"version":3,"file":"administratorInstitutionCourse.html.js","sourceRoot":"","sources":["../../../../src/ee/pages/administratorInstitutionCourse/administratorInstitutionCourse.html.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,CAAC,EAAE,MAAM,KAAK,CAAC;AAExB,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;AAE1C,OAAO,EAAE,UAAU,EAAE,MAAM,wCAAwC,CAAC;AACpE,OAAO,EAAe,oBAAoB,EAAoB,MAAM,0BAA0B,CAAC;AAE/F,MAAM,CAAC,MAAM,uBAAuB,GAAG,CAAC,CAAC,MAAM,CAAC;IAC9C,eAAe,EAAE,oBAAoB;IACrC,gBAAgB,EAAE,CAAC,CAAC,MAAM,EAAE;CAC7B,CAAC,CAAC;AAGH,MAAM,UAAU,8BAA8B,CAAC,EAC7C,WAAW,EACX,MAAM,EACN,IAAI,EACJ,SAAS,GAMV;IACC,OAAO,UAAU,CAAC;QAChB,SAAS,EAAE,EAAE,GAAG,SAAS,EAAE,WAAW,EAAE;QACxC,SAAS,EAAE,GAAG,MAAM,CAAC,UAAU,sBAAsB;QACrD,UAAU,EAAE;YACV,IAAI,EAAE,2BAA2B;YACjC,IAAI,EAAE,2BAA2B;YACjC,OAAO,EAAE,SAAS;SACnB;QACD,UAAU,EAAE,IAAI,CAAA;;;;qDAIiC,WAAW,CAAC,EAAE;;;cAGrD,MAAM,CAAC,UAAU,KAAK,MAAM,CAAC,KAAK;;;;KAI3C;QACD,OAAO,EAAE,IAAI,CAAA;+BACc,MAAM,CAAC,EAAE;;;;;;;;;;;;;qBAanB,WAAW,CAAC,gCAAgC;;;;;;;;;;;;;;;;qBAgB5C,WAAW,CAAC,uBAAuB;;;;;;;;;;;;;;;;qBAgBnC,MAAM,CAAC,gCAAgC;;;;;;;;;;;;;;;;;qBAiBvC,MAAM,CAAC,uBAAuB;;;;;;;;0DAQO,SAAS,CAAC,YAAY;;;;;;;;;;;;;;;;;;;;;;;;;cAyBlE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,eAAe,EAAE,gBAAgB,EAAE,EAAE,EAAE;YACnD,OAAO,IAAI,CAAA;;;;4DAImC,WAAW,CAAC,EAAE,oBAAoB,eAAe,CAAC,EAAE;;wBAExF,eAAe,CAAC,UAAU,IAAI,GAAG,KAAK,eAAe,CAAC,SAAS,IAAI,GAAG;;;wBAGtE,gBAAgB;;sBAElB,eAAe,CAAC,gBAAgB;gBAClC,MAAM,CAAC,gCAAgC;gBACvC,WAAW,CAAC,gCAAgC;;;eAGjD,CAAC;QACJ,CAAC,CAAC;;;;KAIT;KACF,CAAC,CAAC;AACL,CAAC","sourcesContent":["import { z } from 'zod';\n\nimport { html } from '@prairielearn/html';\n\nimport { PageLayout } from '../../../components/PageLayout.html.js';\nimport { type Course, CourseInstanceSchema, type Institution } from '../../../lib/db-types.js';\n\nexport const CourseInstanceRowSchema = z.object({\n  course_instance: CourseInstanceSchema,\n  enrollment_count: z.number(),\n});\ntype CourseInstanceRow = z.infer<typeof CourseInstanceRowSchema>;\n\nexport function AdministratorInstitutionCourse({\n  institution,\n  course,\n  rows,\n  resLocals,\n}: {\n  institution: Institution;\n  course: Course;\n  rows: CourseInstanceRow[];\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    resLocals: { ...resLocals, institution },\n    pageTitle: `${course.short_name} - Institution Admin`,\n    navContext: {\n      type: 'administrator_institution',\n      page: 'administrator_institution',\n      subPage: 'courses',\n    },\n    preContent: html`\n      <nav class=\"container\" aria-label=\"Breadcrumbs\">\n        <ol class=\"breadcrumb\">\n          <li class=\"breadcrumb-item\">\n            <a href=\"/pl/administrator/institution/${institution.id}/courses\">Courses</a>\n          </li>\n          <li class=\"breadcrumb-item active\" aria-current=\"page\">\n            ${course.short_name}: ${course.title}\n          </li>\n        </ol>\n      </nav>\n    `,\n    content: html`\n      <p><a href=\"/pl/course/${course.id}\">View as instructor</a></p>\n\n      <h2 class=\"h4\">Limits</h2>\n      <form method=\"POST\" class=\"mb-3\">\n        <div class=\"mb-3\">\n          <label class=\"form-label\" for=\"institution_course_instance_enrollment_limit\">\n            Course instance enrollment limit for institution\n          </label>\n          <input\n            type=\"number\"\n            disabled\n            class=\"form-control\"\n            id=\"institution_course_instance_enrollment_limit\"\n            value=\"${institution.course_instance_enrollment_limit}\"\n          />\n          <small class=\"form-text text-muted\">\n            This limit applies to all course instances without a specific enrollment limit set.\n          </small>\n        </div>\n\n        <div class=\"mb-3\">\n          <label class=\"form-label\" for=\"institution_yearly_enrollment_limit\">\n            Yearly enrollment limit for institution\n          </label>\n          <input\n            type=\"number\"\n            disabled\n            class=\"form-control\"\n            id=\"institution_yearly_enrollment_limit\"\n            value=\"${institution.yearly_enrollment_limit}\"\n          />\n          <small class=\"form-text text-muted\">\n            This limit applies to all enrollments in this course's institution.\n          </small>\n        </div>\n\n        <div class=\"mb-3\">\n          <label class=\"form-label\" for=\"course_instance_enrollment_limit\">\n            Course instance enrollment limit override\n          </label>\n          <input\n            type=\"number\"\n            class=\"form-control\"\n            id=\"course_instance_enrollment_limit\"\n            name=\"course_instance_enrollment_limit\"\n            value=\"${course.course_instance_enrollment_limit}\"\n          />\n          <small class=\"form-text text-muted\">\n            This limit will apply to all course instances in this course. If no override is set, the\n            institution-wide limit will be used.\n          </small>\n        </div>\n\n        <div class=\"mb-3\">\n          <label class=\"form-label\" for=\"yearly_enrollment_limit\">\n            Yearly enrollment limit for course\n          </label>\n          <input\n            type=\"number\"\n            class=\"form-control\"\n            id=\"yearly_enrollment_limit\"\n            name=\"yearly_enrollment_limit\"\n            value=\"${course.yearly_enrollment_limit}\"\n          />\n          <small class=\"form-text text-muted\">\n            This limit applies only to this course. It is applied\n            <i><strong>in addition to</strong></i> the institution-wide yearly enrollment limit.\n          </small>\n        </div>\n\n        <input type=\"hidden\" name=\"__csrf_token\" value=\"${resLocals.__csrf_token}\" />\n        <button\n          type=\"submit\"\n          name=\"__action\"\n          value=\"update_enrollment_limits\"\n          class=\"btn btn-primary\"\n        >\n          Save\n        </button>\n      </form>\n\n      <h2 class=\"h4\">Course instances</h2>\n      <div class=\"table-responsive\">\n        <table\n          class=\"table table-hover table-striped table-bordered table\"\n          aria-label=\"Course instances\"\n        >\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th>Enrollments</th>\n              <th>Effective enrollment limit</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${rows.map(({ course_instance, enrollment_count }) => {\n              return html`\n                <tr>\n                  <td>\n                    <a\n                      href=\"/pl/administrator/institution/${institution.id}/course_instance/${course_instance.id}\"\n                    >\n                      ${course_instance.short_name ?? '—'}: ${course_instance.long_name ?? '—'}\n                    </a>\n                  </td>\n                  <td>${enrollment_count}</td>\n                  <td>\n                    ${course_instance.enrollment_limit ??\n                    course.course_instance_enrollment_limit ??\n                    institution.course_instance_enrollment_limit}\n                  </td>\n                </tr>\n              `;\n            })}\n          </tbody>\n        </table>\n      </div>\n    `,\n  });\n}\n"]}