{"version":3,"file":"institutionAdminAdmins.html.js","sourceRoot":"","sources":["../../../../src/ee/pages/institutionAdminAdmins/institutionAdminAdmins.html.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,CAAC,EAAE,MAAM,KAAK,CAAC;AAExB,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;AAE1C,OAAO,EAAE,KAAK,EAAE,MAAM,mCAAmC,CAAC;AAC1D,OAAO,EAAE,UAAU,EAAE,MAAM,wCAAwC,CAAC;AACpE,OAAO,EAAE,iBAAiB,EAAE,MAAM,wBAAwB,CAAC;AAC3D,OAAO,EAEL,8BAA8B,EAC9B,UAAU,GACX,MAAM,0BAA0B,CAAC;AAElC,MAAM,CAAC,MAAM,+BAA+B,GAAG,CAAC,CAAC,MAAM,CAAC;IACtD,IAAI,EAAE,UAAU;IAChB,yBAAyB,EAAE,8BAA8B;CAC1D,CAAC,CAAC;AAGH,MAAM,UAAU,sBAAsB,CAAC,EACrC,WAAW,EACX,IAAI,EACJ,SAAS,EACT,SAAS,GAMV;IACC,OAAO,UAAU,CAAC;QAChB,SAAS,EAAE;YACT,GAAG,SAAS;YACZ,WAAW;SACZ;QACD,SAAS,EAAE,YAAY,WAAW,CAAC,UAAU,EAAE;QAC/C,WAAW,EAAE,CAAC,iBAAiB,CAAC,iCAAiC,CAAC,CAAC;QACnE,UAAU,EAAE;YACV,IAAI,EAAE,aAAa;YACnB,IAAI,EAAE,mBAAmB;YACzB,OAAO,EAAE,QAAQ;SAClB;QACD,OAAO,EAAE,IAAI,CAAA;QACT,UAAU,CAAC,EAAE,IAAI,EAAE,CAAC,IAAI,cAAc,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC,YAAY,EAAE,CAAC;QACxF,gBAAgB,CAAC,EAAE,SAAS,EAAE,SAAS,CAAC,YAAY,EAAE,CAAC;KAC1D;KACF,CAAC,CAAC;AACL,CAAC;AAED,SAAS,UAAU,CAAC,EAAE,IAAI,EAAyC;IACjE,OAAO,IAAI,CAAA;;;;;;;;;;;;;;;QAeL,IAAI,CAAC,MAAM,KAAK,CAAC;QACjB,CAAC,CAAC,IAAI,CAAA;;;;WAIH;QACH,CAAC,CAAC,IAAI,CAAA;;gBAEE,IAAI,CAAC,GAAG,CACR,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAA;;;8BAGC,GAAG,CAAC,IAAI,CAAC,IAAI;iDACM,GAAG,CAAC,IAAI,CAAC,GAAG;;;;;;;;2CAQlB,GAAG,CAAC,IAAI,CAAC,IAAI,KAAK,GAAG,CAAC,IAAI,CAAC,GAAG;2DACd,GAAG,CAAC,yBAAyB,CAAC,EAAE;;;;;iBAK1E,CACF;;WAEJ;;GAER,CAAC;AACJ,CAAC;AAED,SAAS,cAAc,CAAC,EAAE,SAAS,EAAE,SAAS,EAA4C;IACxF,OAAO,KAAK,CAAC;QACX,EAAE,EAAE,gBAAgB;QACpB,KAAK,EAAE,oBAAoB;QAC3B,IAAI,EAAE,IAAI,CAAA;;;;;;;;;;;;;wBAaU,SAAS;;;;;;;;KAQ5B;QACD,MAAM,EAAE,IAAI,CAAA;;wDAEwC,SAAS;;;KAG5D;KACF,CAAC,CAAC;AACL,CAAC;AAED,SAAS,gBAAgB,CAAC,EAAE,SAAS,EAAyB;IAC5D,OAAO,KAAK,CAAC;QACX,EAAE,EAAE,kBAAkB;QACtB,KAAK,EAAE,sBAAsB;QAC7B,IAAI,EAAE,IAAI,CAAA;;;;;;KAMT;QACD,MAAM,EAAE,IAAI,CAAA;;wDAEwC,SAAS;;;;;;;;KAQ5D;KACF,CAAC,CAAC;AACL,CAAC","sourcesContent":["import { z } from 'zod';\n\nimport { html } from '@prairielearn/html';\n\nimport { Modal } from '../../../components/Modal.html.js';\nimport { PageLayout } from '../../../components/PageLayout.html.js';\nimport { compiledScriptTag } from '../../../lib/assets.js';\nimport {\n  type Institution,\n  InstitutionAdministratorSchema,\n  UserSchema,\n} from '../../../lib/db-types.js';\n\nexport const InstitutionAdminAdminsRowSchema = z.object({\n  user: UserSchema,\n  institution_administrator: InstitutionAdministratorSchema,\n});\ntype InstitutionAdminAdminsRow = z.infer<typeof InstitutionAdminAdminsRowSchema>;\n\nexport function InstitutionAdminAdmins({\n  institution,\n  rows,\n  uidsLimit,\n  resLocals,\n}: {\n  institution: Institution;\n  rows: InstitutionAdminAdminsRow[];\n  uidsLimit: number;\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    resLocals: {\n      ...resLocals,\n      institution,\n    },\n    pageTitle: `Admins â€” ${institution.short_name}`,\n    headContent: [compiledScriptTag('institutionAdminAdminsClient.ts')],\n    navContext: {\n      type: 'institution',\n      page: 'institution_admin',\n      subPage: 'admins',\n    },\n    content: html`\n      ${AdminsCard({ rows })} ${AddAdminsModal({ uidsLimit, csrfToken: resLocals.__csrf_token })}\n      ${RemoveAdminModal({ csrfToken: resLocals.__csrf_token })}\n    `,\n  });\n}\n\nfunction AdminsCard({ rows }: { rows: InstitutionAdminAdminsRow[] }) {\n  return html`\n    <div class=\"card mb-4\">\n      <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n        Administrators\n        <button\n          type=\"button\"\n          class=\"btn btn-sm btn-light ms-auto\"\n          data-bs-toggle=\"modal\"\n          data-bs-target=\"#addAdminsModal\"\n        >\n          <i class=\"fa fa-user-plus\" aria-hidden=\"true\"></i>\n          Add administrators\n        </button>\n      </div>\n\n      ${rows.length === 0\n        ? html`\n            <div class=\"card-body\">\n              <div class=\"text-center text-muted\">No institution administrators</div>\n            </div>\n          `\n        : html`\n            <ul class=\"list-group list-group-flush\">\n              ${rows.map(\n                (row) => html`\n                  <li class=\"list-group-item d-flex flex-row align-items-center\">\n                    <div class=\"d-flex flex-column\">\n                      <span>${row.user.name}</span>\n                      <span class=\"text-muted\">${row.user.uid}</span>\n                    </div>\n\n                    <button\n                      class=\"btn btn-sm btn-outline-danger ms-auto js-remove-admin\"\n                      data-bs-toggle=\"modal\"\n                      data-bs-target=\"#removeAdminModal\"\n                      type=\"button\"\n                      data-name-and-uid=\"${row.user.name} (${row.user.uid})\"\n                      data-institution-administrator-id=\"${row.institution_administrator.id}\"\n                    >\n                      Remove\n                    </button>\n                  </li>\n                `,\n              )}\n            </ul>\n          `}\n    </div>\n  `;\n}\n\nfunction AddAdminsModal({ uidsLimit, csrfToken }: { uidsLimit: number; csrfToken: string }) {\n  return Modal({\n    id: 'addAdminsModal',\n    title: 'Add administrators',\n    body: html`\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"addAdminsModalUid\"> UIDs </label>\n        <textarea\n          name=\"uids\"\n          class=\"form-control\"\n          id=\"addAdminsModalUid\"\n          aria-describedby=\"addAdminsModalUidHelp\"\n          placeholder=\"user1@example.com, user2@example.com\"\n          style=\"height: 10vh;\"\n          required\n        ></textarea>\n        <small class=\"form-text text-muted\" id=\"addAdminsModalUidHelp\">\n          Enter up to ${uidsLimit} UIDs separated by commas, semicolons, or whitespace.\n        </small>\n      </div>\n\n      <div class=\"alert alert-warning mb-0\" role=\"alert\">\n        Institution administrators will have full read and write access to all content within this\n        institution. They will also be able to add and remove other administrators.\n      </div>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__action\" value=\"addAdmins\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\n      <button type=\"submit\" class=\"btn btn-primary\">Add administrators</button>\n    `,\n  });\n}\n\nfunction RemoveAdminModal({ csrfToken }: { csrfToken: string }) {\n  return Modal({\n    id: 'removeAdminModal',\n    title: 'Remove administrator',\n    body: html`\n      <p>\n        Are you sure you want to remove\n        <strong><span class=\"js-name-and-uid\"></span></strong>\n        as an administrator of this institution? This will not affect any of their other roles.\n      </p>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__action\" value=\"removeAdmin\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <input\n        type=\"hidden\"\n        name=\"unsafe_institution_administrator_id\"\n        class=\"js-institution-administrator-id\"\n      />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-danger\">Remove administrator</button>\n    `,\n  });\n}\n"]}