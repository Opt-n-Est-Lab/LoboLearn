{"version":3,"file":"lti13CourseNavigation.html.js","sourceRoot":"","sources":["../../../../src/ee/pages/lti13CourseNavigation/lti13CourseNavigation.html.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;AAE1C,OAAO,EAAE,YAAY,EAAE,MAAM,0CAA0C,CAAC;AACxE,OAAO,EAAE,KAAK,EAAE,MAAM,mCAAmC,CAAC;AAC1D,OAAO,EAAE,MAAM,EAAE,MAAM,oCAAoC,CAAC;AAC5D,OAAO,EAAE,MAAM,EAAE,MAAM,wBAAwB,CAAC;AAChD,OAAO,EAAe,MAAM,0BAA0B,CAAC;AACvD,OAAO,EAAE,YAAY,EAAE,MAAM,oBAAoB,CAAC;AAElD,MAAM,UAAU,+BAA+B,CAAC,EAC9C,UAAU,EACV,SAAS,EACT,OAAO,EACP,iBAAiB,GAMlB;IACC,OAAO,IAAI,CAAA;;;;UAIH,YAAY,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,kBAAkB,EAAE,CAAC;;;UAG1D,MAAM,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,yBAAyB,EAAE,CAAC,IAAI,gBAAgB,EAAE;;;;;sBAKnE,UAAU;;;YAGpB,OAAO,CAAC,MAAM,KAAK,CAAC;QACpB,CAAC,CAAC,IAAI,CAAA;;;;mBAIC;QACP,CAAC,CAAC,IAAI,CAAA;;;sEAGoD,SAAS,CAAC,YAAY;;;;;;;;;mDASzC,iBAAiB;;;;;;wBAM5C,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;YAClB,OAAO,IAAI,CAAA,kBAAkB,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,UAAU,KAAK,CAAC,CAAC,KAAK,WAAW,CAAC;QAC5E,CAAC,CAAC;;;;;;;;;;;;;;;;eAgBT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA+BZ,CAAC,QAAQ,EAAE,CAAC;AACf,CAAC;AAED,MAAM,UAAU,6BAA6B,CAAC,EAC5C,UAAU,EACV,SAAS,EACT,QAAQ,GAKT;IACC,OAAO,IAAI,CAAA;;;;UAIH,YAAY,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,kBAAkB,EAAE,CAAC;;;UAG1D,MAAM,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,yBAAyB,EAAE,CAAC;;;;;oDAKf,UAAU;;;uBAGvC,MAAM,CAAC,SAAS;;;;;YAK3B,QAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC;QAC/B,CAAC,CAAC,EAAE;QACJ,CAAC,CAAC,IAAI,CAAA;;;;;;;;;;;wBAWM,QAAQ,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAA,aAAa,IAAI,cAAc,CAAC;;;;eAIpE;;;;GAIZ,CAAC,QAAQ,EAAE,CAAC;AACf,CAAC;AAED,MAAM,UAAU,yBAAyB,CAAC,EACxC,SAAS,EACT,iBAAiB,GAIlB;IACC,OAAO,IAAI,CAAA;;;;UAIH,YAAY,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,kBAAkB,EAAE,CAAC;;;UAG1D,MAAM,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,yBAAyB,EAAE,CAAC;;;;;;;;;;;;;;;;;;yCAkB1B,iBAAiB;;;;;;;;;GASvD,CAAC,QAAQ,EAAE,CAAC;AACf,CAAC;AAED,SAAS,gBAAgB;IACvB,OAAO,KAAK,CAAC;QACX,EAAE,EAAE,mBAAmB;QACvB,KAAK,EAAE,4BAA4B;QACnC,IAAI,EAAE,IAAI,CAAA;;;;;;;;;;;;;;;;;;;;KAoBT;KACF,CAAC,CAAC;AACL,CAAC","sourcesContent":["import { html } from '@prairielearn/html';\n\nimport { HeadContents } from '../../../components/HeadContents.html.js';\nimport { Modal } from '../../../components/Modal.html.js';\nimport { Navbar } from '../../../components/Navbar.html.js';\nimport { config } from '../../../lib/config.js';\nimport { type Course } from '../../../lib/db-types.js';\nimport { STUDENT_ROLE } from '../../lib/lti13.js';\n\nexport function Lti13CourseNavigationInstructor({\n  courseName,\n  resLocals,\n  courses,\n  lti13_instance_id,\n}: {\n  courseName: string;\n  resLocals: Record<string, any>;\n  courses: Course[];\n  lti13_instance_id: string;\n}): string {\n  return html`\n    <!doctype html>\n    <html lang=\"en\">\n      <head>\n        ${HeadContents({ resLocals, pageTitle: 'LTI 1.3 - Course' })}\n      </head>\n      <body>\n        ${Navbar({ resLocals, navPage: 'lti13_course_navigation' })} ${TerminologyModal()}\n        <main id=\"content\" class=\"container mb-4\">\n          <h1>Welcome to PrairieLearn</h1>\n          <p>\n            To finish the integration for your course, you need to connect\n            <strong>${courseName}</strong> with a PrairieLearn course instance.\n          </p>\n\n          ${courses.length === 0\n            ? html`<p>\n                <strong>\n                  You don't have course owner or editor permissions in any PrairieLearn courses.\n                </strong>\n              </p>`\n            : html`\n                <div class=\"mb-3\">\n                  <form method=\"POST\" id=\"link_form\">\n                    <input type=\"hidden\" name=\"__csrf_token\" value=\"${resLocals.__csrf_token}\" />\n\n                    <label class=\"form-label\" for=\"connect_course\">\n                      Select a PrairieLearn course:\n                    </label>\n                    <select\n                      id=\"connect_course\"\n                      class=\"form-select mb-3\"\n                      name=\"unsafe_course_id\"\n                      hx-get=\"/pl/lti13_instance/${lti13_instance_id}/course_navigation/course_instances\"\n                      hx-include=\"#link_form\"\n                      hx-target=\"#course_instances\"\n                      required\n                    >\n                      <option selected disabled value=\"\">Select a course to continue</option>\n                      ${courses.map((c) => {\n                        return html`<option value=\"${c.id}\">${c.short_name}: ${c.title}</option>`;\n                      })}\n                    </select>\n                    <label class=\"form-label\" for=\"course_instances\">\n                      Select a course instance to connect:\n                    </label>\n                    <select\n                      id=\"course_instances\"\n                      name=\"unsafe_course_instance_id\"\n                      class=\"form-select mb-3\"\n                      required\n                    >\n                      <option selected disabled value=\"\">See above</option>\n                    </select>\n                    <button type=\"submit\" class=\"btn btn-primary\">Connect course instance</button>\n                  </form>\n                </div>\n              `}\n\n          <p>\n            <details>\n              <summary>Why don't I see my course or course instances here?</summary>\n              <p>\n                You must have PrairieLearn course <strong>Editor</strong> and course instance\n                <strong>Student Data Editor</strong> permissions to link a course.\n              </p>\n            </details>\n          </p>\n          <p>\n            If you need a new PrairieLearn course,\n            <a href=\"/pl/request_course\">request one here</a>.\n          </p>\n\n          <p>\n            If you need a new course instance, create one in PrairieLearn first then revisit this\n            course linking flow.\n          </p>\n          <button\n            type=\"button\"\n            class=\"btn btn-link\"\n            data-bs-toggle=\"modal\"\n            data-bs-target=\"#terminology-modal\"\n          >\n            New here? Learn about PrairieLearn terminology\n          </button>\n        </main>\n      </body>\n    </html>\n  `.toString();\n}\n\nexport function Lti13CourseNavigationNotReady({\n  courseName,\n  resLocals,\n  ltiRoles,\n}: {\n  courseName: string;\n  resLocals: Record<string, any>;\n  ltiRoles: string[];\n}): string {\n  return html`\n    <!doctype html>\n    <html lang=\"en\">\n      <head>\n        ${HeadContents({ resLocals, pageTitle: 'LTI 1.3 - Course' })}\n      </head>\n      <body>\n        ${Navbar({ resLocals, navPage: 'lti13_course_navigation' })}\n        <main id=\"content\" class=\"container mb-4\">\n          <h1 class=\"h1\">Welcome to PrairieLearn</h1>\n          <h2 class=\"h2\">... but your course isn't ready yet!</h2>\n\n          <p>An instructor has not yet configured ${courseName} in PrairieLearn.</p>\n          <p>Please come back later.</p>\n          <p>\n            <a href=\"${config.urlPrefix}\" class=\"btn btn-primary\">\n              <i class=\"fa fa-home\" aria-hidden=\"true\"></i>\n              PrairieLearn home\n            </a>\n          </p>\n          ${ltiRoles.includes(STUDENT_ROLE)\n            ? ''\n            : html`\n                <div class=\"card\">\n                  <div class=\"card-header bg-info\">Debugging information</div>\n                  <div class=\"card-body\">\n                    <p>\n                      You do not have the permissions to integrate PrairieLearn course instances. An\n                      instructor or designer (and not Teaching Assistant) LMS role is needed to do\n                      this.\n                    </p>\n                    <p>Here are your roles that we received from your LMS:</p>\n                    <ul class=\"mb-0\">\n                      ${ltiRoles.map((role) => html`<li><code>${role}</code></li>`)}\n                    </ul>\n                  </div>\n                </div>\n              `}\n        </main>\n      </body>\n    </html>\n  `.toString();\n}\n\nexport function Lti13CourseNavigationDone({\n  resLocals,\n  lti13_instance_id,\n}: {\n  resLocals: Record<string, any>;\n  lti13_instance_id: string;\n}): string {\n  return html`\n    <!doctype html>\n    <html lang=\"en\">\n      <head>\n        ${HeadContents({ resLocals, pageTitle: 'LTI 1.3 - Course' })}\n      </head>\n      <body>\n        ${Navbar({ resLocals, navPage: 'lti13_course_navigation' })}\n        <main id=\"content\" class=\"container mb-4\">\n          <h1 class=\"h1\">Welcome to PrairieLearn</h1>\n\n          <p>\n            <strong>You're all set.</strong> Next time you or students click on the link in your\n            LMS, they will be taken directly to your PrairieLearn course instance.\n          </p>\n\n          <div class=\"alert alert-warning\">\n            The course instance and assessment <code>allowAccess</code> rules still apply and may\n            need to be configured.\n          </div>\n\n          <p>To change this connection, go to your course instance LTI 1.3 page.</p>\n\n          <p>\n            <a\n              href=\"/pl/lti13_instance/${lti13_instance_id}/course_navigation\"\n              class=\"btn btn-primary\"\n            >\n              Continue to your course instance\n            </a>\n          </p>\n        </main>\n      </body>\n    </html>\n  `.toString();\n}\n\nfunction TerminologyModal() {\n  return Modal({\n    id: 'terminology-modal',\n    title: 'Understanding PrairieLearn',\n    body: html`\n      <p>\n        PrairieLearn defines a <strong>course</strong> as a collection of questions and course\n        instances. It is the overarching umbrella that spans multiple runnings of the course with\n        students. Things that live across multiple semesters live at the course level.\n      </p>\n\n      <p>\n        A <strong>course instance</strong> is the running of an edition of a course that has\n        assessments, enrollments, grades, etc. Like a semester or quarter.\n      </p>\n\n      <p class=\"fst-italic\">\n        Example: A course might be MATH 101 and have a course instance MATH 101 Fall 2023.\n      </p>\n\n      <p>\n        For more, see the\n        <a href=\"https://prairielearn.readthedocs.io/\" target=\"_blank\">PrairieLearn User Guide</a>\n      </p>\n    `,\n  });\n}\n"]}