{"version":3,"file":"authzHasCoursePreviewOrInstanceView.js","sourceRoot":"","sources":["../../src/middlewares/authzHasCoursePreviewOrInstanceView.ts"],"names":[],"mappings":"AAAA,OAAO,EAA+B,MAAM,SAAS,CAAC;AACtD,OAAO,YAAY,MAAM,uBAAuB,CAAC;AAEjD,OAAO,KAAK,KAAK,MAAM,qBAAqB,CAAC;AAE7C,MAAM,CAAC,KAAK,UAAU,mCAAmC,CAAC,GAAY,EAAE,GAAa;IACnF,IACE,CAAC,GAAG,CAAC,MAAM,CAAC,UAAU,CAAC,6BAA6B;QACpD,CAAC,GAAG,CAAC,MAAM,CAAC,UAAU,CAAC,mCAAmC,EAC1D,CAAC;QACD,MAAM,IAAI,KAAK,CAAC,eAAe,CAC7B,GAAG,EACH,mEAAmE,CACpE,CAAC;IACJ,CAAC;AACH,CAAC;AAED,eAAe,YAAY,CAAC,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE;IACnD,MAAM,mCAAmC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;IACpD,IAAI,EAAE,CAAC;AACT,CAAC,CAAC,CAAC","sourcesContent":["import { type Request, type Response } from 'express';\nimport asyncHandler from 'express-async-handler';\n\nimport * as error from '@prairielearn/error';\n\nexport async function authzHasCoursePreviewOrInstanceView(req: Request, res: Response) {\n  if (\n    !res.locals.authz_data.has_course_permission_preview &&\n    !res.locals.authz_data.has_course_instance_permission_view\n  ) {\n    throw new error.HttpStatusError(\n      403,\n      'Requires either course preview access or student data view access',\n    );\n  }\n}\n\nexport default asyncHandler(async (req, res, next) => {\n  await authzHasCoursePreviewOrInstanceView(req, res);\n  next();\n});\n"]}