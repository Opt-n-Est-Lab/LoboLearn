{"version":3,"file":"clearCookies.js","sourceRoot":"","sources":["../../src/middlewares/clearCookies.ts"],"names":[],"mappings":"AAAA,OAAO,EAAkD,MAAM,SAAS,CAAC;AAEzE,OAAO,EAAE,WAAW,EAAE,MAAM,kBAAkB,CAAC;AAE/C,MAAM,iBAAiB,GAAG;IACxB,UAAU;IACV,WAAW;IACX,iBAAiB;IACjB,kBAAkB;IAClB,4BAA4B;IAC5B,6BAA6B;IAC7B,uBAAuB;IACvB,wBAAwB;IACxB,sBAAsB;IACtB,aAAa;CACd,CAAC;AAEF,MAAM,CAAC,OAAO,WAAW,GAAY,EAAE,GAAa,EAAE,IAAkB;IACtE,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE;QACvC,IAAI,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;YACvB,IAAI,iBAAiB,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;gBACpC,OAAO;YACT,CAAC;YACD,WAAW,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;QACxB,CAAC;IACH,CAAC,CAAC,CAAC;IACH,IAAI,EAAE,CAAC;AACT,CAAC","sourcesContent":["import { type NextFunction, type Request, type Response } from 'express';\n\nimport { clearCookie } from '../lib/cookie.js';\n\nconst cookies_to_ignore = [\n  'pl_authn',\n  'pl2_authn',\n  'pl_assessmentpw',\n  'pl2_assessmentpw',\n  'pl_access_as_administrator',\n  'pl2_access_as_administrator',\n  'pl_disable_auto_authn',\n  'pl2_disable_auto_authn',\n  'prairielearn_session',\n  'pl2_session',\n];\n\nexport default function (req: Request, res: Response, next: NextFunction) {\n  Object.keys(req.cookies).forEach((key) => {\n    if (/^pl2?_/.test(key)) {\n      if (cookies_to_ignore.includes(key)) {\n        return;\n      }\n      clearCookie(res, key);\n    }\n  });\n  next();\n}\n"]}