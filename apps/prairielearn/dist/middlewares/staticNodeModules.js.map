{"version":3,"file":"staticNodeModules.js","sourceRoot":"","sources":["../../src/middlewares/staticNodeModules.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,IAAI,MAAM,WAAW,CAAC;AAElC,OAAO,KAAK,OAAO,MAAM,SAAS,CAAC;AACnC,OAAO,EAA2B,MAAM,cAAc,CAAC;AAEvD,OAAO,EAAE,aAAa,EAAE,oBAAoB,EAAE,MAAM,iBAAiB,CAAC;AACtE,MAAM,kBAAkB,GAAG;IACzB,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,cAAc,CAAC;IAC3C,IAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE,cAAc,CAAC;CACnD,CAAC;AAEF;;;;;;;;GAQG;AACH,MAAM,CAAC,OAAO,WAAW,SAAiB,EAAE,OAA4B;IACtE,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC;IAEhC,kBAAkB,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE;QAC/B,MAAM,iBAAiB,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC;QACrD,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAChB,CAAC","sourcesContent":["import * as path from 'node:path';\n\nimport * as express from 'express';\nimport { type ServeStaticOptions } from 'serve-static';\n\nimport { APP_ROOT_PATH, REPOSITORY_ROOT_PATH } from '../lib/paths.js';\nconst NODE_MODULES_PATHS = [\n  path.resolve(APP_ROOT_PATH, 'node_modules'),\n  path.resolve(REPOSITORY_ROOT_PATH, 'node_modules'),\n];\n\n/**\n * Allows serving static files from multiple `node_modules` directories.\n * Multiple directories are supported to account for the fact that PrairieLearn\n * is in a monorepo and dependencies might be located in either `node_modules`\n * or `apps/prairielearn/node_modules`.\n *\n * The first argument is a path within `node_modules` to serve. This can be '.'\n * to serve all files, or a subdirectory like `mathjax/es5`.\n */\nexport default function (servePath: string, options?: ServeStaticOptions) {\n  const router = express.Router();\n\n  NODE_MODULES_PATHS.forEach((p) => {\n    const resolvedServePath = path.resolve(p, servePath);\n    router.use(express.static(resolvedServePath, options));\n  });\n\n  return router;\n}\n"]}