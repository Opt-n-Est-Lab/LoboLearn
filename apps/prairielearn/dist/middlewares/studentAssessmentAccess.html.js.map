{"version":3,"file":"studentAssessmentAccess.html.js","sourceRoot":"","sources":["../../src/middlewares/studentAssessmentAccess.html.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;AAE1C,OAAO,EACL,uBAAuB,EACvB,uBAAuB,GACxB,MAAM,4CAA4C,CAAC;AACpD,OAAO,EAAE,YAAY,EAAE,MAAM,oCAAoC,CAAC;AAClE,OAAO,EAAE,MAAM,EAAE,MAAM,8BAA8B,CAAC;AACtD,OAAO,EAAE,QAAQ,EAAE,MAAM,gCAAgC,CAAC;AAC1D,OAAO,EAAE,qBAAqB,EAAE,MAAM,6CAA6C,CAAC;AAEpF,OAAO,EAAE,YAAY,EAAE,MAAM,kBAAkB,CAAC;AAEhD,MAAM,UAAU,uBAAuB,CAAC,EACtC,SAAS,EACT,eAAe,GAAG,IAAI,EACtB,yBAAyB,GAAG,KAAK,EACjC,+BAA+B,GAAG,KAAK,GAMxC;IACC,MAAM,EAAE,UAAU,EAAE,cAAc,EAAE,mBAAmB,EAAE,YAAY,EAAE,GAAG,SAKzE,CAAC;IACF,OAAO,IAAI,CAAA;;;;UAIH,YAAY,CAAC,EAAE,SAAS,EAAE,CAAC;;;UAG3B,MAAM,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC;UACrD,yBAAyB,CAAC,CAAC,CAAC,qBAAqB,CAAC,EAAE,iBAAiB,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;UACnF,+BAA+B;QAC/B,CAAC,CAAC,uBAAuB,CAAC,EAAE,SAAS,EAAE,SAAS,CAAC,YAAY,EAAE,CAAC;QAChE,CAAC,CAAC,EAAE;;YAEF,+BAA+B,CAAC,CAAC,CAAC,uBAAuB,EAAE,CAAC,CAAC,CAAC,EAAE;;;gBAG5D,cAAc,CAAC,YAAY,GAAG,UAAU,CAAC,MAAM,KAAK,UAAU,CAAC,KAAK;;;;gBAIpE,mBAAmB,IAAI,IAAI;QAC7B,CAAC,mBAAmB,CAAC,IAAI,KAAK,KAAK,IAAI,YAAY,CAAC,MAAM,KAAK,KAAK,CAAC;QACrE,eAAe;QACb,CAAC,CAAC,IAAI,CAAA;;;;0BAII,YAAY,CAAC,mBAAmB,CAAC,MAAM,CAAC,IAAI,YAAY,CACxD,mBAAmB,CAAC,UAAU,CAC/B;;;0BAGC,QAAQ,CAAC,mBAAmB,CAAC,UAAU,CAAC;;;wBAG1C,2BAA2B,CAAC;YAC5B,mBAAmB;YACnB,YAAY;YACZ,YAAY,EAAE,+BAA+B;SAC9C,CAAC;;mBAEL;QACH,CAAC,CAAC,2BAA2B,CAAC,EAAE,mBAAmB,EAAE,YAAY,EAAE,CAAC;;;;;;GAMjF,CAAC,QAAQ,EAAE,CAAC;AACf,CAAC;AAED,SAAS,2BAA2B,CAAC,EACnC,mBAAmB,EACnB,YAAY,EACZ,YAAY,GAAG,EAAE,GAKlB;IACC,OAAO,IAAI,CAAA;kBACK,YAAY;QACtB,mBAAmB,EAAE,IAAI,KAAK,KAAK;QACnC,CAAC,CAAC,IAAI,CAAA,mEAAmE;QACzE,CAAC,CAAC,YAAY,CAAC,gBAAgB,IAAI,IAAI;YACrC,CAAC,CAAC,IAAI,CAAA,oCAAoC;YAC1C,CAAC,CAAC,IAAI,CAAA,uCAAuC,YAAY,CAAC,gBAAgB,GAAG;;GAEpF,CAAC;AACJ,CAAC","sourcesContent":["import { html } from '@prairielearn/html';\n\nimport {\n  RegenerateInstanceAlert,\n  RegenerateInstanceModal,\n} from '../components/AssessmentRegenerate.html.js';\nimport { HeadContents } from '../components/HeadContents.html.js';\nimport { Navbar } from '../components/Navbar.html.js';\nimport { Scorebar } from '../components/Scorebar.html.js';\nimport { TimeLimitExpiredModal } from '../components/TimeLimitExpiredModal.html.js';\nimport type { Assessment, AssessmentInstance, AssessmentSet } from '../lib/db-types.js';\nimport { formatPoints } from '../lib/format.js';\n\nexport function StudentAssessmentAccess({\n  resLocals,\n  showClosedScore = true,\n  showTimeLimitExpiredModal = false,\n  userCanDeleteAssessmentInstance = false,\n}: {\n  resLocals: Record<string, any>;\n  showClosedScore?: boolean;\n  showTimeLimitExpiredModal?: boolean;\n  userCanDeleteAssessmentInstance?: boolean;\n}) {\n  const { assessment, assessment_set, assessment_instance, authz_result } = resLocals as {\n    assessment: Assessment;\n    assessment_set: AssessmentSet;\n    assessment_instance?: AssessmentInstance;\n    authz_result: any;\n  };\n  return html`\n    <!doctype html>\n    <html lang=\"en\">\n      <head>\n        ${HeadContents({ resLocals })}\n      </head>\n      <body>\n        ${Navbar({ resLocals, navPage: 'assessment_instance' })}\n        ${showTimeLimitExpiredModal ? TimeLimitExpiredModal({ showAutomatically: true }) : ''}\n        ${userCanDeleteAssessmentInstance\n          ? RegenerateInstanceModal({ csrfToken: resLocals.__csrf_token })\n          : ''}\n        <main id=\"content\" class=\"container\">\n          ${userCanDeleteAssessmentInstance ? RegenerateInstanceAlert() : ''}\n          <div class=\"card mb-4\">\n            <div class=\"card-header bg-primary text-white\">\n              ${assessment_set.abbreviation}${assessment.number}: ${assessment.title}\n            </div>\n\n            <div class=\"card-body\">\n              ${assessment_instance != null &&\n              (assessment_instance.open === false || authz_result.active === false) &&\n              showClosedScore\n                ? html`\n                    <div class=\"row align-items-center\">\n                      <div class=\"col-md-3 col-sm-6\">\n                        Total points:\n                        ${formatPoints(assessment_instance.points)}/${formatPoints(\n                          assessment_instance.max_points,\n                        )}\n                      </div>\n                      <div class=\"col-md-3 col-sm-6\">\n                        ${Scorebar(assessment_instance.score_perc)}\n                      </div>\n\n                      ${AssessmentStatusDescription({\n                        assessment_instance,\n                        authz_result,\n                        extraClasses: 'col-md-6 col-sm-12 text-right',\n                      })}\n                    </div>\n                  `\n                : AssessmentStatusDescription({ assessment_instance, authz_result })}\n            </div>\n          </div>\n        </main>\n      </body>\n    </html>\n  `.toString();\n}\n\nfunction AssessmentStatusDescription({\n  assessment_instance,\n  authz_result,\n  extraClasses = '',\n}: {\n  assessment_instance?: AssessmentInstance;\n  authz_result: any;\n  extraClasses?: string;\n}) {\n  return html`\n    <div class=\"${extraClasses}\" data-testid=\"assessment-closed-message\">\n      ${assessment_instance?.open === false\n        ? html`Assessment is <strong>closed</strong> and is no longer available.`\n        : authz_result.next_active_time == null\n          ? html`Assessment is no longer available.`\n          : html`Assessment will become available on ${authz_result.next_active_time}.`}\n    </div>\n  `;\n}\n"]}