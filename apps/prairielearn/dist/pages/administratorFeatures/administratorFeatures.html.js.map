{"version":3,"file":"administratorFeatures.html.js","sourceRoot":"","sources":["../../../src/pages/administratorFeatures/administratorFeatures.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from 'zod';\n\nimport { compiledScriptTag } from '@prairielearn/compiled-assets';\nimport { html } from '@prairielearn/html';\n\nimport { Modal } from '../../components/Modal.html.js';\nimport { PageLayout } from '../../components/PageLayout.html.js';\nimport { type Course, type CourseInstance, type Institution } from '../../lib/db-types.js';\n\nexport const FeatureGrantRowSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  enabled: z.boolean(),\n  institution_id: z.string().nullable(),\n  institution_short_name: z.string().nullable(),\n  institution_long_name: z.string().nullable(),\n  course_id: z.string().nullable(),\n  course_title: z.string().nullable(),\n  course_short_name: z.string().nullable(),\n  course_instance_id: z.string().nullable(),\n  course_instance_short_name: z.string().nullable(),\n  course_instance_long_name: z.string().nullable(),\n  user_id: z.string().nullable(),\n  user_uid: z.string().nullable(),\n  user_name: z.string().nullable(),\n});\ntype FeatureGrantRow = z.infer<typeof FeatureGrantRowSchema>;\n\nexport function AdministratorFeatures({\n  features,\n  resLocals,\n}: {\n  features: string[];\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Features',\n    navContext: {\n      type: 'plain',\n      page: 'admin',\n      subPage: 'features',\n    },\n    content: html`\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white\">\n          <h1>Features</h1>\n        </div>\n        ${features.length > 0\n          ? html`\n              <div class=\"list-group list-group-flush\">\n                ${features.map((feature) => {\n                  return html`\n                    <div class=\"list-group-item d-flex align-items-center\">\n                      <a\n                        href=\"${resLocals.urlPrefix}/administrator/features/${feature}\"\n                        class=\"me-auto font-monospace\"\n                      >\n                        ${feature}\n                      </a>\n                    </div>\n                  `;\n                })}\n              </div>\n            `\n          : html`<div class=\"card-body text-center text-secondary\">No features</div>`}\n      </div>\n    `,\n  });\n}\n\nexport function AdministratorFeature({\n  feature,\n  featureGrants,\n  featureInConfig,\n  institutions,\n  resLocals,\n}: {\n  feature: string;\n  institutions: Institution[];\n  featureGrants: FeatureGrantRow[];\n  featureInConfig: boolean | null;\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Features',\n    navContext: {\n      type: 'plain',\n      page: 'admin',\n      subPage: 'features',\n    },\n    headContent: html`\n      ${compiledScriptTag('administratorFeaturesClient.ts')}\n      <style>\n        .list-inline-item:not(:first-child):before {\n          margin-right: 0.5rem;\n          content: '/';\n        }\n        [data-loading] {\n          display: none;\n        }\n      </style>\n    `,\n    content: html`\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n          <span class=\"font-monospace\">${feature}</span>\n          <button\n            class=\"btn btn-light ms-auto\"\n            data-bs-toggle=\"modal\"\n            data-bs-target=\"#add-feature-grant-modal\"\n          >\n            Grant feature\n          </button>\n        </div>\n        ${featureGrants.length > 0 || featureInConfig != null\n          ? html`\n              <div class=\"list-group list-group-flush\">\n                ${featureInConfig != null\n                  ? html`\n                      <div class=\"list-group-item\">\n                        <i\n                          class=\"fa-solid me-1 ${featureInConfig\n                            ? 'fa-check text-success'\n                            : 'fa-times text-danger'}\"\n                        ></i>\n                        Feature ${featureInConfig ? 'enabled' : 'disabled'} in configuration file\n                      </div>\n                    `\n                  : ''}\n                ${featureGrants.map((featureGrant) =>\n                  FeatureGrant({\n                    featureGrant,\n                    overridden: featureInConfig != null,\n                    csrfToken: resLocals.__csrf_token,\n                  }),\n                )}\n              </div>\n            `\n          : html`\n              <div class=\"card-body text-center text-secondary\">\n                There are no grants for this feature\n              </div>\n            `}\n      </div>\n    `,\n    postContent: html`\n      ${AddFeatureGrantModal({\n        feature,\n        // Default to enabled for new grants.\n        enabled: true,\n        institutions,\n        csrfToken: resLocals.__csrf_token,\n      })}\n    `,\n  });\n}\n\nfunction FeatureGrantBreadcrumbs({ featureGrant }: { featureGrant: FeatureGrantRow }) {\n  const hasInstitution = featureGrant.institution_id !== null;\n  const hasCourse = featureGrant.course_id !== null;\n  const hasCourseInstance = featureGrant.course_instance_id !== null;\n  const hasUser = featureGrant.user_id !== null;\n  const isGlobal = !hasInstitution && !hasCourse && !hasCourseInstance && !hasUser;\n  return html`\n    <ol class=\"list-inline mb-0\">\n      ${\n        isGlobal\n          ? html`<li class=\"list-inline-item inline-flex\">\n              <i class=\"fa-solid fa-globe me-1\"></i>\n              Global\n            </li>`\n          : null\n      }\n      ${\n        hasInstitution\n          ? html`\n              <li class=\"list-inline-item inline-flex\">\n                ${featureGrant.institution_long_name} (${featureGrant.institution_short_name})\n              </li>\n            `\n          : null\n      }\n      ${\n        hasCourse\n          ? html`<li class=\"list-inline-item inline-flex\">\n              ${featureGrant.course_short_name}: ${featureGrant.course_title}\n            </li>`\n          : null\n      }\n      ${\n        hasCourseInstance\n          ? html`<li class=\"list-inline-item inline-flex\">\n              ${featureGrant.course_instance_long_name} (${featureGrant.course_instance_short_name})\n            </li>`\n          : null\n      }\n      ${\n        hasUser\n          ? html`<li class=\"list-inline-item inline-flex\">\n              ${featureGrant.user_uid} (${featureGrant.user_name})\n            </li>`\n          : null\n      }\n      </li>\n    </ol>\n  `;\n}\n\nfunction FeatureGrant({\n  featureGrant,\n  overridden,\n  csrfToken,\n}: {\n  featureGrant: FeatureGrantRow;\n  overridden: boolean;\n  csrfToken: string;\n}) {\n  return html`\n    <div\n      class=\"list-group-item d-flex flex-column flex-md-row flex-nowrap align-items-md-center ${overridden\n        ? 'text-muted'\n        : ''}\"\n    >\n      <div>${FeatureGrantBreadcrumbs({ featureGrant })}</div>\n      <div class=\"ms-auto d-flex flex-row flex-nowrap flex-shrink-0\">\n        <form\n          method=\"POST\"\n          class=\"me-2\"\n          hx-boost=\"true\"\n          hx-trigger=\"change\"\n          hx-ext=\"morphdom-swap\"\n          hx-swap=\"morphdom\"\n        >\n          <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n          <input type=\"hidden\" name=\"feature_grant_id\" value=\"${featureGrant.id}\" />\n          <input type=\"hidden\" name=\"__action\" value=\"update_feature_grant_enabled\" />\n          <select\n            class=\"form-select form-select-sm\"\n            aria-label=\"Enable or disable feature\"\n            name=\"feature_grant_enabled\"\n          >\n            <option value=\"enabled\" ${featureGrant.enabled ? 'selected' : ''}>✅ Enabled</option>\n            <option value=\"disabled\" ${featureGrant.enabled ? '' : 'selected'}>❌ Disabled</option>\n          </select>\n        </form>\n\n        <form\n          method=\"POST\"\n          hx-boost=\"true\"\n          hx-confirm=\"Are you sure you want to revoke this feature grant?\"\n          hx-ext=\"morphdom-swap\"\n          hx-swap=\"morphdom\"\n        >\n          <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n          <input type=\"hidden\" name=\"feature_grant_id\" value=\"${featureGrant.id}\" />\n          <button\n            type=\"submit\"\n            name=\"__action\"\n            value=\"revoke_feature_grant\"\n            class=\"btn btn-sm btn-outline-danger\"\n          >\n            Revoke\n          </button>\n        </form>\n      </div>\n    </div>\n  `;\n}\n\ninterface FeatureGrantModalProps {\n  feature: string;\n  enabled: boolean;\n  institutions: Institution[];\n  institution_id?: string | null;\n  courses?: Course[];\n  course_id?: string | null;\n  course_instances?: CourseInstance[];\n  course_instance_id?: string | null;\n  csrfToken: string;\n}\n\nfunction AddFeatureGrantModal(props: FeatureGrantModalProps) {\n  return Modal({\n    title: 'Grant feature',\n    id: 'add-feature-grant-modal',\n    // The user UID input is deliberately outside of `AddFeatureGrantModalBody`.\n    // We don't want changes to the user to trigger a reload of the modal body,\n    // nor do we want to include it when sending back the updated body HTML.\n    body: html`\n      ${AddFeatureGrantModalBody(props)}\n      <div>\n        <label class=\"form-label\" for=\"feature-grant-user\">User</label>\n        <input\n          type=\"text\"\n          class=\"form-control\"\n          id=\"feature-grant-user\"\n          name=\"user_uid\"\n          placeholder=\"student@example.com\"\n        />\n        <div class=\"form-text\">Leave blank to grant to all users in the given context.</div>\n      </div>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${props.csrfToken}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" name=\"__action\" value=\"add_feature_grant\" class=\"btn btn-primary\">\n        Grant feature\n      </button>\n    `,\n  });\n}\n\nexport function AddFeatureGrantModalBody({\n  feature,\n  enabled,\n  institutions,\n  institution_id,\n  courses,\n  course_id,\n  course_instances,\n  course_instance_id,\n}: Omit<FeatureGrantModalProps, 'csrfToken'>) {\n  const modalUrl = `/pl/administrator/features/${feature}/modal`;\n  return html`\n    <fieldset\n      hx-get=\"${modalUrl}\"\n      hx-trigger=\"change\"\n      hx-target=\"this\"\n      hx-include=\"closest .modal-body\"\n      hx-ext=\"loading-states,morphdom-swap\"\n      hx-swap=\"morphdom\"\n      data-loading-disable\n      data-loading-delay=\"200\"\n    >\n      <div class=\"form-check\">\n        <input\n          type=\"radio\"\n          class=\"form-check-input\"\n          id=\"feature-grant-enabled\"\n          name=\"enabled\"\n          value=\"true\"\n          ${enabled ? 'checked' : ''}\n        />\n        <label class=\"form-check-label\" for=\"feature-grant-enabled\">Enable feature</label>\n      </div>\n      <div class=\"form-check\">\n        <input\n          type=\"radio\"\n          class=\"form-check-input\"\n          id=\"feature-grant-disabled\"\n          name=\"enabled\"\n          value=\"false\"\n          ${enabled ? '' : 'checked'}\n        />\n        <label class=\"form-check-label\" for=\"feature-grant-disabled\">Disable feature</label>\n        <div class=\"small text-muted\">\n          Enabling or disabling a feature overrides any settings from a parent institution, course,\n          and so on.\n        </div>\n      </div>\n\n      <hr />\n\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"feature-grant-institution\">\n          Institution\n          <div class=\"spinner-border spinner-border-sm\" role=\"status\" data-loading></div>\n        </label>\n        <select class=\"form-select\" id=\"feature-grant-institution\" name=\"institution_id\">\n          <option value=\"\">All institutions</option>\n          ${institutions.map((institution) => {\n            return html`\n              <option\n                value=\"${institution.id}\"\n                ${institution.id === institution_id ? 'selected' : ''}\n              >\n                ${institution.short_name}: ${institution.long_name} (${institution.id})\n              </option>\n            `;\n          })}\n        </select>\n      </div>\n\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"feature-grant-course\">\n          Course\n          <div class=\"spinner-border spinner-border-sm\" role=\"status\" data-loading></div>\n        </label>\n        <select\n          class=\"form-select\"\n          id=\"feature-grant-course\"\n          name=\"course_id\"\n          ${!institution_id ? 'disabled' : ''}\n        >\n          <option value=\"\">All courses in this institution</option>\n          ${(courses ?? []).map((course) => {\n            return html`\n              <option value=\"${course.id}\" ${course.id === course_id ? 'selected' : ''}>\n                ${course.short_name}: ${course.title} (${course.id})\n              </option>\n            `;\n          })}\n        </select>\n      </div>\n\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"feature-grant-course-instance\">\n          Course instance\n          <div class=\"spinner-border spinner-border-sm\" role=\"status\" data-loading></div>\n        </label>\n        <select\n          class=\"form-select\"\n          id=\"feature-grant-course-instance\"\n          name=\"course_instance_id\"\n          ${!course_id ? 'disabled' : ''}\n        >\n          <option value=\"\">All courses instances in this course</option>\n          ${(course_instances ?? []).map((course_instance) => {\n            return html`\n              <option\n                value=\"${course_instance.id}\"\n                ${course_instance.id === course_instance_id ? 'selected' : ''}\n              >\n                ${course_instance.short_name}: ${course_instance.long_name} (${course_instance.id})\n              </option>\n            `;\n          })}\n        </select>\n      </div>\n    </fieldset>\n  `;\n}\n"]}