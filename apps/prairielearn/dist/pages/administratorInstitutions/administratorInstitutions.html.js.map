{"version":3,"file":"administratorInstitutions.html.js","sourceRoot":"","sources":["../../../src/pages/administratorInstitutions/administratorInstitutions.html.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,CAAC,EAAE,MAAM,KAAK,CAAC;AAExB,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;AAE1C,OAAO,EAAE,KAAK,EAAE,MAAM,gCAAgC,CAAC;AACvD,OAAO,EAAE,UAAU,EAAE,MAAM,qCAAqC,CAAC;AACjE,OAAO,EAAE,iBAAiB,EAAE,MAAM,uBAAuB,CAAC;AAC1D,OAAO,EAAE,YAAY,EAAE,MAAM,sBAAsB,CAAC;AACpD,OAAO,EAAiB,cAAc,EAAE,MAAM,wBAAwB,CAAC;AAEvE,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAAC,CAAC,MAAM,CAAC;IAC3C,WAAW,EAAE,iBAAiB;IAC9B,eAAe,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC;CACrC,CAAC,CAAC;AAGH,MAAM,UAAU,yBAAyB,CAAC,EACxC,YAAY,EACZ,kBAAkB,EAClB,SAAS,GAKV;IACC,OAAO,UAAU,CAAC;QAChB,SAAS;QACT,SAAS,EAAE,cAAc;QACzB,UAAU,EAAE;YACV,IAAI,EAAE,OAAO;YACb,IAAI,EAAE,OAAO;YACb,OAAO,EAAE,cAAc;SACxB;QACD,OAAO,EAAE;YACP,SAAS,EAAE,IAAI;SAChB;QACD,OAAO,EAAE,IAAI,CAAA;;;;;;;;;;;;;;UAcP,KAAK,CAAC;YACN,KAAK,EAAE,iBAAiB;YACxB,EAAE,EAAE,uBAAuB;YAC3B,IAAI,EAAE,IAAI,CAAA;;8DAE0C,SAAS,CAAC,YAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBAgClE,kBAAkB,CAAC,GAAG,CACtB,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,IAAI,CAAA;qCACI,EAAE,CAAC,IAAI,kBAAkB,CAAC,KAAK,cAAc,CAAC,EAAE,CAAC;mBACnE,CACF;;;;;;;;;;;;;;;;;;;;;;;;;WAyBN;YACD,MAAM,EAAE,IAAI,CAAA;;;WAGX;SACF,CAAC;;;;;;;;;;;;;gBAaM,YAAY,CAAC,GAAG,CAChB,CAAC,EAAE,WAAW,EAAE,eAAe,EAAE,EAAE,EAAE,CAAC,IAAI,CAAA;;;wBAGlC,YAAY,EAAE;YACd,CAAC,CAAC,IAAI,CAAA;qEACuC,WAAW,CAAC,EAAE;gCACnD,WAAW,CAAC,UAAU;;2BAE3B;YACH,CAAC,CAAC,WAAW,CAAC,UAAU;;0BAEtB,WAAW,CAAC,SAAS;0BACrB,WAAW,CAAC,gBAAgB;gCACtB,WAAW,CAAC,UAAU;0BAC5B,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC;;iBAEnC,CACF;;;;;KAKV;KACF,CAAC,CAAC;AACL,CAAC","sourcesContent":["import { z } from 'zod';\n\nimport { html } from '@prairielearn/html';\n\nimport { Modal } from '../../components/Modal.html.js';\nimport { PageLayout } from '../../components/PageLayout.html.js';\nimport { InstitutionSchema } from '../../lib/db-types.js';\nimport { isEnterprise } from '../../lib/license.js';\nimport { type Timezone, formatTimezone } from '../../lib/timezones.js';\n\nexport const InstitutionRowSchema = z.object({\n  institution: InstitutionSchema,\n  authn_providers: z.array(z.string()),\n});\ntype InstitutionRow = z.infer<typeof InstitutionRowSchema>;\n\nexport function AdministratorInstitutions({\n  institutions,\n  availableTimezones,\n  resLocals,\n}: {\n  institutions: InstitutionRow[];\n  availableTimezones: Timezone[];\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Institutions',\n    navContext: {\n      type: 'plain',\n      page: 'admin',\n      subPage: 'institutions',\n    },\n    options: {\n      fullWidth: true,\n    },\n    content: html`\n      <div id=\"institutions\" class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n          <h1>Institutions</h1>\n          <button\n            type=\"button\"\n            class=\"btn btn-sm btn-light ms-auto\"\n            data-bs-toggle=\"modal\"\n            data-bs-target=\"#add-institution-modal\"\n          >\n            <i class=\"fas fa-plus\"></i>\n            <span class=\"d-none d-sm-inline\">Add institution</span>\n          </button>\n        </div>\n        ${Modal({\n          title: 'Add Institution',\n          id: 'add-institution-modal',\n          body: html`\n            <input type=\"hidden\" name=\"__action\" value=\"add_institution\" />\n            <input type=\"hidden\" name=\"__csrf_token\" value=\"${resLocals.__csrf_token}\" />\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"short_name\">Short name</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"short_name\"\n                name=\"short_name\"\n                placeholder=\"Short name\"\n              />\n              <small id=\"short_name_help\" class=\"form-text text-muted\">\n                Use an abbreviation or short name. E.g., \"UIUC\" or \"Berkeley\".\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"long_name\">Long name</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"long_name\"\n                name=\"long_name\"\n                placeholder=\"Long name\"\n              />\n              <small id=\"long_name_help\" class=\"form-text text-muted\">\n                Use the full name of the university. E.g., \"University of Illinois\n                Urbana-Champaign\".\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"display_timezone\">Timezone</label>\n              <select class=\"form-select\" id=\"display_timezone\" name=\"display_timezone\">\n                <option value=\"\" selected disabled hidden>Timezone</option>\n                ${availableTimezones.map(\n                  (tz, i) => html`\n                    <option value=\"${tz.name}\" id=\"timezone-${i}\">${formatTimezone(tz)}</option>\n                  `,\n                )}\n              </select>\n              <small id=\"display_timezone_help\" class=\"form-text text-muted\">\n                The allowable timezones are from the\n                <a\n                  href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\"\n                  target=\"_blank\"\n                  >tz database</a\n                >. It's best to use a city-based timezone that has the same times as you. E.g.,\n                \"America/Chicago\".\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"uid_regexp\">UID regexp</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"uid_regexp\"\n                name=\"uid_regexp\"\n                placeholder=\"UID regexp\"\n              />\n              <small id=\"uid_regexp_help\" class=\"form-text text-muted\">\n                Should match the non-username part of students' UIDs. E.g., @example\\\\.com$.\n              </small>\n            </div>\n          `,\n          footer: html`\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n            <button type=\"submit\" class=\"btn btn-primary\">Add institution</button>\n          `,\n        })}\n        <div class=\"table-responsive\">\n          <table class=\"table table-sm table-hover table-striped\" aria-label=\"Institutions\">\n            <thead>\n              <tr>\n                <th>Short name</th>\n                <th>Long name</th>\n                <th>Timezone</th>\n                <th>UID regexp</th>\n                <th>Authn providers</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${institutions.map(\n                ({ institution, authn_providers }) => html`\n                  <tr>\n                    <td>\n                      ${isEnterprise()\n                        ? html`\n                            <a href=\"/pl/administrator/institution/${institution.id}\">\n                              ${institution.short_name}\n                            </a>\n                          `\n                        : institution.short_name}\n                    </td>\n                    <td>${institution.long_name}</td>\n                    <td>${institution.display_timezone}</td>\n                    <td><code>${institution.uid_regexp}</code></td>\n                    <td>${authn_providers.join(', ')}</td>\n                  </tr>\n                `,\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    `,\n  });\n}\n"]}