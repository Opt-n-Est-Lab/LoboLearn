{"version":3,"file":"administratorQuery.html.js","sourceRoot":"","sources":["../../../src/pages/administratorQuery/administratorQuery.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from 'zod';\n\nimport { formatDate } from '@prairielearn/formatter';\nimport { html } from '@prairielearn/html';\n\nimport { AdministratorQueryResultSchema } from '../../admin_queries/util.js';\nimport { PageLayout } from '../../components/PageLayout.html.js';\nimport { nodeModulesAssetPath } from '../../lib/assets.js';\nimport { config } from '../../lib/config.js';\nimport { type QueryRun, QueryRunSchema } from '../../lib/db-types.js';\n\nexport const AdministratorQueryRunParamsSchema = z.object({\n  name: z.string(),\n  sql: z.string(),\n  params: z.record(z.any()),\n  authn_user_id: z.string(),\n  error: z.string().optional().nullable(),\n  result: AdministratorQueryResultSchema.nullable(),\n  formatted_date: z.string().optional().nullable(),\n});\n\nexport const AdministratorQuerySchema = z.object({\n  description: z.string(),\n  resultFormats: z.any().optional(),\n  comment: z.any().optional(),\n  params: z\n    .array(\n      z.object({\n        name: z.string(),\n        description: z.string(),\n        default: z.string().optional(),\n        comment: z.string().optional(),\n      }),\n    )\n    .optional(),\n  sqlFilename: z.string().optional(),\n  link: z.string().optional(),\n});\ntype AdministratorQuery = z.infer<typeof AdministratorQuerySchema>;\n\nexport const QueryRunRowSchema = QueryRunSchema.extend({\n  user_name: z.string().nullable(),\n  user_uid: z.string().nullable(),\n});\nexport type QueryRunRow = z.infer<typeof QueryRunRowSchema>;\n\nexport function AdministratorQuery({\n  resLocals,\n  query_run_id,\n  query_run,\n  queryFilename,\n  info,\n  recent_query_runs,\n}: {\n  resLocals: Record<string, any>;\n  query_run_id: string | null;\n  query_run: QueryRun | null;\n  queryFilename: string;\n  info: AdministratorQuery;\n  recent_query_runs: QueryRunRow[];\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: queryFilename,\n    navContext: {\n      type: 'plain',\n      page: 'admin',\n      subPage: 'queries',\n    },\n    options: {\n      fullWidth: true,\n    },\n    headContent: html`\n      <link href=\"${nodeModulesAssetPath('highlight.js/styles/default.css')}\" rel=\"stylesheet\" />\n      <link\n        href=\"${nodeModulesAssetPath('tablesorter/dist/css/theme.bootstrap.min.css')}\"\n        rel=\"stylesheet\"\n      />\n      <script src=\"${nodeModulesAssetPath(\n          'tablesorter/dist/js/jquery.tablesorter.min.js',\n        )}\"></script>\n      <script src=\"${nodeModulesAssetPath(\n          'tablesorter/dist/js/jquery.tablesorter.widgets.min.js',\n        )}\"></script>\n    `,\n    content: html`\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n          <h1>Query: <span class=\"font-monospace\">${queryFilename}</span></h1>\n          <span class=\"ms-3\">&mdash;</span>\n          <span class=\"ms-3\">${info.description}</span>\n        </div>\n\n        <div class=\"card-body\">\n          <form method=\"POST\">\n            ${info.params\n              ? info.params.map(\n                  (param) => html`\n                    <div class=\"mb-3\">\n                      <label class=\"form-label\" for=\"param-${param.name}\">${param.name}</label>\n                      <input\n                        class=\"form-control\"\n                        type=\"text\"\n                        id=\"param-${param.name}\"\n                        aria-describedby=\"param-${param.name}-help\"\n                        name=\"${param.name}\"\n                        autocomplete=\"off\"\n                        ${query_run?.params?.[param.name]\n                          ? html`value=\"${query_run?.params[param.name]}\"`\n                          : html`value=\"${param.default ?? ''}\"`}\n                      />\n\n                      <small id=\"param-${param.name}-help\" class=\"form-text text-muted\">\n                        ${param.description}\n                      </small>\n                    </div>\n                  `,\n                )\n              : null}\n            <input type=\"hidden\" name=\"__csrf_token\" value=\"${resLocals.__csrf_token}\" />\n            <button type=\"submit\" class=\"btn btn-primary\">\n              <i class=\"fas fa-play\"></i>\n              Run query ${query_run ? 'again' : null}\n            </button>\n          </form>\n        </div>\n\n        ${query_run\n          ? html`\n              <div class=\"card-body d-flex align-items-center p-2 bg-secondary text-white\">\n                Query ran at: ${query_run.date ? formatDate(query_run.date, 'UTC') : 'unknown'}\n                ${query_run?.result != null\n                  ? html`\n                      <div class=\"ms-auto\">\n                        <span class=\"me-2\" data-testid=\"row-count\">\n                          ${query_run.result.rows?.length ?? 0}\n                          ${query_run.result.rows?.length === 1 ? 'row' : 'rows'}\n                        </span>\n                        <a\n                          href=\"${`?query_run_id=${query_run_id}&format=json`}\"\n                          class=\"btn btn-sm btn-light\"\n                        >\n                          <i class=\"fas fa-download\" aria-hidden=\"true\"></i> JSON\n                        </a>\n                        <a\n                          href=\"${`?query_run_id=${query_run_id}&format=csv`}\"\n                          class=\"btn btn-sm btn-light\"\n                        >\n                          <i class=\"fas fa-download\" aria-hidden=\"true\"></i> CSV\n                        </a>\n                      </div>\n                    `\n                  : ''}\n              </div>\n            `\n          : null}\n        ${query_run?.error != null\n          ? html` <p class=\"text-danger m-2\">${query_run.error}</p> `\n          : null}\n        ${query_run?.result != null\n          ? html`\n              <div class=\"table-responsive\">\n                <table\n                  class=\"table table-sm table-hover table-striped tablesorter\"\n                  aria-label=\"Query results\"\n                  data-testid=\"results-table\"\n                >\n                  <thead>\n                    <tr>\n                      ${query_run.result.columns?.map((col: string) =>\n                        renderHeader(query_run.result?.columns, col),\n                      )}\n                    </tr>\n                  </thead>\n\n                  <tbody>\n                    ${query_run.result.rows?.map(\n                      (row: any) => html`\n                        <tr>\n                          ${query_run.result?.columns?.map((col: string) =>\n                            renderCell(row, col, query_run.result?.columns, info),\n                          )}\n                        </tr>\n                      `,\n                    )}\n                  </tbody>\n                </table>\n              </div>\n            `\n          : null}\n      </div>\n\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n          Recent query runs\n        </div>\n        <div class=\"table-responsive\">\n          ${recent_query_runs.length > 0\n            ? html`\n                <table class=\"table table-sm\" aria-label=\"Recent query runs\">\n                  <thead>\n                    <tr>\n                      <th>Date</th>\n                      <th>Params</th>\n                      <th>User name</th>\n                      <th>User UID</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    ${recent_query_runs.map(\n                      (run) => html`\n                        <tr>\n                          <td>\n                            <a href=\"${`?query_run_id=${run.id}`}\">\n                              ${run.date ? formatDate(run.date, 'UTC') : html`&mdash;`}\n                            </a>\n                          </td>\n                          <td>\n                            <pre class=\"mb-0\">${JSON.stringify(run.params)}</pre>\n                          </td>\n                          <td>${run.user_name}</td>\n                          <td>${run.user_uid}</td>\n                        </tr>\n                      `,\n                    )}\n                  </tbody>\n                </table>\n              `\n            : html`\n                <div class=\"card-body\">\n                  <div class=\"text-center text-muted\">No recent runs found</div>\n                </div>\n              `}\n        </div>\n      </div>\n    `,\n    postContent: html`\n      <script>\n        $(function () {\n          $('.tablesorter').tablesorter({\n            theme: 'bootstrap',\n            widthFixed: true,\n            headerTemplate: '{content} {icon}',\n            widgets: ['uitheme', 'zebra'],\n            widgetOptions: {\n              zebra: ['even', 'odd'],\n            },\n          });\n        });\n      </script>\n    `,\n  });\n}\n\nfunction shouldRenderColumn(columns: string[], col: string) {\n  if (col === 'course_id' && columns.includes('course')) {\n    return false;\n  }\n  if (col === 'course_instance_id' && columns.includes('course_instance')) {\n    return false;\n  }\n  if (\n    col === 'assessment_id' &&\n    columns.includes('assessment') &&\n    columns.includes('course_instance_id')\n  ) {\n    return false;\n  }\n  if (/^_sortval_/.test(col)) {\n    return false;\n  }\n  return true;\n}\n\nfunction renderHeader(columns: string[], col: string) {\n  if (!shouldRenderColumn(columns, col)) return '';\n  return html`<th>${col}</th>`;\n}\n\nfunction renderCell(row: any, col: string, columns: string[], info: AdministratorQuery) {\n  if (!shouldRenderColumn(columns, col)) return '';\n  const tdAttributes = `_sortval_${col}` in row ? html`data-text=\"${row[`_sortval_${col}`]}\"` : '';\n\n  if (col === 'course' && 'course_id' in row) {\n    return html`\n      <td ${tdAttributes}>\n        <a href=\"${config.urlPrefix}/course/${row['course_id']}\">${row[col]}</a>\n      </td>\n    `;\n  } else if (col === 'course_instance' && 'course_instance_id' in row) {\n    return html`\n      <td ${tdAttributes}>\n        <a href=\"${config.urlPrefix}/course_instance/${row['course_instance_id']}\">${row[col]}</a>\n      </td>\n    `;\n  } else if (col === 'assessment' && 'assessment_id' in row && 'course_instance_id' in row) {\n    return html`\n      <td ${tdAttributes}>\n        <a\n          href=\"${config.urlPrefix}/course_instance/${row[\n            'course_instance_id'\n          ]}/instructor/assessment/${row['assessment_id']}\"\n        >\n          ${row[col]}\n        </a>\n      </td>\n    `;\n  }\n\n  if (row[col] == null) {\n    return html`<td ${tdAttributes}></td>`;\n  }\n\n  if (info.resultFormats?.[col] === 'pre') {\n    return html`\n      <td ${tdAttributes}>\n        <pre>${row[col]}</pre>\n      </td>\n    `;\n  } else if (typeof row[col] === 'object') {\n    return html`\n      <td ${tdAttributes}>\n        <code>${JSON.stringify(row[col])}</code>\n      </td>\n    `;\n  }\n\n  return html`<td ${tdAttributes}>${row[col]}</td>`;\n}\n"]}