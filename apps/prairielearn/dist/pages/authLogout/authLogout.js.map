{"version":3,"file":"authLogout.js","sourceRoot":"","sources":["../../../src/pages/authLogout/authLogout.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,SAAS,CAAC;AACjC,OAAO,YAAY,MAAM,uBAAuB,CAAC;AAEjD,OAAO,EAAE,MAAM,EAAE,MAAM,qBAAqB,CAAC;AAC7C,OAAO,EAAE,WAAW,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAC;AAE7D,MAAM,MAAM,GAAG,MAAM,EAAE,CAAC;AAExB,MAAM,CAAC,GAAG,CACR,GAAG,EACH,YAAY,CAAC,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE;IACrC,WAAW,CAAC,GAAG,EAAE,CAAC,sBAAsB,EAAE,aAAa,CAAC,CAAC,CAAC;IAC1D,WAAW,CAAC,GAAG,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC,CAAC;IAC5C,WAAW,CAAC,GAAG,EAAE,CAAC,iBAAiB,EAAE,kBAAkB,CAAC,CAAC,CAAC;IAE1D,IAAI,MAAM,CAAC,OAAO,EAAE,CAAC;QACnB,2EAA2E;QAC3E,uEAAuE;QACvE,2EAA2E;QAC3E,wEAAwE;QACxE,8CAA8C;QAC9C,SAAS,CAAC,GAAG,EAAE,CAAC,uBAAuB,EAAE,wBAAwB,CAAC,EAAE,GAAG,CAAC,CAAC;IAC3E,CAAC;IAED,MAAM,GAAG,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IAE5B,MAAM,QAAQ,GAAG,GAAG,CAAC,KAAK,CAAC,QAAQ,CAAC;IACpC,IAAI,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE,CAAC;QAC7C,GAAG,CAAC,QAAQ,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC;IAC7C,CAAC;SAAM,CAAC;QACN,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;IACpB,CAAC;AACH,CAAC,CAAC,CACH,CAAC;AAEF,eAAe,MAAM,CAAC","sourcesContent":["import { Router } from 'express';\nimport asyncHandler from 'express-async-handler';\n\nimport { config } from '../../lib/config.js';\nimport { clearCookie, setCookie } from '../../lib/cookie.js';\n\nconst router = Router();\n\nrouter.get(\n  '/',\n  asyncHandler(async (req, res, _next) => {\n    clearCookie(res, ['prairielearn_session', 'pl2_session']);\n    clearCookie(res, ['pl_authn', 'pl2_authn']);\n    clearCookie(res, ['pl_assessmentpw', 'pl2_assessmentpw']);\n\n    if (config.devMode) {\n      // In dev mode, a user will typically by automatically authenticated by our\n      // authentication middleware to reduce the friction of getting started.\n      // However, folks who want to specifically test authentication behavior can\n      // click \"Log out\". In this case, we want to disable the automatic login\n      // until the next time the user authenticates.\n      setCookie(res, ['pl_disable_auto_authn', 'pl2_disable_auto_authn'], '1');\n    }\n\n    await req.session.destroy();\n\n    const redirect = req.query.redirect;\n    if (redirect && typeof redirect === 'string') {\n      res.redirect(decodeURIComponent(redirect));\n    } else {\n      res.redirect('/');\n    }\n  }),\n);\n\nexport default router;\n"]}