{"version":3,"file":"enroll.html.js","sourceRoot":"","sources":["../../../src/pages/enroll/enroll.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from 'zod';\n\nimport { compiledScriptTag } from '@prairielearn/compiled-assets';\nimport { html } from '@prairielearn/html';\n\nimport { HeadContents } from '../../components/HeadContents.html.js';\nimport { Modal } from '../../components/Modal.html.js';\nimport { Navbar } from '../../components/Navbar.html.js';\nimport { PageLayout } from '../../components/PageLayout.html.js';\n\nexport const CourseInstanceRowSchema = z.object({\n  label: z.string(),\n  short_label: z.string(),\n  course_instance_id: z.string(),\n  enrolled: z.boolean(),\n  instructor_access: z.boolean(),\n});\ntype CourseInstance = z.infer<typeof CourseInstanceRowSchema>;\n\nexport function Enroll({\n  courseInstances,\n  resLocals,\n}: {\n  courseInstances: CourseInstance[];\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Enrollment - Courses',\n    navContext: {\n      type: 'plain',\n      page: 'enroll',\n    },\n    headContent: [compiledScriptTag('enrollClient.ts')],\n    preContent: html`\n      ${AddCourseModal({ csrfToken: resLocals.__csrf_token })}\n      ${RemoveCourseModal({ csrfToken: resLocals.__csrf_token })}\n    `,\n    content: html`\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white\">\n          <h1>Courses</h1>\n        </div>\n        <table class=\"table table-sm table-hover table-striped\" aria-label=\"Courses\">\n          <tbody>\n            ${courseInstances.map((course_instance) => {\n              return html`\n                <tr>\n                  <td class=\"align-middle\">${course_instance.label}</td>\n                  ${course_instance.instructor_access\n                    ? html`\n                        <td class=\"align-middle text-center\" colspan=\"2\">\n                          <span class=\"badge text-bg-info\">instructor access</span>\n                        </td>\n                      `\n                    : html`\n                        <td>\n                          ${!course_instance.enrolled\n                            ? html`\n                                <button\n                                  type=\"button\"\n                                  class=\"btn btn-sm btn-info\"\n                                  data-bs-toggle=\"modal\"\n                                  data-bs-target=\"#add-course-modal\"\n                                  data-course-instance-id=\"${course_instance.course_instance_id}\"\n                                  data-course-instance-short-label=\"${course_instance.short_label}\"\n                                >\n                                  Add course\n                                </button>\n                              `\n                            : ''}\n                        </td>\n                        <td>\n                          ${course_instance.enrolled\n                            ? html`\n                                <button\n                                  type=\"button\"\n                                  class=\"btn btn-sm btn-danger\"\n                                  data-bs-toggle=\"modal\"\n                                  data-bs-target=\"#remove-course-modal\"\n                                  data-course-instance-id=\"${course_instance.course_instance_id}\"\n                                  data-course-instance-short-label=\"${course_instance.short_label}\"\n                                >\n                                  Remove course\n                                </button>\n                              `\n                            : ''}\n                        </td>\n                      `}\n                </tr>\n              `;\n            })}\n          </tbody>\n        </table>\n      </div>\n    `,\n  });\n}\n\nexport function EnrollLtiMessage({\n  ltiInfo,\n  resLocals,\n}: {\n  ltiInfo: any;\n  resLocals: Record<string, any>;\n}) {\n  return html`\n    <!doctype html>\n    <html lang=\"en\">\n      <head>\n        ${HeadContents({ resLocals, pageTitle: 'Enrollment - Courses' })}\n      </head>\n      <body>\n        ${Navbar({ resLocals, navPage: 'enroll' })}\n        <main id=\"content\" class=\"container\">\n          <div class=\"card mb-4\">\n            <div class=\"card-header bg-primary text-white\">\n              Logout and log back in to see more courses\n            </div>\n            <div class=\"card-body\">\n              <p>\n                Your PrairieLearn login is currently tied to\n                <strong>${ltiInfo.plc_short_name} ${ltiInfo.ci_long_name}</strong> and cannot be\n                used to enroll in other courses.\n              </p>\n              <p>To see more courses:</p>\n              <ol>\n                <li>\n                  Log out by selecting your name in the top right menu and selecting \"Log out\".\n                </li>\n                <li>Sign-in again with your normal login.</li>\n                <li>Return to this enroll page to see the list of courses.</li>\n              </ol>\n              <p>\n                Note: When you revisit the main ${ltiInfo.plc_short_name} course site and come back\n                to PrairieLearn from it, it will take over your login again. You might consider\n                using different web browsers for that course from your other PrairieLearn courses.\n              </p>\n            </div>\n          </div>\n        </main>\n      </body>\n    </html>\n  `.toString();\n}\n\nexport function EnrollmentLimitExceededMessage({ resLocals }: { resLocals: Record<string, any> }) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Enrollment - Courses',\n    navContext: {\n      type: 'plain',\n      page: 'enroll',\n    },\n    content: html`\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-danger text-white\">Enrollment limit exceeded</div>\n        <div class=\"card-body\">\n          This course has reached its enrollment limit. Please contact the course staff for more\n          information.\n        </div>\n      </div>\n    `,\n  });\n}\n\nfunction AddCourseModal({ csrfToken }: { csrfToken: string }) {\n  return Modal({\n    id: 'add-course-modal',\n    title: 'Confirm add course',\n    body: html`\n      <p>Are you sure you want to add this course content to your PrairieLearn account?</p>\n      <p>\n        Adding or removing courses here only affects what is visible to you on PrairieLearn. This\n        does not change your university course registration.\n      </p>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <input type=\"hidden\" name=\"course_instance_id\" class=\"js-course-instance-id\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-info\" name=\"__action\" value=\"enroll\">\n        Add <span class=\"js-course-instance-short-label\"></span>\n      </button>\n    `,\n  });\n}\n\nfunction RemoveCourseModal({ csrfToken }: { csrfToken: string }) {\n  return Modal({\n    id: 'remove-course-modal',\n    title: 'Confirm remove course',\n    body: html`\n      <p>Are you sure you want to remove this course content from your PrairieLearn account?</p>\n      <p>\n        Adding or removing courses here only affects what is visible to you on PrairieLearn. This\n        does not change your university course registration.\n      </p>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <input type=\"hidden\" name=\"course_instance_id\" class=\"js-course-instance-id\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-danger\" name=\"__action\" value=\"unenroll\">\n        Remove <span class=\"js-course-instance-short-label\"></span>\n      </button>\n    `,\n  });\n}\n"]}