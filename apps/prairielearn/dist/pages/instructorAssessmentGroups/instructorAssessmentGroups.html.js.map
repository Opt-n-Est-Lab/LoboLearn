{"version":3,"file":"instructorAssessmentGroups.html.js","sourceRoot":"","sources":["../../../src/pages/instructorAssessmentGroups/instructorAssessmentGroups.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from 'zod';\n\nimport { escapeHtml, html } from '@prairielearn/html';\n\nimport { Modal } from '../../components/Modal.html.js';\nimport { PageLayout } from '../../components/PageLayout.html.js';\nimport { AssessmentSyncErrorsAndWarnings } from '../../components/SyncErrorsAndWarnings.html.js';\nimport { nodeModulesAssetPath } from '../../lib/assets.js';\nimport { type GroupConfig, IdSchema, UserSchema } from '../../lib/db-types.js';\n\nexport const GroupUsersRowSchema = z.object({\n  group_id: IdSchema,\n  name: z.string(),\n  size: z.number(),\n  users: z.array(UserSchema.pick({ user_id: true, uid: true })),\n});\ntype GroupUsersRow = z.infer<typeof GroupUsersRowSchema>;\n\nexport function InstructorAssessmentGroups({\n  groupsCsvFilename,\n  groupConfigInfo,\n  groups,\n  notAssigned,\n  resLocals,\n}: {\n  groupsCsvFilename?: string;\n  groupConfigInfo?: GroupConfig;\n  groups?: GroupUsersRow[];\n  notAssigned?: string[];\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Groups',\n    navContext: {\n      type: 'instructor',\n      page: 'assessment',\n      subPage: 'groups',\n    },\n    options: {\n      fullWidth: true,\n    },\n    headContent: html`\n      <link\n        href=\"${nodeModulesAssetPath('tablesorter/dist/css/theme.bootstrap.min.css')}\"\n        rel=\"stylesheet\"\n      />\n      <script src=\"${nodeModulesAssetPath(\n          'tablesorter/dist/js/jquery.tablesorter.min.js',\n        )}\"></script>\n      <script src=\"${nodeModulesAssetPath(\n          'tablesorter/dist/js/jquery.tablesorter.widgets.min.js',\n        )}\"></script>\n    `,\n    content: html`\n      ${AssessmentSyncErrorsAndWarnings({\n        authz_data: resLocals.authz_data,\n        assessment: resLocals.assessment,\n        courseInstance: resLocals.course_instance,\n        course: resLocals.course,\n        urlPrefix: resLocals.urlPrefix,\n      })}\n      ${!groupConfigInfo\n        ? html`\n            <div class=\"card mb-4\">\n              <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n                <h1>${resLocals.assessment_set.name} ${resLocals.assessment.number}: Groups</h1>\n              </div>\n              <div class=\"card-body\">\n                This is not a group assessment. To enable this functionality, please set\n                <code>\"groupWork\": true</code> in <code>infoAssessment.json</code>.\n              </div>\n            </div>\n          `\n        : html`\n            ${resLocals.authz_data.has_course_instance_permission_edit\n              ? html`\n                  ${UploadAssessmentGroupsModal({ csrfToken: resLocals.__csrf_token })}\n                  ${RandomAssessmentGroupsModal({\n                    groupMin: groupConfigInfo.minimum ? groupConfigInfo.minimum : 2,\n                    groupMax: groupConfigInfo.maximum ? groupConfigInfo.maximum : 5,\n                    csrfToken: resLocals.__csrf_token,\n                  })}\n                  ${AddGroupModal({ csrfToken: resLocals.__csrf_token })}\n                  ${DeleteAllGroupsModal({\n                    assessmentSetName: resLocals.assessment_set.name,\n                    assessmentNumber: resLocals.assessment.number,\n                    csrfToken: resLocals.__csrf_token,\n                  })}\n                `\n              : ''}\n            <div class=\"card mb-4\">\n              <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n                <h1>${resLocals.assessment_set.name} ${resLocals.assessment.number}: Groups</h1>\n                ${resLocals.authz_data.has_course_instance_permission_edit\n                  ? html`\n                      <div class=\"ms-auto\">\n                        <button\n                          type=\"button\"\n                          class=\"btn btn-sm btn-light\"\n                          data-bs-toggle=\"modal\"\n                          data-bs-target=\"#addGroupModal\"\n                        >\n                          <i class=\"fa fa-plus\" aria-hidden=\"true\"></i> Add a group\n                        </button>\n                        <button\n                          type=\"button\"\n                          class=\"btn btn-sm btn-danger\"\n                          data-bs-toggle=\"modal\"\n                          data-bs-target=\"#deleteAllGroupsModal\"\n                        >\n                          <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Delete all groups\n                        </button>\n                      </div>\n                    `\n                  : ''}\n              </div>\n              ${resLocals.authz_data.has_course_instance_permission_edit\n                ? html`\n                    <div class=\"container-fluid\">\n                      <div class=\"row\">\n                        <div class=\"col-sm bg-light py-4 border\" align=\"center\">\n                          <button\n                            type=\"button\"\n                            class=\"btn btn-primary text-nowrap\"\n                            data-bs-toggle=\"modal\"\n                            data-bs-target=\"#uploadAssessmentGroupsModal\"\n                          >\n                            <i class=\"fas fa-upload\" aria-hidden=\"true\"></i> Upload\n                          </button>\n                          <div class=\"mt-2\">Upload a CSV file with group assignments.</div>\n                        </div>\n                        <div class=\"col-sm bg-light py-4 border\" align=\"center\">\n                          <button\n                            type=\"button\"\n                            class=\"btn btn-primary text-nowrap\"\n                            data-bs-toggle=\"modal\"\n                            data-bs-target=\"#randomAssessmentGroupsModal\"\n                          >\n                            <i class=\"fas fa-shuffle\" aria-hidden=\"true\"></i> Random\n                          </button>\n                          <div class=\"mt-2\">Randomly assign students to groups.</div>\n                        </div>\n                      </div>\n                    </div>\n                  `\n                : ''}\n              <div class=\"table-responsive\">\n                <table\n                  id=\"usersTable\"\n                  class=\"table table-sm table-hover tablesorter\"\n                  aria-label=\"Groups\"\n                >\n                  <thead>\n                    <tr>\n                      <th>Name</th>\n                      <th>Size</th>\n                      <th class=\"text-center\">Group Members (UIDs)</th>\n                      ${resLocals.authz_data.has_course_instance_permission_edit\n                        ? html` <th class=\"sorter-false\"></th> `\n                        : ''}\n                    </tr>\n                  </thead>\n                  <tbody>\n                    ${groups?.map(function (row) {\n                      return html` <tr data-test-group-id=\"${row.group_id}\">\n                        <td>${row.name}</td>\n                        <td class=\"text-center\">${row.size}</td>\n                        <td class=\"text-center\">\n                          <small>\n                            ${row.users?.length > 0\n                              ? row.users.map((user) => user.uid).join(', ')\n                              : '(empty)'}\n                          </small>\n                        </td>\n                        ${resLocals.authz_data.has_course_instance_permission_edit\n                          ? html`\n                              <td class=\"text-center\">\n                                <div class=\"dropdown js-group-action-dropdown\">\n                                  <button\n                                    type=\"button\"\n                                    class=\"btn btn-xs btn-ghost dropdown-toggle\"\n                                    data-bs-toggle=\"dropdown\"\n                                    data-bs-boundary=\"window\"\n                                    aria-haspopup=\"true\"\n                                    aria-expanded=\"false\"\n                                  >\n                                    Action <span class=\"caret\"></span>\n                                  </button>\n                                  <div class=\"dropdown-menu\">\n                                    <button\n                                      class=\"dropdown-item js-group-action\"\n                                      data-bs-toggle=\"popover\"\n                                      data-bs-container=\"body\"\n                                      data-bs-html=\"true\"\n                                      data-bs-placement=\"auto\"\n                                      data-bs-title=\"Add members\"\n                                      data-bs-content=\"${escapeHtml(\n                                        AddMembersForm({\n                                          row,\n                                          csrfToken: resLocals.__csrf_token,\n                                        }),\n                                      )}\"\n                                    >\n                                      <i class=\"fa fa-user-plus\" aria-hidden=\"true\"></i> Add members\n                                    </button>\n                                    ${row.users.length > 0\n                                      ? html`\n                                          <button\n                                            class=\"dropdown-item js-group-action\"\n                                            data-bs-toggle=\"popover\"\n                                            data-bs-container=\"body\"\n                                            data-bs-html=\"true\"\n                                            data-bs-placement=\"auto\"\n                                            data-bs-title=\"Remove members\"\n                                            data-bs-content=\"${escapeHtml(\n                                              RemoveMembersForm({\n                                                row,\n                                                csrfToken: resLocals.__csrf_token,\n                                              }),\n                                            )}\"\n                                          >\n                                            <i class=\"fa fa-user-minus\" aria-hidden=\"true\"></i>\n                                            Remove members\n                                          </button>\n                                        `\n                                      : html`\n                                          <button class=\"dropdown-item js-group-action\" disabled>\n                                            <i class=\"fa fa-user-minus\" aria-hidden=\"true\"></i>\n                                            Remove members\n                                          </button>\n                                        `}\n                                    <button\n                                      class=\"dropdown-item js-group-action\"\n                                      data-bs-toggle=\"popover\"\n                                      data-bs-container=\"body\"\n                                      data-bs-html=\"true\"\n                                      data-bs-placement=\"auto\"\n                                      data-bs-title=\"Delete group\"\n                                      data-bs-content=\"${escapeHtml(\n                                        DeleteGroupForm({\n                                          row,\n                                          csrfToken: resLocals.__csrf_token,\n                                        }),\n                                      )}\"\n                                    >\n                                      <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Delete group\n                                    </button>\n                                  </div>\n                                </div>\n                              </td>\n                            `\n                          : ''}\n                      </tr>`;\n                    })}\n                  </tbody>\n                </table>\n                <div class=\"card-footer\">\n                  <p>\n                    Download\n                    <a\n                      href=\"${resLocals.urlPrefix}/assessment/${resLocals.assessment\n                        .id}/downloads/${groupsCsvFilename}\"\n                    >\n                      ${groupsCsvFilename}\n                    </a>\n                  </p>\n                  <small>\n                    ${notAssigned?.length === 0\n                      ? html` <strong> All students have been assigned groups. </strong> `\n                      : html`\n                          <strong>\n                            ${notAssigned?.length\n                              ? html` \n                        ${notAssigned?.length}\n                        student${notAssigned?.length > 1 ? html`s` : ''} not yet\n                        assigned:\n                      </strong>\n                      `\n                              : ''}\n                            <ul class=\"mb-0\">\n                              ${notAssigned?.map(function (uid) {\n                                return html` <li>${uid}</li> `;\n                              })}\n                            </ul>\n                          </strong>\n                        `}\n                  </small>\n                </div>\n              </div>\n              <script>\n                $(function () {\n                  $('#usersTable').tablesorter({\n                    theme: 'bootstrap',\n                    widthFixed: true,\n                    headerTemplate: '{content} {icon}',\n                    widgets: ['uitheme'],\n                    headers: {\n                      3: { sorter: false },\n                    },\n                  });\n                });\n              </script>\n            </div>\n          `}\n    `,\n  });\n}\n\nfunction AddMembersForm({ row, csrfToken }: { row: GroupUsersRow; csrfToken: string }) {\n  return html`\n    <form name=\"add-member-form\" method=\"POST\">\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"add_member_uids\">UIDs</label>\n        <input\n          type=\"text\"\n          class=\"form-control\"\n          placeholder=\"student@example.com\"\n          name=\"add_member_uids\"\n          aria-describedby=\"add_member_uids_help\"\n        />\n        <small id=\"add_member_uids_help\" class=\"form-text text-muted\">\n          Separate multiple UIDs with commas.\n        </small>\n      </div>\n      <input type=\"hidden\" name=\"__action\" value=\"add_member\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <input type=\"hidden\" name=\"group_id\" value=\"${row.group_id}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"popover\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-primary\">Add</button>\n    </form>\n  `;\n}\n\nfunction DeleteGroupForm({ row, csrfToken }: { row: GroupUsersRow; csrfToken: string }) {\n  return html`\n    <form name=\"delete-group-form\" method=\"POST\">\n      <p>Are you sure you want to delete the group <strong>${row.name}</strong>?</p>\n      <input type=\"hidden\" name=\"__action\" value=\"delete_group\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <input type=\"hidden\" name=\"group_id\" value=\"${row.group_id}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"popover\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-danger\">Delete</button>\n    </form>\n  `;\n}\n\nfunction RemoveMembersForm({ row, csrfToken }: { row: GroupUsersRow; csrfToken: string }) {\n  return html`\n    <form name=\"delete-member-form\" method=\"POST\">\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"delete-member-form-${row.group_id}\">UID:</label>\n        <select class=\"form-select\" name=\"user_id\" id=\"delete-member-form-${row.group_id}\">\n          ${row.users.map((user) => {\n            return html` <option value=\"${user.user_id}\">${user.uid}</option> `;\n          })}\n        </select>\n      </div>\n      <input type=\"hidden\" name=\"__action\" value=\"delete_member\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <input type=\"hidden\" name=\"group_id\" value=\"${row.group_id}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"popover\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-danger\" ${row.users.length > 0 ? '' : 'disabled'}>\n        Delete\n      </button>\n    </form>\n  `;\n}\n\nfunction UploadAssessmentGroupsModal({ csrfToken }: { csrfToken: string }) {\n  return Modal({\n    id: 'uploadAssessmentGroupsModal',\n    title: 'Upload new group assignments',\n    formEncType: 'multipart/form-data',\n    body: html`\n      <p>Upload a CSV file in the format of:</p>\n      <code class=\"text-dark\">\n        groupName,UID<br />\n        groupA,one@example.com<br />\n        groupA,two@example.com<br />\n        groupB,three@example.com<br />\n        groupB,four@example.com</code\n      >\n      <!-- Closing code tag not on its own line to improve copy/paste formatting -->\n      <p class=\"mt-3\">\n        The <code>groupname</code> column should be a unique identifier for each group. To change\n        the grouping, link uids to the groupname.\n      </p>\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"uploadAssessmentGroupsFileInput\"> Choose CSV file </label>\n        <input\n          type=\"file\"\n          accept=\".csv\"\n          name=\"file\"\n          class=\"form-control\"\n          id=\"uploadAssessmentGroupsFileInput\"\n        />\n      </div>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__action\" value=\"upload_assessment_groups\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-primary\">Upload</button>\n    `,\n  });\n}\n\nfunction RandomAssessmentGroupsModal({\n  groupMin,\n  groupMax,\n  csrfToken,\n}: {\n  groupMin: number;\n  groupMax: number;\n  csrfToken: string;\n}) {\n  return Modal({\n    id: 'randomAssessmentGroupsModal',\n    title: 'Random group assignments',\n    body: html`\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"formMin\">Min number of members in a group</label>\n        <input\n          type=\"number\"\n          required\n          min=\"1\"\n          value=\"${groupMin}\"\n          class=\"form-control\"\n          id=\"formMin\"\n          name=\"min_group_size\"\n        />\n      </div>\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"formMax\">Max number of members in a group</label>\n        <input\n          type=\"number\"\n          required\n          min=\"1\"\n          value=\"${groupMax}\"\n          class=\"form-control\"\n          id=\"formMax\"\n          name=\"max_group_size\"\n        />\n      </div>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__action\" value=\"random_assessment_groups\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-primary\">Group</button>\n    `,\n  });\n}\n\nfunction AddGroupModal({ csrfToken }: { csrfToken: string }) {\n  return Modal({\n    id: 'addGroupModal',\n    title: 'Add a group',\n    body: html`\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"formName\">Group Name</label>\n        <input type=\"text\" class=\"form-control\" id=\"formName\" name=\"group_name\" />\n      </div>\n      <div class=\"mb-3\">\n        <label class=\"form-label\" for=\"addGroupUids\">UIDs</label>\n        <input\n          type=\"text\"\n          class=\"form-control\"\n          id=\"addGroupUids\"\n          name=\"uids\"\n          placeholder=\"student1@example.com, student2@example.com\"\n          aria-describedby=\"addGroupUidsHelp\"\n        />\n        <small id=\"addGroupUidsHelp\" class=\"form-text text-muted\">\n          Separate multiple UIDs with commas.\n        </small>\n      </div>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__action\" value=\"add_group\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-primary\">Add</button>\n    `,\n  });\n}\n\nfunction DeleteAllGroupsModal({\n  csrfToken,\n  assessmentSetName,\n  assessmentNumber,\n}: {\n  csrfToken: string;\n  assessmentSetName: string;\n  assessmentNumber: number;\n}) {\n  return Modal({\n    id: 'deleteAllGroupsModal',\n    title: 'Delete all existing groups',\n    body: html`\n      <p>\n        Are you sure you want to delete all existing groups for\n        <strong>${assessmentSetName} ${assessmentNumber}</strong>? This cannot be undone.\n      </p>\n    `,\n    footer: html`\n      <input type=\"hidden\" name=\"__action\" value=\"delete_all\" />\n      <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n      <button type=\"submit\" class=\"btn btn-danger\">Delete all</button>\n    `,\n  });\n}\n"]}