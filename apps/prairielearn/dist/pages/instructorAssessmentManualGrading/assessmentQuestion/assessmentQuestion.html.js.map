{"version":3,"file":"assessmentQuestion.html.js","sourceRoot":"","sources":["../../../../src/pages/instructorAssessmentManualGrading/assessmentQuestion/assessmentQuestion.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { EncodedData } from '@prairielearn/browser-utils';\nimport { html } from '@prairielearn/html';\n\nimport { AssessmentOpenInstancesAlert } from '../../../components/AssessmentOpenInstancesAlert.html.js';\nimport { Modal } from '../../../components/Modal.html.js';\nimport { PageLayout } from '../../../components/PageLayout.html.js';\nimport { AssessmentSyncErrorsAndWarnings } from '../../../components/SyncErrorsAndWarnings.html.js';\nimport {\n  compiledScriptTag,\n  compiledStylesheetTag,\n  nodeModulesAssetPath,\n} from '../../../lib/assets.js';\nimport type { User } from '../../../lib/db-types.js';\n\nimport { type InstanceQuestionTableData } from './assessmentQuestion.types.js';\n\nexport function AssessmentQuestion({\n  resLocals,\n  courseStaff,\n  aiGradingEnabled,\n}: {\n  resLocals: Record<string, any>;\n  courseStaff: User[];\n  aiGradingEnabled: boolean;\n}) {\n  const {\n    number_in_alternative_group,\n    urlPrefix,\n    assessment,\n    assessment_set,\n    question,\n    __csrf_token,\n    authz_data,\n    assessment_question,\n    num_open_instances,\n    course_instance,\n    course,\n  } = resLocals;\n\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Manual Grading',\n    navContext: {\n      type: 'instructor',\n      page: 'assessment',\n      subPage: 'manual_grading',\n    },\n    options: {\n      fullWidth: true,\n      pageNote: `Question ${number_in_alternative_group}`,\n    },\n    headContent: html`\n      <!-- Importing javascript using <script> tags as below is *not* the preferred method, it is better to directly use 'import'\n        from a javascript file. However, bootstrap-table is doing some hacky stuff that prevents us from importing it that way. -->\n      <script src=\"${nodeModulesAssetPath('bootstrap-table/dist/bootstrap-table.min.js')}\"></script>\n      <script src=\"${nodeModulesAssetPath(\n          'bootstrap-table/dist/extensions/auto-refresh/bootstrap-table-auto-refresh.js',\n        )}\"></script>\n      <script src=\"${nodeModulesAssetPath(\n          'bootstrap-table/dist/extensions/filter-control/bootstrap-table-filter-control.min.js',\n        )}\"></script>\n\n      ${compiledScriptTag('bootstrap-table-sticky-header.js')}\n      ${compiledScriptTag('instructorAssessmentManualGradingAssessmentQuestionClient.ts')}\n      ${compiledStylesheetTag('instructorAssessmentManualGradingAssessmentQuestion.css')}\n      ${EncodedData<InstanceQuestionTableData>(\n        {\n          hasCourseInstancePermissionEdit: !!authz_data.has_course_instance_permission_edit,\n          urlPrefix,\n          instancesUrl: `${urlPrefix}/assessment/${assessment.id}/manual_grading/assessment_question/${assessment_question.id}/instances.json`,\n          maxPoints: assessment_question.max_points,\n          groupWork: assessment.group_work,\n          maxAutoPoints: assessment_question.max_auto_points,\n          aiGradingEnabled,\n          courseStaff,\n          csrfToken: __csrf_token,\n          aiGradingUrl: `${urlPrefix}/assessment/${assessment.id}/manual_grading/assessment_question/${assessment_question.id}/ai_grading_runs`,\n        },\n        'instance-question-table-data',\n      )}\n    `,\n    content: html`\n      ${AssessmentSyncErrorsAndWarnings({\n        authz_data,\n        assessment,\n        courseInstance: course_instance,\n        course,\n        urlPrefix,\n      })}\n      ${AssessmentOpenInstancesAlert({\n        numOpenInstances: num_open_instances,\n        assessmentId: assessment.id,\n        urlPrefix,\n      })}\n\n      <a\n        class=\"btn btn-primary mb-2\"\n        href=\"${urlPrefix}/assessment/${assessment.id}/manual_grading\"\n      >\n        <i class=\"fas fa-arrow-left\"></i>\n        Back to ${assessment_set.name} ${assessment.number} Overview\n      </a>\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white\">\n          <h1>${assessment.tid} / Question ${number_in_alternative_group}. ${question.title}</h1>\n        </div>\n        <form name=\"grading-form\" method=\"POST\">\n          <input type=\"hidden\" name=\"__action\" value=\"batch_action\" />\n          <input type=\"hidden\" name=\"__csrf_token\" value=\"${__csrf_token}\" />\n          <table id=\"grading-table\" aria-label=\"Instance questions for manual grading\"></table>\n        </form>\n      </div>\n    `,\n    postContent: [GradingConflictModal()],\n  });\n}\n\nfunction GradingConflictModal() {\n  return Modal({\n    id: 'grading-conflict-modal',\n    title: 'Grading conflict detected',\n    body: html`<p>Another grader has already graded this submission.</p>`,\n    footer: html`\n      <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Dismiss</button>\n      <a class=\"btn btn-primary conflict-details-link\" href=\"/\">See details</a>\n    `,\n  });\n}\n"]}