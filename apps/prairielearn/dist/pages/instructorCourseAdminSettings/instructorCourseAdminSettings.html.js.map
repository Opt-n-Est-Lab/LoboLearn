{"version":3,"file":"instructorCourseAdminSettings.html.js","sourceRoot":"","sources":["../../../src/pages/instructorCourseAdminSettings/instructorCourseAdminSettings.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { html } from '@prairielearn/html';\n\nimport { PageLayout } from '../../components/PageLayout.html.js';\nimport { CourseSyncErrorsAndWarnings } from '../../components/SyncErrorsAndWarnings.html.js';\nimport { compiledScriptTag } from '../../lib/assets.js';\nimport { type Timezone, formatTimezone } from '../../lib/timezones.js';\n\nexport function InstructorCourseAdminSettings({\n  resLocals,\n  coursePathExists,\n  courseInfoExists,\n  availableTimezones,\n  origHash,\n}: {\n  resLocals: Record<string, any>;\n  coursePathExists: boolean;\n  courseInfoExists: boolean;\n  availableTimezones: Timezone[];\n  origHash: string;\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Course Settings',\n    navContext: {\n      type: 'instructor',\n      page: 'course_admin',\n      subPage: 'settings',\n    },\n    headContent: [compiledScriptTag('instructorCourseAdminSettingsClient.ts')],\n    content: html`\n      ${CourseSyncErrorsAndWarnings({\n        authz_data: resLocals.authz_data,\n        course: resLocals.course,\n        urlPrefix: resLocals.urlPrefix,\n      })}\n\n      <div class=\"card  mb-4\">\n        <div class=\"card-header bg-primary text-white d-flex\">\n          <h1>\n            ${resLocals.has_enhanced_navigation ? 'General course settings' : 'Course Settings'}\n          </h1>\n        </div>\n        <div class=\"card-body\">\n          ${!courseInfoExists || !coursePathExists\n            ? CourseDirectoryMissingAlert({\n                resLocals,\n                coursePathExists,\n                courseInfoExists,\n              })\n            : ''}\n          <form name=\"edit-course-settings-form\" method=\"POST\">\n            <input type=\"hidden\" name=\"__csrf_token\" value=\"${resLocals.__csrf_token}\" />\n            <input type=\"hidden\" name=\"orig_hash\" value=\"${origHash}\" />\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"short_name\">Short Name</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"short_name\"\n                name=\"short_name\"\n                value=\"${resLocals.course.short_name}\"\n                required\n                ${courseInfoExists &&\n                resLocals.authz_data.has_course_permission_edit &&\n                !resLocals.course.example_course\n                  ? ''\n                  : 'disabled'}\n              />\n              <small class=\"form-text text-muted\">\n                The short name of the course. Often this is the course rubric and number (e.g.,\n                \"MATH 101\" or \"PHYS 440\").\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"title\">Title</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"title\"\n                name=\"title\"\n                value=\"${resLocals.course.title}\"\n                required\n                ${courseInfoExists &&\n                resLocals.authz_data.has_course_permission_edit &&\n                !resLocals.course.example_course\n                  ? ''\n                  : 'disabled'}\n              />\n              <small class=\"form-text text-muted\">\n                This is the official title of the course, as given in the course catalog.\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"display_timezone\">Timezone</label>\n              <select\n                class=\"form-select\"\n                id=\"display_timezone\"\n                name=\"display_timezone\"\n                ${courseInfoExists &&\n                resLocals.authz_data.has_course_permission_edit &&\n                !resLocals.course.example_course\n                  ? ''\n                  : 'disabled'}\n              >\n                ${availableTimezones.map(\n                  (tz) => html`\n                    <option\n                      value=\"${tz.name}\"\n                      ${tz.name === resLocals.course.display_timezone ? 'selected' : ''}\n                    >\n                      ${formatTimezone(tz)}\n                    </option>\n                  `,\n                )}\n              </select>\n              <small class=\"form-text text-muted\">\n                The allowable timezones are from the\n                <a\n                  href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\"\n                  target=\"_blank\"\n                  >tz database</a\n                >. It's best to use a city-based timezone that has the same times as you.\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"institution\">Institution</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"institution\"\n                name=\"institution\"\n                value=\"${resLocals.institution.short_name} (${resLocals.institution.long_name})\"\n                disabled\n              />\n              <small class=\"form-text text-muted\">\n                This is your academic institution (e.g., \"University of Illinois\").\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"path\">Path</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"path\"\n                name=\"path\"\n                value=\"${resLocals.course.path}\"\n                disabled\n              />\n              <small class=\"form-text text-muted\">\n                The path where course files can be found.\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"repository\">Repository</label>\n              <span class=\"input-group\">\n                <input\n                  type=\"text\"\n                  class=\"form-control\"\n                  id=\"repository\"\n                  name=\"repository\"\n                  value=\"${resLocals.course.repository}\"\n                  disabled\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn btn-sm btn-outline-secondary btn-copy\"\n                  data-clipboard-text=\"${resLocals.course.repository}\"\n                  aria-label=\"Copy repository\"\n                  ${resLocals.course.repository ? '' : 'disabled'}\n                >\n                  <i class=\"far fa-clipboard\"></i>\n                </button>\n              </span>\n              <small class=\"form-text text-muted\">\n                The Github repository that can be used to sync course files.\n              </small>\n            </div>\n            <div class=\"form-check mb-3\">\n              <input\n                type=\"checkbox\"\n                class=\"form-check-input\"\n                id=\"show_getting_started\"\n                name=\"show_getting_started\"\n                ${resLocals.course.show_getting_started ? 'checked' : ''}\n              />\n              <label class=\"form-check-label\" for=\"show_getting_started\">\n                Show the getting started checklist\n              </label>\n            </div>\n            ${EditActions({\n              coursePathExists,\n              courseInfoExists,\n              hasCoursePermissionView: resLocals.authz_data.has_course_permission_view,\n              hasCoursePermissionEdit: resLocals.authz_data.has_course_permission_edit,\n              exampleCourse: resLocals.course.example_course,\n              urlPrefix: resLocals.urlPrefix,\n              navPage: 'course_admin',\n            })}\n          </form>\n        </div>\n      </div>\n    `,\n  });\n}\n\nfunction CourseDirectoryMissingAlert({\n  resLocals,\n  coursePathExists,\n  courseInfoExists,\n}: {\n  resLocals: Record<string, any>;\n  coursePathExists: boolean;\n  courseInfoExists: boolean;\n}) {\n  if (!resLocals.authz_data.has_course_permission_edit || resLocals.course.example_course) {\n    return;\n  }\n  if (!coursePathExists) {\n    return html`\n      <div class=\"alert alert-danger\">\n        Course directory not found. You must\n        <a href=\"${resLocals.urlPrefix}/course_admin/syncs\">sync your course</a>.\n      </div>\n    `;\n  } else if (!courseInfoExists) {\n    return html`\n      <form name=\"add-configuration-form\" method=\"POST\" class=\"alert alert-danger\">\n        <code>infoCourse.json</code> is missing. You must\n        <input type=\"hidden\" name=\"__csrf_token\" value=\"${resLocals.__csrf_token}\" />\n        <button\n          name=\"__action\"\n          value=\"add_configuration\"\n          class=\"btn btn-link btn-link-inline mt-n1 p-0 border-0 \"\n        >\n          create this file\n        </button>\n        to edit your course settings.\n      </form>\n    `;\n  }\n}\n\nfunction EditActions({\n  coursePathExists,\n  courseInfoExists,\n  hasCoursePermissionView,\n  hasCoursePermissionEdit,\n  exampleCourse,\n  urlPrefix,\n  navPage,\n}: {\n  coursePathExists: boolean;\n  courseInfoExists: boolean;\n  hasCoursePermissionView: boolean;\n  hasCoursePermissionEdit: boolean;\n  exampleCourse: boolean;\n  urlPrefix: string;\n  navPage: string;\n}) {\n  if (!coursePathExists || !courseInfoExists || !hasCoursePermissionView) {\n    return '';\n  }\n\n  if (!hasCoursePermissionEdit || exampleCourse) {\n    return html`\n      <p class=\"mb-0\">\n        <a href=\"${urlPrefix}/${navPage}/file_view/infoCourse.json\"> View course configuration </a>\n        in <code>infoCourse.json</code>\n      </p>\n    `;\n  }\n\n  return html`\n    <button\n      id=\"save-button\"\n      type=\"submit\"\n      class=\"btn btn-primary mb-2\"\n      name=\"__action\"\n      value=\"update_configuration\"\n    >\n      Save\n    </button>\n    <button\n      id=\"cancel-button\"\n      type=\"button\"\n      class=\"btn btn-secondary mb-2\"\n      onclick=\"window.location.reload()\"\n    >\n      Cancel\n    </button>\n    <p class=\"mb-0\">\n      <a\n        data-testid=\"edit-course-configuration-link\"\n        href=\"${urlPrefix}/${navPage}/file_edit/infoCourse.json\"\n      >\n        Edit course configuration\n      </a>\n      in <code>infoCourse.json</code>\n    </p>\n  `;\n}\n"]}