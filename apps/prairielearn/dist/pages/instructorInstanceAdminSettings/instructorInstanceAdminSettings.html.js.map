{"version":3,"file":"instructorInstanceAdminSettings.html.js","sourceRoot":"","sources":["../../../src/pages/instructorInstanceAdminSettings/instructorInstanceAdminSettings.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { html } from '@prairielearn/html';\n\nimport { Modal } from '../../components/Modal.html.js';\nimport { PageLayout } from '../../components/PageLayout.html.js';\nimport { QRCodeModal } from '../../components/QRCodeModal.html.js';\nimport { CourseInstanceSyncErrorsAndWarnings } from '../../components/SyncErrorsAndWarnings.html.js';\nimport { compiledScriptTag } from '../../lib/assets.js';\nimport { type Timezone, formatTimezone } from '../../lib/timezones.js';\nimport { encodePath } from '../../lib/uri-util.js';\n\nexport function InstructorInstanceAdminSettings({\n  resLocals,\n  shortNames,\n  studentLink,\n  infoCourseInstancePath,\n  availableTimezones,\n  origHash,\n  canEdit,\n}: {\n  resLocals: Record<string, any>;\n  shortNames: string[];\n  studentLink: string;\n  infoCourseInstancePath: string;\n  availableTimezones: Timezone[];\n  origHash: string;\n  canEdit: boolean;\n}) {\n  return PageLayout({\n    resLocals,\n    pageTitle: 'Settings',\n    navContext: {\n      type: 'instructor',\n      page: 'instance_admin',\n      subPage: 'settings',\n    },\n    headContent: [compiledScriptTag('instructorInstanceAdminSettingsClient.ts')],\n    content: html`\n      ${CourseInstanceSyncErrorsAndWarnings({\n        authz_data: resLocals.authz_data,\n        courseInstance: resLocals.course_instance,\n        course: resLocals.course,\n        urlPrefix: resLocals.urlPrefix,\n      })}\n      ${QRCodeModal({\n        id: 'studentLinkModal',\n        title: 'Student Link QR Code',\n        content: studentLink,\n      })}\n      <div class=\"card mb-4\">\n        <div class=\"card-header bg-primary text-white d-flex\">\n          <h1>\n            ${resLocals.has_enhanced_navigation\n              ? 'General course instance settings'\n              : 'Course instance settings'}\n          </h1>\n        </div>\n        <div class=\"card-body\">\n          <form name=\"edit-course-instance-settings-form\" method=\"POST\">\n            <input type=\"hidden\" name=\"__csrf_token\" value=\"${resLocals.__csrf_token}\" />\n            <input type=\"hidden\" name=\"orig_hash\" value=\"${origHash}\" />\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"ciid\">CIID</label>\n              <input\n                type=\"text\"\n                class=\"form-control font-monospace\"\n                id=\"ciid\"\n                name=\"ciid\"\n                value=\"${resLocals.course_instance.short_name}\"\n                pattern=\"[\\\\-A-Za-z0-9_\\\\/]+\"\n                required\n                data-other-values=\"${shortNames.join(',')}\"\n                ${canEdit ? '' : 'disabled'}\n              />\n              <small class=\"form-text text-muted\">\n                Use only letters, numbers, dashes, and underscores, with no spaces. You may use\n                forward slashes to separate directories. The recommended format is\n                <code>Fa19</code> or <code>Fall2019</code>. Add suffixes if there are multiple\n                versions, like <code>Fa19honors</code>.\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"long_name\">Long Name</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                id=\"long_name\"\n                name=\"long_name\"\n                value=\"${resLocals.course_instance.long_name}\"\n                required\n                ${canEdit ? '' : 'disabled'}\n              />\n              <small class=\"form-text text-muted\">\n                The long name of this course instance (e.g., 'Spring 2015').\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"display_timezone\">Timezone</label>\n              <select\n                class=\"form-select\"\n                id=\"display_timezone\"\n                name=\"display_timezone\"\n                ${canEdit ? '' : 'disabled'}\n              >\n                ${availableTimezones.map(\n                  (tz) => html`\n                    <option\n                      value=\"${tz.name}\"\n                      ${tz.name === resLocals.course_instance.display_timezone ? 'selected' : ''}\n                    >\n                      ${formatTimezone(tz)}\n                    </option>\n                  `,\n                )}\n              </select>\n              <small class=\"form-text text-muted\">\n                The allowable timezones are from the\n                <a\n                  href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\"\n                  target=\"_blank\"\n                  >tz database</a\n                >. It's best to use a city-based timezone that has the same times as you.\n              </small>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"group_assessments_by\">Group assessments by</label>\n              <select\n                class=\"form-select\"\n                id=\"group_assessments_by\"\n                name=\"group_assessments_by\"\n                ${canEdit ? '' : 'disabled'}\n              >\n                <option\n                  value=\"Set\"\n                  ${resLocals.course_instance.assessments_group_by === 'Set' ? 'selected' : ''}\n                >\n                  Set\n                </option>\n                <option\n                  value=\"Module\"\n                  ${resLocals.course_instance.assessments_group_by === 'Module' ? 'selected' : ''}\n                >\n                  Module\n                </option>\n              </select>\n              <small class=\"form-text text-muted\">\n                Determines how assessments will be grouped on the student assessments page.\n              </small>\n            </div>\n            <div class=\"mb-3 form-check\">\n              <input\n                class=\"form-check-input\"\n                type=\"checkbox\"\n                id=\"hide_in_enroll_page\"\n                name=\"hide_in_enroll_page\"\n                ${canEdit ? '' : 'disabled'}\n                ${resLocals.course_instance.hide_in_enroll_page ? 'checked' : ''}\n              />\n              <label class=\"form-check-label\" for=\"hide_in_enroll_page\">\n                Hide in enrollment page\n              </label>\n              <div class=\"small text-muted\">\n                If enabled, hides the course instance in the enrollment page, so that only direct\n                links to the course can be used for enrollment.\n              </div>\n            </div>\n            <div class=\"mb-3\">\n              <label class=\"form-label\" for=\"student_link\">Student Link</label>\n              <span class=\"input-group\">\n                <input\n                  type=\"text\"\n                  class=\"form-control\"\n                  id=\"student_link\"\n                  name=\"student_link\"\n                  value=\"${studentLink}\"\n                  disabled\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn btn-sm btn-outline-secondary btn-copy\"\n                  data-clipboard-text=\"${studentLink}\"\n                  aria-label=\"Copy student link\"\n                >\n                  <i class=\"far fa-clipboard\"></i>\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"btn btn-sm btn-outline-secondary\"\n                  aria-label=\"Student Link QR Code\"\n                  data-bs-toggle=\"modal\"\n                  data-bs-target=\"#studentLinkModal\"\n                >\n                  <i class=\"fas fa-qrcode\"></i>\n                </button>\n              </span>\n              <small class=\"form-text text-muted\">\n                This is the link that students will use to access the course. You can copy this link\n                to share with students.\n              </small>\n            </div>\n            ${EditConfiguration({\n              hasCoursePermissionView: resLocals.authz_data.has_course_permission_view,\n              hasCoursePermissionEdit: resLocals.authz_data.has_course_permission_edit,\n              exampleCourse: resLocals.course.example_course,\n              urlPrefix: resLocals.urlPrefix,\n              navPage: resLocals.navPage,\n              infoCourseInstancePath,\n            })}\n          </form>\n        </div>\n        ${resLocals.authz_data.has_course_permission_edit && !resLocals.course.example_course\n          ? CopyCourseInstanceForm({\n              csrfToken: resLocals.__csrf_token,\n              shortName: resLocals.course_instance.short_name,\n            })\n          : ''}\n      </div>\n    `,\n  });\n}\n\nfunction EditConfiguration({\n  hasCoursePermissionView,\n  hasCoursePermissionEdit,\n  exampleCourse,\n  urlPrefix,\n  navPage,\n  infoCourseInstancePath,\n}: {\n  hasCoursePermissionView: boolean;\n  hasCoursePermissionEdit: boolean;\n  exampleCourse: boolean;\n  urlPrefix: string;\n  navPage: string;\n  infoCourseInstancePath: string;\n}) {\n  if (!hasCoursePermissionView && !hasCoursePermissionEdit) {\n    return '';\n  }\n\n  if (!hasCoursePermissionEdit || exampleCourse) {\n    return html`\n      <p class=\"mb-0\">\n        <a href=\"${urlPrefix}/${navPage}/file_view/${infoCourseInstancePath}\">\n          View course instance configuration\n        </a>\n        in <code>infoCourseInstance.json</code>\n      </p>\n    `;\n  } else {\n    return html`\n      <button\n        id=\"save-button\"\n        type=\"submit\"\n        class=\"btn btn-primary mb-2\"\n        name=\"__action\"\n        value=\"update_configuration\"\n      >\n        Save\n      </button>\n      <button\n        id=\"cancel-button\"\n        type=\"button\"\n        class=\"btn btn-secondary mb-2\"\n        onclick=\"window.location.reload()\"\n      >\n        Cancel\n      </button>\n      <p class=\"mb-0\">\n        <a\n          data-testid=\"edit-course-instance-configuration-link\"\n          href=\"${encodePath(`${urlPrefix}/${navPage}/file_edit/${infoCourseInstancePath}`)}\"\n          >Edit course instance configuration</a\n        >\n        in <code>infoCourseInstance.json</code>\n      </p>\n    `;\n  }\n}\n\nfunction CopyCourseInstanceForm({\n  csrfToken,\n  shortName,\n}: {\n  csrfToken: string;\n  shortName: string;\n}) {\n  return html`\n    <div class=\"card-footer d-flex flex-wrap align-items-center\">\n      <form name=\"copy-course-instance-form\" class=\"me-2\" method=\"POST\">\n        <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n        <button\n          type=\"submit\"\n          name=\"__action\"\n          value=\"copy_course_instance\"\n          class=\"btn btn-sm btn-primary\"\n        >\n          <i class=\"fa fa-clone\"></i> Make a copy of this course instance\n        </button>\n      </form>\n      <button\n        type=\"button\"\n        class=\"btn btn-sm btn-primary\"\n        data-bs-toggle=\"modal\"\n        data-bs-target=\"#deleteCourseInstanceModal\"\n      >\n        <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Delete this course instance\n      </button>\n      ${Modal({\n        id: 'deleteCourseInstanceModal',\n        title: 'Delete course instance',\n        body: html`\n          <p>Are you sure you want to delete the course instance <strong>${shortName}</strong>?</p>\n        `,\n        footer: html`\n          <input type=\"hidden\" name=\"__action\" value=\"delete_course_instance\" />\n          <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n          <button type=\"submit\" class=\"btn btn-danger\">Delete</button>\n        `,\n      })}\n    </div>\n  `;\n}\n"]}