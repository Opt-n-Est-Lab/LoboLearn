{"version":3,"file":"instructorRequestCourse.html.js","sourceRoot":"","sources":["../../../src/pages/instructorRequestCourse/instructorRequestCourse.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from 'zod';\n\nimport { EncodedData } from '@prairielearn/browser-utils';\nimport { type HtmlValue, html } from '@prairielearn/html';\n\nimport { Modal } from '../../components/Modal.html.js';\nimport { PageLayout } from '../../components/PageLayout.html.js';\nimport { compiledScriptTag } from '../../lib/assets.js';\nimport { type CourseRequest, CourseRequestSchema, UserSchema } from '../../lib/db-types.js';\n\nexport const CourseRequestRowSchema = z.object({\n  course_request: CourseRequestSchema,\n  approved_by_user: UserSchema.nullable(),\n});\ntype CourseRequestRow = z.infer<typeof CourseRequestRowSchema>;\n\nexport const Lti13CourseRequestInputSchema = z\n  .object({\n    'cr-firstname': z.string(),\n    'cr-lastname': z.string(),\n    'cr-email': z.string(),\n    'cr-shortname': z.string(),\n    'cr-title': z.string(),\n    'cr-institution': z.string(),\n  })\n  .nullable();\nexport type Lti13CourseRequestInput = z.infer<typeof Lti13CourseRequestInputSchema>;\n\nexport function RequestCourse({\n  rows,\n  lti13Info,\n  resLocals,\n}: {\n  rows: CourseRequestRow[];\n  lti13Info: Lti13CourseRequestInput;\n  resLocals: Record<string, any>;\n}) {\n  return PageLayout({\n    pageTitle: 'Request a Course',\n    resLocals,\n    navContext: {\n      type: 'plain',\n      page: 'request_course',\n    },\n    headContent: [compiledScriptTag('instructorRequestCourseClient.ts')],\n    content: html`\n      <h1 class=\"visually-hidden\">Request a Course</h1>\n      ${CourseRequestsCard({ rows })} ${EncodedData(lti13Info, 'course-request-lti13-info')}\n      ${Modal({\n        id: 'fill-course-request-lti13-modal',\n        title: `Auto-fill with ${lti13Info?.['cr-institution'] ?? 'LMS'} data?`,\n        form: false,\n        body: html`\n          <p>\n            You appear to be coming from a course in another learning system. Should we partially\n            fill in this request form with information from that course?\n          </p>\n          <p>(You can edit it after it's auto-filled.)</p>\n        `,\n        footer: html`\n          <button type=\"button\" class=\"btn btn-success\" id=\"fill-course-request-lti13-info\">\n            Fill from LMS data\n          </button>\n          <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n            Don't fill\n          </button>\n        `,\n      })}\n      ${CourseNewRequestCard({ csrfToken: resLocals.__csrf_token })}\n    `,\n  });\n}\n\nfunction CourseRequestsCard({ rows }: { rows: CourseRequestRow[] }): HtmlValue {\n  if (rows.length === 0) {\n    return '';\n  }\n\n  return html`\n    <div class=\"card mb-4\">\n      <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n        <h2>Course Requests</h2>\n      </div>\n      <div class=\"table-responsive\">\n        <table class=\"table table-sm table-hover table-striped\" aria-label=\"Course requests\">\n          <thead>\n            <tr>\n              <th>Short Name</th>\n              <th>Title</th>\n              <th>Status</th>\n              <th>Details</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${rows.map(({ course_request, approved_by_user }) => {\n              let details = '';\n              switch (course_request.approved_status) {\n                case 'approved':\n                  if (approved_by_user) {\n                    details = `Approved by ${approved_by_user.name}`;\n                  } else {\n                    details = 'Automatically approved';\n                  }\n                  break;\n                case 'denied':\n                  details = `Denied by ${approved_by_user?.name ?? 'unknown'}`;\n                  break;\n              }\n\n              return html`\n                <tr>\n                  <td>${course_request.short_name}</td>\n                  <td>${course_request.title}</td>\n                  <td>${ApprovalStatusIcon({ status: course_request.approved_status })}</td>\n                  <td>${details}</td>\n                </tr>\n              `;\n            })}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  `;\n}\n\nfunction CourseNewRequestCard({ csrfToken }: { csrfToken: string }): HtmlValue {\n  return html`\n    <div class=\"card mb-4\">\n      <div class=\"card-header bg-primary text-white d-flex align-items-center\">\n        <h2>Request a New Course</h2>\n      </div>\n      <form class=\"question-form\" name=\"course-request\" method=\"POST\">\n        <div class=\"card-body\">\n          <p>\n            This form is for instructors who want to create a new course on PrairieLearn. Students\n            should <strong>not</strong> submit this form and should instead use the \"Add or remove\n            courses\" button on the PrairieLearn homepage. Teaching assistants and course staff are\n            granted access by the owner of their course and should <strong>not</strong> submit this\n            form.\n          </p>\n\n          <div class=\"row\">\n            <div class=\"mb-3 col-md-6\">\n              <label class=\"form-label\" for=\"cr-firstname\">First name</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"cr-firstname\"\n                id=\"cr-firstname\"\n                minlength=\"1\"\n                required\n              />\n            </div>\n            <div class=\"mb-3 col-md-6\">\n              <label class=\"form-label\" for=\"cr-lastname\">Last name</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"cr-lastname\"\n                id=\"cr-lastname\"\n                minlength=\"1\"\n                required\n              />\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"mb-3 col-md-6\">\n              <label class=\"form-label\" for=\"cr-institution\">Institution</label>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"cr-institution\"\n                id=\"cr-institution\"\n                minlength=\"1\"\n                required\n              />\n              <small class=\"form-text text-muted\">\n                This is your academic institution (e.g., \"University of Illinois\").\n              </small>\n            </div>\n            <div class=\"mb-3 col-md-6\">\n              <label class=\"form-label\" for=\"cr-email\">Email</label>\n              <input\n                type=\"email\"\n                class=\"form-control\"\n                name=\"cr-email\"\n                id=\"cr-email\"\n                placeholder=\"login@yourinstitution.edu\"\n                minlength=\"1\"\n                required\n              />\n              <small class=\"form-text text-muted\"> Use your official work email address. </small>\n            </div>\n          </div>\n          <div class=\"mb-3\">\n            <label class=\"form-label\" for=\"cr-shortname\">Course Rubric and Number</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              name=\"cr-shortname\"\n              id=\"cr-shortname\"\n              placeholder=\"MATH 101\"\n              pattern=\"[a-zA-Z]+ [a-zA-Z0-9]+\"\n              required\n            />\n            <small class=\"form-text text-muted\"> Examples: MATH 101, PHYS 440. </small>\n          </div>\n          <div class=\"mb-3\">\n            <label class=\"form-label\" for=\"cr-title\">Course Title</label>\n            <input\n              type=\"text\"\n              class=\"form-control\"\n              name=\"cr-title\"\n              id=\"cr-title\"\n              placeholder=\"Elementary Mathematics\"\n              minlength=\"1\"\n              required\n            />\n            <small class=\"form-text text-muted\">\n              This is the official title of the course, as given in the course catalog.\n            </small>\n          </div>\n          <div class=\"mb-3\">\n            <label class=\"form-label\" for=\"cr-ghuser\">GitHub Username (optional)</label>\n            <input type=\"text\" class=\"form-control\" name=\"cr-ghuser\" id=\"cr-ghuser\" />\n            <small class=\"form-text text-muted\">\n              Providing your GitHub username will allow you to edit course content offline. You do\n              not need to provide this if you would like to use the online web editor.\n            </small>\n          </div>\n          <div class=\"mb-3\">\n            <label class=\"form-label\" id=\"cr-referral-source-label\" for=\"cr-referral-source\">\n              How did you hear about PrairieLearn?\n            </label>\n            <select\n              class=\"form-select\"\n              name=\"cr-referral-source\"\n              id=\"cr-referral-source\"\n              aria-labelledby=\"cr-referral-source-label\"\n              required\n            >\n              <option value=\"\" disabled selected></option>\n              <option value=\"I've used PrairieLearn before\">I've used PrairieLearn before</option>\n              <option value=\"Word of mouth\">Word of mouth</option>\n              <option value=\"Web search\">Web search</option>\n              <option value=\"Conference or workshop\">Conference or workshop</option>\n              <option value=\"Publication\">Publication</option>\n              <option value=\"other\">Other...</option>\n            </select>\n            <input\n              type=\"text\"\n              class=\"form-control mt-2 d-none\"\n              name=\"cr-referral-source-other\"\n              id=\"cr-referral-source-other\"\n              aria-labelledby=\"cr-referral-source-label\"\n            />\n            <small class=\"form-text text-muted\">\n              This information helps us understand how people find out about PrairieLearn. Thank you\n              for sharing!\n            </small>\n          </div>\n          <div class=\"mb-3\">\n            <label class=\"form-label\" for=\"role-instructor\">Your Role in the Course</label>\n            <ul class=\"list-group\">\n              <li class=\"list-group-item\">\n                <input type=\"radio\" id=\"role-instructor\" name=\"cr-role\" value=\"instructor\" />\n                <label for=\"role-instructor\" class=\"mb-0 form-check-label\">\n                  Official Course Instructor\n                </label>\n              </li>\n              <li class=\"list-group-item\">\n                <input type=\"radio\" id=\"role-ta\" name=\"cr-role\" value=\"ta\" />\n                <label for=\"role-ta\" class=\"mb-0 form-check-label\">\n                  Teaching Assistant or other course staff\n                </label>\n              </li>\n              <li class=\"list-group-item\">\n                <input type=\"radio\" id=\"role-admin\" name=\"cr-role\" value=\"admin\" />\n                <label for=\"role-admin\" class=\"mb-0 form-check-label\">\n                  Institution Administrative Staff\n                </label>\n              </li>\n              <li class=\"list-group-item\">\n                <input type=\"radio\" id=\"role-student\" name=\"cr-role\" value=\"student\" />\n                <label for=\"role-student\" class=\"mb-0 form-check-label\">Student</label>\n              </li>\n            </ul>\n            <div\n              style=\"display: none;\"\n              class=\"role-comment role-comment-ta role-comment-admin form-text card\"\n            >\n              <p class=\"card-body\">\n                <b>A new course instance must be requested by the instructor.</b> Please ask the\n                official course instructor to submit this form.\n              </p>\n            </div>\n            <div style=\"display: none;\" class=\"role-comment role-comment-student form-text card\">\n              <p class=\"card-body\">\n                <b>This is the wrong form for you.</b> If you would like to enroll in an existing\n                course, please use the <a href=\"enroll\">form to Enroll in a course</a>. If your\n                course is not listed there, contact your instructor for instructions on how to\n                access your assessments.\n              </p>\n            </div>\n          </div>\n        </div>\n        <div class=\"card-footer\">\n          <input type=\"hidden\" name=\"__csrf_token\" value=\"${csrfToken}\" />\n          <button class=\"btn btn-primary\" type=\"submit\" disabled>Submit Request</button>\n        </div>\n      </form>\n    </div>\n  `;\n}\n\nfunction ApprovalStatusIcon({ status }: { status: CourseRequest['approved_status'] }) {\n  if (status === 'pending' || status === 'creating' || status === 'failed') {\n    return html`<span class=\"badge text-bg-secondary\"> <i class=\"fa fa-clock\"></i> Pending</span>`;\n  } else if (status === 'approved') {\n    return html`<span class=\"badge text-bg-success\"> <i class=\"fa fa-check\"></i> Approved</span>`;\n  } else if (status === 'denied') {\n    return html`<span class=\"badge text-bg-danger\"><i class=\"fa fa-times\"></i> Denied</span>`;\n  }\n}\n"]}