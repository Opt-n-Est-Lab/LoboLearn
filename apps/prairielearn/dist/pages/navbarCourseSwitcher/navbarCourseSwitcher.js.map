{"version":3,"file":"navbarCourseSwitcher.js","sourceRoot":"","sources":["../../../src/pages/navbarCourseSwitcher/navbarCourseSwitcher.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,SAAS,CAAC;AACjC,OAAO,YAAY,MAAM,uBAAuB,CAAC;AAEjD,OAAO,EAAE,QAAQ,EAAE,MAAM,iBAAiB,CAAC;AAC3C,OAAO,EAAE,4BAA4B,EAAE,MAAM,wBAAwB,CAAC;AAEtE,OAAO,EAAE,oBAAoB,EAAE,MAAM,gCAAgC,CAAC;AAEtE,MAAM,MAAM,GAAG,MAAM,CAAC;IACpB,WAAW,EAAE,IAAI,EAAE,6FAA6F;CACjH,CAAC,CAAC;AAEH,MAAM,CAAC,GAAG,CACR,GAAG,EACH,YAAY,CAAC,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAC9B,IAAI,OAAO,GAAG,MAAM,4BAA4B,CAAC;QAC/C,OAAO,EAAE,GAAG,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO;QACtC,gBAAgB,EAAE,GAAG,CAAC,MAAM,CAAC,gBAAgB;KAC9C,CAAC,CAAC;IAEH,2EAA2E;IAC3E,yEAAyE;IACzE,2EAA2E;IAC3E,qBAAqB;IACrB,IAAI,GAAG,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAC;QAClC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,EAAE,GAAG,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;IACxE,CAAC;IAED,GAAG,CAAC,IAAI,CACN,oBAAoB,CAAC;QACnB,OAAO;QACP,iBAAiB,EAAE,GAAG,CAAC,MAAM,CAAC,SAAS;QACvC,cAAc,EAAE,GAAG,CAAC,MAAM,CAAC,cAAc;KAC1C,CAAC,CACH,CAAC;AACJ,CAAC,CAAC,CACH,CAAC;AAEF,eAAe,MAAM,CAAC","sourcesContent":["import { Router } from 'express';\nimport asyncHandler from 'express-async-handler';\n\nimport { idsEqual } from '../../lib/id.js';\nimport { selectCoursesWithStaffAccess } from '../../models/course.js';\n\nimport { NavbarCourseSwitcher } from './navbarCourseSwitcher.html.js';\n\nconst router = Router({\n  mergeParams: true, // Ensures that navbarCourseSwitcher can retrieve req.params.course_id from the parent router\n});\n\nrouter.get(\n  '/',\n  asyncHandler(async (req, res) => {\n    let courses = await selectCoursesWithStaffAccess({\n      user_id: res.locals.authn_user.user_id,\n      is_administrator: res.locals.is_administrator,\n    });\n\n    // If the user is trying to emulate another user, limit the switcher to the\n    // current course. This shouldn't really matter since we're already using\n    // the authenticated user to fetch the list of courses, but this could help\n    // prevent confusion.\n    if (req.cookies.pl2_requested_uid) {\n      courses = courses.filter((c) => idsEqual(c.id, req.params.course_id));\n    }\n\n    res.send(\n      NavbarCourseSwitcher({\n        courses,\n        current_course_id: req.params.course_id,\n        plainUrlPrefix: res.locals.plainUrlPrefix,\n      }),\n    );\n  }),\n);\n\nexport default router;\n"]}