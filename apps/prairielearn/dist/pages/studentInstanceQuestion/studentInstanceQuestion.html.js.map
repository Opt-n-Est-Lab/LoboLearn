{"version":3,"file":"studentInstanceQuestion.html.js","sourceRoot":"","sources":["../../../src/pages/studentInstanceQuestion/studentInstanceQuestion.html.ts"],"names":[],"mappings":"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","sourcesContent":["import { EncodedData } from '@prairielearn/browser-utils';\nimport { html, unsafeHtml } from '@prairielearn/html';\n\nimport {\n  RegenerateInstanceAlert,\n  RegenerateInstanceModal,\n} from '../../components/AssessmentRegenerate.html.js';\nimport { AssessmentScorePanel } from '../../components/AssessmentScorePanel.html.js';\nimport { HeadContents } from '../../components/HeadContents.html.js';\nimport { InstructorInfoPanel } from '../../components/InstructorInfoPanel.html.js';\nimport { Navbar } from '../../components/Navbar.html.js';\nimport { PersonalNotesPanel } from '../../components/PersonalNotesPanel.html.js';\nimport { QuestionContainer, QuestionTitle } from '../../components/QuestionContainer.html.js';\nimport { QuestionNavSideGroup } from '../../components/QuestionNavigation.html.js';\nimport { QuestionScorePanel } from '../../components/QuestionScore.html.js';\nimport { assetPath, compiledScriptTag, nodeModulesAssetPath } from '../../lib/assets.js';\nimport type { User } from '../../lib/db-types.js';\nimport { getRoleNamesForUser } from '../../lib/groups.js';\n\nexport function StudentInstanceQuestion({\n  resLocals,\n  userCanDeleteAssessmentInstance,\n  assignedGrader,\n  lastGrader,\n}: {\n  resLocals: Record<string, any>;\n  userCanDeleteAssessmentInstance: boolean;\n  assignedGrader?: User | null;\n  lastGrader?: User | null;\n}) {\n  const questionContext =\n    resLocals.assessment.type === 'Exam' ? 'student_exam' : 'student_homework';\n\n  return html`\n    <!doctype html>\n    <html lang=\"en\">\n      <head>\n        ${HeadContents({ resLocals })} ${compiledScriptTag('question.ts')}\n        ${resLocals.assessment.type === 'Exam'\n          ? html`\n              ${compiledScriptTag('examTimeLimitCountdown.ts')}\n              ${EncodedData(\n                {\n                  serverRemainingMS: resLocals.assessment_instance_remaining_ms,\n                  serverTimeLimitMS: resLocals.assessment_instance_time_limit_ms,\n                  serverUpdateURL: `${resLocals.urlPrefix}/assessment_instance/${resLocals.assessment_instance.id}/time_remaining`,\n                  canTriggerFinish: resLocals.authz_result.authorized_edit,\n                  showsTimeoutWarning: true,\n                  reloadOnFail: true,\n                  csrfToken: resLocals.__csrf_token,\n                },\n                'time-limit-data',\n              )}\n            `\n          : ''}\n        <script defer src=\"${nodeModulesAssetPath('mathjax/es5/startup.js')}\"></script>\n        <script>\n          document.urlPrefix = '${resLocals.urlPrefix}';\n        </script>\n        ${resLocals.variant == null\n          ? ''\n          : html`\n              ${resLocals.question.type !== 'Freeform'\n                ? html`\n                    <script src=\"${nodeModulesAssetPath('lodash/lodash.min.js')}\"></script>\n                    <script src=\"${assetPath('javascripts/require.js')}\"></script>\n                    <script src=\"${assetPath('localscripts/question.js')}\"></script>\n                    <script src=\"${assetPath(\n                        `localscripts/question${resLocals.effectiveQuestionType}.js`,\n                      )}\"></script>\n                  `\n                : ''}\n              ${unsafeHtml(resLocals.extraHeadersHtml)}\n            `}\n      </head>\n      <body>\n        ${Navbar({ resLocals })}\n        ${userCanDeleteAssessmentInstance\n          ? RegenerateInstanceModal({ csrfToken: resLocals.__csrf_token })\n          : ''}\n        <main id=\"content\" class=\"container\">\n          ${userCanDeleteAssessmentInstance ? RegenerateInstanceAlert() : ''}\n          <div class=\"row\">\n            <div class=\"col-lg-9 col-sm-12\">\n              ${resLocals.variant == null\n                ? html`\n                    <div class=\"card mb-4\">\n                      <div class=\"card-header bg-primary text-white\">\n                        <h1>\n                          ${QuestionTitle({\n                            questionContext,\n                            question: resLocals.question,\n                            questionNumber: resLocals.instance_question_info.question_number,\n                          })}\n                        </h1>\n                      </div>\n                      <div class=\"card-body\">\n                        This question was not viewed while the assessment was open, so no variant\n                        was created.\n                      </div>\n                    </div>\n                  `\n                : QuestionContainer({ resLocals, questionContext })}\n            </div>\n\n            <div class=\"col-lg-3 col-sm-12\">\n              ${resLocals.assessment.type === 'Exam'\n                ? html`\n                    <div class=\"card mb-4\">\n                      <div class=\"card-header bg-secondary\">\n                        <h2>\n                          <a\n                            class=\"text-white\"\n                            href=\"${resLocals.urlPrefix}/assessment_instance/${resLocals\n                              .assessment_instance.id}/\"\n                          >\n                            ${resLocals.assessment_set.name} ${resLocals.assessment.number}\n                          </a>\n                        </h2>\n                      </div>\n\n                      <div class=\"card-body\">\n                        <div class=\"d-flex justify-content-center\">\n                          <a\n                            class=\"btn btn-info\"\n                            href=\"${resLocals.urlPrefix}/assessment_instance/${resLocals\n                              .assessment_instance.id}/\"\n                          >\n                            Assessment overview\n                          </a>\n                        </div>\n\n                        ${resLocals.assessment_instance.open &&\n                        resLocals.assessment_instance_remaining_ms != null\n                          ? html`\n                              <div class=\"mt-3\">\n                                <div id=\"countdownProgress\"></div>\n                                <p class=\"mb-0\">\n                                  Time remaining: <span id=\"countdownDisplay\"></span>\n                                </p>\n                              </div>\n                            `\n                          : ''}\n                      </div>\n                    </div>\n                  `\n                : AssessmentScorePanel({\n                    urlPrefix: resLocals.urlPrefix,\n                    assessment: resLocals.assessment,\n                    assessment_set: resLocals.assessment_set,\n                    assessment_instance: resLocals.assessment_instance,\n                  })}\n              ${QuestionScorePanel({\n                instance_question: resLocals.instance_question,\n                assessment: resLocals.assessment,\n                assessment_question: resLocals.assessment_question,\n                question: resLocals.question,\n                assessment_instance: resLocals.assessment_instance,\n                instance_question_info: resLocals.instance_question_info,\n                variant: resLocals.variant,\n                authz_result: resLocals.authz_result,\n                csrfToken: resLocals.__csrf_token,\n                urlPrefix: resLocals.urlPrefix,\n              })}\n              ${QuestionNavSideGroup({\n                urlPrefix: resLocals.urlPrefix,\n                prevInstanceQuestionId: resLocals.instance_question_info.prev_instance_question?.id,\n                nextInstanceQuestionId: resLocals.instance_question_info.next_instance_question?.id,\n                sequenceLocked:\n                  resLocals.instance_question_info.next_instance_question?.sequence_locked,\n                prevGroupRolePermissions: resLocals.prev_instance_question_role_permissions,\n                nextGroupRolePermissions: resLocals.next_instance_question_role_permissions,\n                advanceScorePerc: resLocals.instance_question_info.advance_score_perc,\n                userGroupRoles: resLocals.group_info\n                  ? getRoleNamesForUser(resLocals.group_info, resLocals.user).join(', ')\n                  : null,\n              })}\n              ${resLocals.assessment.allow_personal_notes\n                ? PersonalNotesPanel({\n                    fileList: resLocals.file_list,\n                    context: 'question',\n                    courseInstanceId: resLocals.course_instance.id,\n                    assessment_instance: resLocals.assessment_instance,\n                    authz_result: resLocals.authz_result,\n                    variantId: resLocals.variant?.id,\n                    csrfToken: resLocals.__csrf_token,\n                  })\n                : ''}\n              ${InstructorInfoPanel({\n                course: resLocals.course,\n                course_instance: resLocals.course_instance,\n                assessment: resLocals.assessment,\n                assessment_instance: resLocals.assessment_instance,\n                instance_question: resLocals.instance_question,\n                assignedGrader,\n                lastGrader,\n                question: resLocals.question,\n                variant: resLocals.variant,\n                instance_group: resLocals.instance_group,\n                instance_group_uid_list: resLocals.instance_group_uid_list,\n                instance_user: resLocals.instance_user,\n                authz_data: resLocals.authz_data,\n                question_is_shared: resLocals.question_is_shared,\n                questionContext:\n                  resLocals.assessment.type === 'Exam' ? 'student_exam' : 'student_homework',\n                csrfToken: resLocals.__csrf_token,\n              })}\n            </div>\n          </div>\n        </main>\n      </body>\n    </html>\n  `.toString();\n}\n"]}