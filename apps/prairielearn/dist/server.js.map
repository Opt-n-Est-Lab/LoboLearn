{"version":3,"file":"server.js","sourceRoot":"","sources":["../src/server.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable import-x/order */\n// IMPORTANT: this must come first so that it can properly instrument our\n// dependencies like `pg` and `express`.\nimport * as opentelemetry from '@prairielearn/opentelemetry';\nimport * as Sentry from '@prairielearn/sentry';\n/* eslint-enable import-x/order */\n\nimport * as fs from 'node:fs';\nimport * as http from 'node:http';\nimport * as https from 'node:https';\nimport * as path from 'node:path';\nimport * as util from 'node:util';\nimport * as url from 'url';\n\nimport blocked from 'blocked';\nimport blockedAt from 'blocked-at';\nimport bodyParser from 'body-parser';\nimport cookieParser from 'cookie-parser';\nimport esMain from 'es-main';\nimport express, {\n  type Express,\n  type NextFunction,\n  type Request,\n  type RequestHandler,\n  type Response,\n} from 'express';\nimport asyncHandler from 'express-async-handler';\nimport multer from 'multer';\nimport onFinished from 'on-finished';\nimport passport from 'passport';\nimport favicon from 'serve-favicon';\nimport { v4 as uuidv4 } from 'uuid';\nimport yargsParser from 'yargs-parser';\n\nimport { cache } from '@prairielearn/cache';\nimport { flashMiddleware } from '@prairielearn/flash';\nimport { addFileLogging, logger } from '@prairielearn/logger';\nimport * as migrations from '@prairielearn/migrations';\nimport {\n  SCHEMA_MIGRATIONS_PATH,\n  initBatchedMigrations,\n  startBatchedMigrations,\n  stopBatchedMigrations,\n} from '@prairielearn/migrations';\nimport * as namedLocks from '@prairielearn/named-locks';\nimport * as nodeMetrics from '@prairielearn/node-metrics';\nimport * as sqldb from '@prairielearn/postgres';\nimport { createSessionMiddleware } from '@prairielearn/session';\n\nimport * as cron from './cron/index.js';\nimport { validateLti13CourseInstance } from './ee/lib/lti13.js';\nimport * as assets from './lib/assets.js';\nimport { makeAwsClientConfig } from './lib/aws.js';\nimport { canonicalLoggerMiddleware } from './lib/canonical-logger.js';\nimport * as codeCaller from './lib/code-caller/index.js';\nimport { config, loadConfig, setLocalsFromConfig } from './lib/config.js';\nimport { pullAndUpdateCourse } from './lib/course.js';\nimport * as externalGrader from './lib/externalGrader.js';\nimport * as externalGraderResults from './lib/externalGraderResults.js';\nimport * as externalGradingSocket from './lib/externalGradingSocket.js';\nimport { features } from './lib/features/index.js';\nimport { featuresMiddleware } from './lib/features/middleware.js';\nimport { isEnterprise } from './lib/license.js';\nimport * as lifecycleHooks from './lib/lifecycle-hooks.js';\nimport * as load from './lib/load.js';\nimport { APP_ROOT_PATH, REPOSITORY_ROOT_PATH } from './lib/paths.js';\nimport * as serverJobs from './lib/server-jobs.js';\nimport { PostgresSessionStore } from './lib/session-store.js';\nimport * as socketServer from './lib/socket-server.js';\nimport { SocketActivityMetrics } from './lib/telemetry/socket-activity-metrics.js';\nimport { getSearchParams } from './lib/url.js';\nimport * as workspace from './lib/workspace.js';\nimport { markAllWorkspaceHostsUnhealthy } from './lib/workspaceHost.js';\nimport { enterpriseOnly } from './middlewares/enterpriseOnly.js';\nimport staticNodeModules from './middlewares/staticNodeModules.js';\nimport { makeWorkspaceProxyMiddleware } from './middlewares/workspaceProxy.js';\nimport * as news_items from './news_items/index.js';\nimport * as freeformServer from './question-servers/freeform.js';\nimport * as sprocs from './sprocs/index.js';\nprocess.on('warning', (e) => console.warn(e));\n\nconst argv = yargsParser(process.argv.slice(2));\n\nif ('h' in argv || 'help' in argv) {\n  const msg = `PrairieLearn command line options:\n    -h, --help                          Display this help and exit\n    --config <filename>\n    <filename> and no other args        Load an alternative config filename\n    --migrate-and-exit                  Run the DB initialization parts and exit\n    --refresh-workspace-hosts-and-exit  Refresh the workspace hosts and exit\n    --sync-course <course_id>           Synchronize a course and exit\n`;\n\n  console.log(msg);\n  process.exit(0);\n}\n\nfunction excludeRoutes(routes: string[], handler: RequestHandler) {\n  return (req: Request, res: Response, next: NextFunction) => {\n    if (routes.some((route) => req.path.startsWith(route))) {\n      next();\n    } else {\n      handler(req, res, next);\n    }\n  };\n}\n\n/**\n * Creates the express application and sets up all PrairieLearn routes.\n * @return The express \"app\" object that was created.\n */\nexport async function initExpress(): Promise<Express> {\n  const app = express();\n  app.set('views', path.join(import.meta.dirname, 'pages'));\n  app.set('trust proxy', config.trustProxy);\n\n  // These should come first so that we get instrumentation on all our requests.\n  if (config.sentryDsn) {\n    app.use(Sentry.requestHandler());\n\n    app.use((await import('./lib/sentry.js')).enrichSentryEventMiddleware);\n  }\n\n  // This should come before the session middleware so that we don't\n  // create a session every time we get a health check request.\n  app.get('/pl/webhooks/ping', function (req, res) {\n    res.send('.');\n  });\n\n  // Set res.locals variables first, so they will be available on\n  // all pages including the error page (which we could jump to at\n  // any point.\n  app.use((req, res, next) => {\n    setLocalsFromConfig(res.locals);\n    next();\n  });\n\n  const sessionMiddleware = createSessionMiddleware({\n    secret: config.secretKey,\n    store: new PostgresSessionStore(),\n    cookie: {\n      name: 'pl2_session',\n      writeNames: ['prairielearn_session', 'pl2_session'],\n      // Ensure that the legacy session cookie doesn't have a domain specified.\n      // We can only safely set domains on the new session cookie.\n      writeOverrides: [{ domain: undefined }, { domain: config.cookieDomain ?? undefined }],\n      httpOnly: true,\n      maxAge: config.sessionStoreExpireSeconds * 1000,\n      secure: 'auto', // uses Express \"trust proxy\" setting\n      sameSite: config.sessionCookieSameSite,\n    },\n  });\n\n  const sessionRouter = express.Router();\n  sessionRouter.use(sessionMiddleware);\n  sessionRouter.use(flashMiddleware());\n  sessionRouter.use((req, res, next) => {\n    // This middleware helps ensure that sessions remain alive (un-expired) as\n    // long as users are somewhat frequently active. See the documentation for\n    // `config.sessionStoreAutoExtendThrottleSeconds` for more information.\n    //\n    // Compute the number of milliseconds until the session expires.\n    const sessionTtl = req.session.getExpirationDate().getTime() - Date.now();\n\n    if (\n      sessionTtl <\n      (config.sessionStoreExpireSeconds - config.sessionStoreAutoExtendThrottleSeconds) * 1000\n    ) {\n      req.session.setExpiration(config.sessionStoreExpireSeconds * 1000);\n    }\n\n    next();\n  });\n\n  // API routes don't utilize sessions; don't run the session/flash middleware for them.\n  app.use(excludeRoutes(['/pl/api'], sessionRouter));\n\n  // special parsing of file upload paths -- this is inelegant having it\n  // separate from the route handlers but it seems to be necessary\n  // Special handling of file-upload routes so that we can parse multipart/form-data\n  const upload = multer({\n    storage: multer.memoryStorage(),\n    limits: {\n      fieldSize: config.fileUploadMaxBytes,\n      fileSize: config.fileUploadMaxBytes,\n      parts: config.fileUploadMaxParts,\n    },\n  });\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/uploads',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment_instance/:assessment_instance_id(\\\\d+)',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)',\n    upload.single('file'),\n  );\n  app.post('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)', upload.single('file'));\n  app.post(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file_view',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file_view/*',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/settings',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/settings',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/settings',\n    upload.single('file'),\n  );\n  app.post('/pl/course/:course_id(\\\\d+)/course_admin/settings', upload.single('file'));\n  app.post('/pl/course/:course_id(\\\\d+)/course_admin/file_view', upload.single('file'));\n  app.post('/pl/course/:course_id(\\\\d+)/course_admin/file_view/*', upload.single('file'));\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/file_view',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/file_view/*',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/file_view',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/file_view/*',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/file_view',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/file_view/*',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/file_view',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/file_view/*',\n    upload.single('file'),\n  );\n  app.post(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/groups',\n    upload.single('file'),\n  );\n\n  // Collect metrics on workspace proxy sockets. Note that this only tracks\n  // outgoing sockets (those going to workspaces). Incoming sockets are tracked\n  // globally for the entire server.\n  const meter = opentelemetry.metrics.getMeter('prairielearn');\n  const workspaceProxySocketActivityMetrics = new SocketActivityMetrics(meter, 'workspace-proxy');\n  workspaceProxySocketActivityMetrics.start();\n\n  const workspaceAuthRouter = express.Router();\n  workspaceAuthRouter.use([\n    // We use a short-lived cookie to cache a successful\n    // authn/authz for a specific workspace. We run the following\n    // middlewares in this separate sub-router so that we can\n    // short-circuit out of authzWorkspaceCookieCheck if we find\n    // the workspace-authz cookie. Short-circuiting will exit this\n    // sub-router immediately, so we can either exit this\n    // sub-router by finding the cookie, or by running regular\n    // authn/authz.\n\n    (await import('./middlewares/authzWorkspaceCookieCheck.js')).default, // short-circuits if we have the workspace-authz cookie\n    (await import('./middlewares/date.js')).default,\n    (await import('./middlewares/authn.js')).default, // jumps to error handler if authn fails\n    (await import('./middlewares/authzWorkspace.js')).default, // jumps to error handler if authz fails\n    (await import('./middlewares/authzWorkspaceCookieSet.js')).default, // sets the workspace-authz cookie\n  ]);\n  app.use('/pl/workspace/:workspace_id(\\\\d+)/container', [\n    cookieParser(),\n    (req: Request, res: Response, next: NextFunction) => {\n      // Needed for workspaceAuthRouter.\n      res.locals.workspace_id = req.params.workspace_id;\n      next();\n    },\n    workspaceAuthRouter,\n    (req: Request, res: Response, next: NextFunction) => {\n      workspaceProxySocketActivityMetrics.addSocket(req.socket);\n      next();\n    },\n    makeWorkspaceProxyMiddleware(),\n  ]);\n\n  app.use((req, res, next) => {\n    // Stripe webhook signature verification requires the raw body, so we avoid\n    // using the body parser for that route.\n    if (req.path === '/pl/webhooks/stripe') return next();\n\n    // Limit to 5MB of JSON\n    bodyParser.json({ limit: 5 * 1024 * 1024 })(req, res, next);\n  });\n  app.use(bodyParser.urlencoded({ extended: false, limit: 5 * 1536 * 1024 }));\n  app.use(cookieParser());\n  app.use(passport.initialize());\n  if (config.devMode) app.use(favicon(path.join(APP_ROOT_PATH, 'public', 'favicon-dev.ico')));\n  else app.use(favicon(path.join(APP_ROOT_PATH, 'public', 'favicon.ico')));\n\n  assets.applyMiddleware(app);\n\n  // This route is kept around for legacy reasons - new code should prefer the\n  // assets system with cacheable assets.\n  app.use(express.static(path.join(APP_ROOT_PATH, 'public')));\n\n  // For backwards compatibility, we redirect requests for the old `node_modules`\n  // route to the new `cacheable_node_modules` route.\n  app.use('/node_modules', (req, res) => {\n    // Strip the leading slash.\n    const assetPath = req.url.slice(1);\n    res.redirect(assets.nodeModulesAssetPath(assetPath));\n  });\n\n  // Support legacy use of ace by v2 questions\n  app.use(\n    '/localscripts/calculationQuestion/ace',\n    staticNodeModules(path.join('ace-builds', 'src-min-noconflict')),\n  );\n  app.use('/javascripts/ace', staticNodeModules(path.join('ace-builds', 'src-min-noconflict')));\n\n  // Middleware for all requests\n  // response_id is logged on request, response, and error to link them together\n  app.use(function (req, res, next) {\n    res.locals.response_id = uuidv4();\n    res.set('X-Response-ID', res.locals.response_id);\n    next();\n  });\n\n  // load accounting for requests\n  app.use(function (req, res, next) {\n    load.startJob('request', res.locals.response_id);\n    next();\n  });\n  app.use(function (req, res, next) {\n    onFinished(res, function (err, res) {\n      if (err) {\n        logger.verbose('request on-response-finished error', {\n          err,\n          response_id: res.locals.response_id,\n        });\n      }\n      load.endJob('request', res.locals.response_id);\n    });\n    next();\n  });\n\n  // This makes a `CanonicalLogger` instance available throughout this request\n  // via AsyncLocalStorage.\n  app.use(canonicalLoggerMiddleware());\n\n  // More middlewares\n  app.use((await import('./middlewares/logResponse.js')).default); // defers to end of response\n  app.use((await import('./middlewares/cors.js')).default);\n  app.use((await import('./middlewares/content-security-policy.js')).default);\n  app.use((await import('./middlewares/date.js')).default);\n  app.use((await import('./middlewares/effectiveRequestChanged.js')).default);\n\n  app.use('/pl/oauth2login', (await import('./pages/authLoginOAuth2/authLoginOAuth2.js')).default);\n  app.use(\n    '/pl/oauth2callback',\n    (await import('./pages/authCallbackOAuth2/authCallbackOAuth2.js')).default,\n  );\n  app.use(\n    /\\/pl\\/shibcallback/,\n    (await import('./pages/authCallbackShib/authCallbackShib.js')).default,\n  );\n\n  if (isEnterprise()) {\n    if (config.hasAzure) {\n      app.use('/pl/azure_login', (await import('./ee/auth/azure/login.js')).default);\n      app.use('/pl/azure_callback', (await import('./ee/auth/azure/callback.js')).default);\n    }\n\n    app.use('/pl/lti13_instance', (await import('./ee/routers/lti13.js')).default);\n    app.use(\n      '/pl/auth/institution/:institution_id(\\\\d+)/saml',\n      (await import('./ee/auth/saml/router.js')).default,\n    );\n  }\n\n  app.use('/pl/lti', (await import('./pages/authCallbackLti/authCallbackLti.js')).default);\n  app.use('/pl/login', (await import('./pages/authLogin/authLogin.js')).default);\n  if (config.devMode) {\n    app.use('/pl/dev_login', (await import('./pages/authLoginDev/authLoginDev.js')).default);\n  }\n  app.use('/pl/logout', [\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.navPage = 'logout';\n      next();\n    },\n    (await import('./pages/authLogout/authLogout.js')).default,\n  ]);\n  app.use((await import('./middlewares/authn.js')).default); // authentication, set res.locals.authn_user\n  app.use('/pl/api/v1', (await import('./middlewares/authnToken.js')).default); // authn for the API, set res.locals.authn_user\n\n  // Must come after the authentication middleware, as we need to read the\n  // `authn_is_administrator` property from the response locals.\n  //\n  // This means that feature flag overrides will not be available for\n  // unauthenticated routes.\n  app.use(featuresMiddleware((req, res) => res.locals.authn_is_administrator));\n\n  if (isEnterprise()) {\n    app.use('/pl/prairietest/auth', (await import('./ee/auth/prairietest.js')).default);\n  }\n\n  // Must come before CSRF middleware; we do our own signature verification here.\n  app.use('/pl/webhooks/terminate', (await import('./webhooks/terminate.js')).default);\n  app.use(\n    '/pl/webhooks/stripe',\n    await enterpriseOnly(async () => (await import('./ee/webhooks/stripe/index.js')).default),\n  );\n\n  // Set and check `res.locals.__csrf_token`. We exclude API routes as those\n  // don't require CSRF protection (and in fact can't have it at all).\n  app.use(excludeRoutes(['/pl/api'], (await import('./middlewares/csrfToken.js')).default));\n\n  app.use((await import('./middlewares/logRequest.js')).default);\n\n  // load accounting for authenticated accesses\n  app.use(function (req, res, next) {\n    load.startJob('authed_request', res.locals.response_id);\n    next();\n  });\n  app.use(function (req, res, next) {\n    onFinished(res, function (err, res) {\n      if (err) {\n        logger.verbose('authed_request on-response-finished error', {\n          err,\n          response_id: res.locals.response_id,\n        });\n      }\n      load.endJob('authed_request', res.locals.response_id);\n    });\n    next();\n  });\n\n  // clear cookies on the homepage to reset any stale session state\n  app.use(/^(\\/?)$|^(\\/pl\\/?)$/, (await import('./middlewares/clearCookies.js')).default);\n\n  // some pages don't need authorization\n  app.use('/', (await import('./pages/home/home.js')).default);\n  app.use('/pl', (await import('./pages/home/home.js')).default);\n  app.use('/pl/settings', (await import('./pages/userSettings/userSettings.js')).default);\n  app.use('/pl/enroll', (await import('./pages/enroll/enroll.js')).default);\n  app.use('/pl/password', (await import('./pages/authPassword/authPassword.js')).default);\n  app.use('/pl/news_items', (await import('./pages/newsItems/newsItems.js')).default);\n  app.use('/pl/news_item', (await import('./pages/newsItem/newsItem.js')).default);\n  app.use('/pl/request_course', [\n    // Users can post data to this page and then view it, so we'll block access to prevent\n    // students from using to infiltrate or exfiltrate exam information.\n    (await import('./middlewares/forbidAccessInExamMode.js')).default,\n    (await import('./pages/instructorRequestCourse/instructorRequestCourse.js')).default,\n  ]);\n\n  if (isEnterprise()) {\n    app.use('/pl/terms', (await import('./ee/pages/terms/terms.js')).default);\n  }\n\n  // We deliberately omit the `authzCourseOrInstance` middleware here. The\n  // route handler will only ever display courses for which the user has staff\n  // access; the course ID in the URL is only used to determine which course\n  // is the currently selected one.\n  app.use(\n    '/pl/navbar/course/:course_id(\\\\d+)/switcher',\n    (await import('./pages/navbarCourseSwitcher/navbarCourseSwitcher.js')).default,\n  );\n  app.use(\n    '/pl/navbar/course/:course_id(\\\\d+)/course_instance_switcher/:course_instance_id(\\\\d+)?',\n    [\n      (await import('./middlewares/authzCourseOrInstance.js')).default,\n      (await import('./pages/navbarCourseInstanceSwitcher/navbarCourseInstanceSwitcher.js'))\n        .default,\n    ],\n  );\n\n  // Handles updates to the side nav expanded state.\n  app.use(\n    '/pl/side_nav/settings',\n    (await import('./pages/sideNavSettings/sideNavSettings.js')).default,\n  );\n\n  app.use('/pl/workspace/:workspace_id(\\\\d+)', [\n    (req: Request, res: Response, next: NextFunction) => {\n      res.locals.workspace_id = req.params.workspace_id;\n      next();\n    },\n    (await import('./middlewares/authzWorkspace.js')).default,\n  ]);\n  app.use(\n    '/pl/workspace/:workspace_id(\\\\d+)',\n    (await import('./pages/workspace/workspace.js')).default,\n  );\n  app.use(\n    '/pl/workspace/:workspace_id(\\\\d+)/logs',\n    (await import('./pages/workspaceLogs/workspaceLogs.js')).default,\n  );\n\n  // dev-mode pages are mounted for both out-of-course access (here) and within-course access (see below)\n  if (config.devMode) {\n    app.use(\n      '/pl/loadFromDisk',\n      (await import('./pages/instructorLoadFromDisk/instructorLoadFromDisk.js')).default,\n    );\n    app.use('/pl/jobSequence', (await import('./pages/jobSequence/jobSequence.js')).default);\n  }\n\n  // Redirect plain course instance page either to student or instructor assessments page\n  app.use(/^(\\/pl\\/course_instance\\/[0-9]+)\\/?$/, (req, res, _next) => {\n    res.redirect(`${req.params[0]}/assessments`);\n  });\n  app.use(/^(\\/pl\\/course_instance\\/[0-9]+\\/instructor)\\/?$/, (req, res, _next) => {\n    res.redirect(`${req.params[0]}/instance_admin/assessments`);\n  });\n\n  // is the course instance being accessed through the student or instructor page route\n  app.use('/pl/course_instance/:course_instance_id(\\\\d+)', function (req, res, next) {\n    res.locals.viewType = 'student';\n    next();\n  });\n  app.use('/pl/course_instance/:course_instance_id(\\\\d+)/instructor', function (req, res, next) {\n    res.locals.viewType = 'instructor';\n    next();\n  });\n\n  // sets res.locals.course and res.locals.course_instance\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)',\n    (await import('./middlewares/authzCourseOrInstance.js')).default,\n  );\n\n  // This must come after `authzCourseOrInstance` but before the `checkPlanGrants`\n  // or `autoEnroll` middlewares so that we can render it even when the student\n  // isn't enrolled in the course instance or doesn't have the necessary plan grants.\n  if (isEnterprise()) {\n    // This must come before `authzHasCourseInstanceAccess` and the upgrade page\n    // below so that we can render it even when the student isn't enrolled in the\n    // course instance.\n    app.use('/pl/course_instance/:course_instance_id(\\\\d+)/upgrade', [\n      (await import('./ee/pages/studentCourseInstanceUpgrade/studentCourseInstanceUpgrade.js'))\n        .default,\n    ]);\n  }\n\n  // all pages under /pl/course_instance require authorization\n  app.use('/pl/course_instance/:course_instance_id(\\\\d+)', [\n    await enterpriseOnly(async () => (await import('./ee/middlewares/checkPlanGrants.js')).default),\n    (await import('./middlewares/autoEnroll.js')).default,\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.urlPrefix = '/pl/course_instance/' + req.params.course_instance_id;\n      next();\n    },\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.navbarType = 'student';\n      next();\n    },\n  ]);\n\n  // Some course instance student pages only require course instance authorization (already checked)\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/news_items',\n    (await import('./pages/newsItems/newsItems.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/news_item',\n    (await import('./pages/newsItem/newsItem.js')).default,\n  );\n\n  // Some course instance student pages only require the authn user to have permissions\n  app.use('/pl/course_instance/:course_instance_id(\\\\d+)/effectiveUser', [\n    (await import('./middlewares/authzAuthnHasCoursePreviewOrInstanceView.js')).default,\n    (await import('./pages/instructorEffectiveUser/instructorEffectiveUser.js')).default,\n  ]);\n\n  // All course instance instructor pages require the authn user to have permissions\n  app.use('/pl/course_instance/:course_instance_id(\\\\d+)/instructor', [\n    (await import('./middlewares/forbidAccessInExamMode.js')).default,\n    (await import('./middlewares/authzAuthnHasCoursePreviewOrInstanceView.js')).default,\n    (await import('./middlewares/selectOpenIssueCount.js')).default,\n    (await import('./middlewares/selectGettingStartedTasksCounts.js')).default,\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.navbarType = 'instructor';\n      next();\n    },\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.urlPrefix = '/pl/course_instance/' + req.params.course_instance_id + '/instructor';\n      next();\n    },\n  ]);\n\n  // Some course instance instructor pages only require the authn user to have permissions (already checked)\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/effectiveUser',\n    (await import('./pages/instructorEffectiveUser/instructorEffectiveUser.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/news_items',\n    (await import('./pages/newsItems/newsItems.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/news_item',\n    (await import('./pages/newsItem/newsItem.js')).default,\n  );\n\n  // All other course instance student pages require the effective user to have permissions\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)',\n    (await import('./middlewares/authzHasCourseInstanceAccess.js')).default,\n  );\n\n  // All other course instance instructor pages require the effective user to have permissions\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor',\n    (await import('./middlewares/authzHasCoursePreviewOrInstanceView.js')).default,\n  );\n\n  // all pages under /pl/course require authorization\n  app.use('/pl/course/:course_id(\\\\d+)', [\n    (await import('./middlewares/forbidAccessInExamMode.js')).default,\n    (await import('./middlewares/authzCourseOrInstance.js')).default, // set res.locals.course\n    (await import('./middlewares/selectOpenIssueCount.js')).default,\n    (await import('./middlewares/selectGettingStartedTasksCounts.js')).default,\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.navbarType = 'instructor';\n      next();\n    },\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.urlPrefix = '/pl/course/' + req.params.course_id;\n      next();\n    },\n  ]);\n\n  // Serve element statics. As with core PrairieLearn assets and files served\n  // from `node_modules`, we include a cachebuster in the URL. This allows\n  // files to be treated as immutable in production and cached aggressively.\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/sharedElements/course/:producing_course_id(\\\\d+)/cacheableElements/:cachebuster',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/sharedElements/course/:producing_course_id(\\\\d+)/cacheableElements/:cachebuster',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/sharedElements/course/:producing_course_id(\\\\d+)/cacheableElements/:cachebuster',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/cacheableElements/:cachebuster',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/cacheableElements/:cachebuster',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/cacheableElements/:cachebuster',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/cacheableElementExtensions/:cachebuster',\n    (await import('./pages/elementExtensionFiles/elementExtensionFiles.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/cacheableElementExtensions/:cachebuster',\n    (await import('./pages/elementExtensionFiles/elementExtensionFiles.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/cacheableElementExtensions/:cachebuster',\n    (await import('./pages/elementExtensionFiles/elementExtensionFiles.js')).default,\n  );\n\n  // For backwards compatibility, we continue to serve the non-cached element\n  // files.\n  // TODO: if we can determine that these routes are no longer receiving\n  // traffic in the future, we can delete these.\n  //\n  // TODO: the only internal usage of this is in the `pl-drawing` element. Fix that.\n  app.use(\n    '/pl/static/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default({\n      publicQuestionEndpoint: false,\n      coreElements: true,\n    }),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/sharedElements/course/:producing_course_id(\\\\d+)/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/sharedElements/course/:producing_course_id(\\\\d+)/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/sharedElements/course/:producing_course_id(\\\\d+)/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default(),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/elementExtensions',\n    (await import('./pages/elementExtensionFiles/elementExtensionFiles.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/elementExtensions',\n    (await import('./pages/elementExtensionFiles/elementExtensionFiles.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/elementExtensions',\n    (await import('./pages/elementExtensionFiles/elementExtensionFiles.js')).default,\n  );\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // API ///////////////////////////////////////////////////////////////\n\n  app.use('/pl/api/trpc', (await import('./api/trpc/index.js')).default);\n  app.use('/pl/api/v1', (await import('./api/v1/index.js')).default);\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // Instructor pages //////////////////////////////////////////////////\n\n  // single assessment\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)',\n    [\n      (await import('./middlewares/selectAndAuthzAssessment.js')).default,\n      (await import('./middlewares/selectAssessments.js')).default,\n    ],\n  );\n  app.use(\n    /^(\\/pl\\/course_instance\\/[0-9]+\\/instructor\\/assessment\\/[0-9]+)\\/?$/,\n    (req, res, _next) => {\n      res.redirect(`${req.params[0]}/questions`);\n    },\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)',\n    function (req, res, next) {\n      res.locals.navPage = 'assessment';\n      next();\n    },\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/settings',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'settings';\n        next();\n      },\n      (await import('./pages/instructorAssessmentSettings/instructorAssessmentSettings.js'))\n        .default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/questions',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'questions';\n        next();\n      },\n      (await import('./pages/instructorAssessmentQuestions/instructorAssessmentQuestions.js'))\n        .default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/groups',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'groups';\n        next();\n      },\n      (await import('./pages/instructorAssessmentGroups/instructorAssessmentGroups.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/access',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'access';\n        next();\n      },\n      (await import('./pages/instructorAssessmentAccess/instructorAssessmentAccess.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/assessment_statistics',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'assessment_statistics';\n        next();\n      },\n      (await import('./pages/instructorAssessmentStatistics/instructorAssessmentStatistics.js'))\n        .default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/question_statistics',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'question_statistics';\n        next();\n      },\n      (\n        await import(\n          './pages/instructorAssessmentQuestionStatistics/instructorAssessmentQuestionStatistics.js'\n        )\n      ).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/downloads',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'downloads';\n        next();\n      },\n      (await import('./pages/instructorAssessmentDownloads/instructorAssessmentDownloads.js'))\n        .default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/uploads',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'uploads';\n        next();\n      },\n      (await import('./pages/instructorAssessmentUploads/instructorAssessmentUploads.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/regrading',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'regrading';\n        next();\n      },\n      (await import('./pages/instructorAssessmentRegrading/instructorAssessmentRegrading.js'))\n        .default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/instances',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'instances';\n        next();\n      },\n      (await import('./pages/instructorAssessmentInstances/instructorAssessmentInstances.js'))\n        .default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/file_edit',\n    (await import('./pages/instructorFileEditor/instructorFileEditor.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/file_view',\n    (await import('./pages/instructorFileBrowser/instructorFileBrowser.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/file_download',\n    (await import('./pages/instructorFileDownload/instructorFileDownload.js')).default,\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/manual_grading/assessment_question/:assessment_question_id(\\\\d+)',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'manual_grading';\n        next();\n      },\n      (await import('./middlewares/selectAndAuthzAssessmentQuestion.js')).default,\n      (\n        await import(\n          './pages/instructorAssessmentManualGrading/assessmentQuestion/assessmentQuestion.js'\n        )\n      ).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/manual_grading/assessment_question/:assessment_question_id(\\\\d+)/ai_grading_runs',\n    (await import('./ee/pages/instructorAiGradingRuns/instructorAiGradingRuns.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/manual_grading/instance_question/:instance_question_id(\\\\d+)',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'manual_grading';\n        next();\n      },\n      (await import('./middlewares/selectAndAuthzInstanceQuestion.js')).default,\n      (\n        await import(\n          './pages/instructorAssessmentManualGrading/instanceQuestion/instanceQuestion.js'\n        )\n      ).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_question/:instance_question_id(\\\\d+)/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_question/:instance_question_id(\\\\d+)/clientFilesQuestion',\n    [\n      (await import('./middlewares/selectAndAuthzInstanceQuestion.js')).default,\n      (await import('./pages/clientFilesQuestion/clientFilesQuestion.js')).default(),\n    ],\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_question/:instance_question_id(\\\\d+)/generatedFilesQuestion',\n    [\n      (await import('./middlewares/selectAndAuthzInstanceQuestion.js')).default,\n      (await import('./pages/generatedFilesQuestion/generatedFilesQuestion.js')).default(),\n    ],\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_question/:instance_question_id(\\\\d+)/file',\n    [\n      (await import('./middlewares/selectAndAuthzInstanceQuestion.js')).default,\n      (await import('./pages/legacyQuestionFile/legacyQuestionFile.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_question/:instance_question_id(\\\\d+)/text',\n    [\n      (await import('./middlewares/selectAndAuthzInstanceQuestion.js')).default,\n      (await import('./pages/legacyQuestionText/legacyQuestionText.js')).default,\n    ],\n  );\n\n  // Submission files\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_question/:instance_question_id(\\\\d+)/submission/:unsafe_submission_id(\\\\d+)/file',\n    [\n      (await import('./middlewares/selectAndAuthzInstanceQuestion.js')).default,\n      (await import('./pages/submissionFile/submissionFile.js')).default(),\n    ],\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/manual_grading',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'manual_grading';\n        next();\n      },\n      (await import('./pages/instructorAssessmentManualGrading/assessment/assessment.js')).default,\n    ],\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment_instance/:assessment_instance_id(\\\\d+)',\n    [\n      (await import('./middlewares/selectAndAuthzAssessmentInstance.js')).default,\n      (await import('./middlewares/selectAssessments.js')).default,\n      (await import('./pages/instructorAssessmentInstance/instructorAssessmentInstance.js'))\n        .default,\n    ],\n  );\n\n  // single question\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)',\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n    (await import('./middlewares/authzHasCoursePreview.js')).default,\n  );\n  app.use(\n    /^(\\/pl\\/course_instance\\/[0-9]+\\/instructor\\/question\\/[0-9]+)\\/?$/,\n    (req, res, _next) => {\n      // Redirect legacy question URLs to their preview page.\n      // We need to maintain query parameters like `variant_id` so that the\n      // preview page can render the correct variant.\n      res.redirect(\n        url.format({\n          pathname: `${req.params[0]}/preview`,\n          search: getSearchParams(req).toString(),\n        }),\n      );\n    },\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)',\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.navPage = 'question';\n      next();\n    },\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/settings',\n    (await import('./pages/instructorQuestionSettings/instructorQuestionSettings.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/preview',\n    (await import('./pages/instructorQuestionPreview/instructorQuestionPreview.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/statistics',\n    [\n      function (req: Request, res: Response, next: NextFunction) {\n        res.locals.navSubPage = 'statistics';\n        next();\n      },\n      (await import('./pages/instructorQuestionStatistics/instructorQuestionStatistics.js'))\n        .default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/file_edit',\n    (await import('./pages/instructorFileEditor/instructorFileEditor.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/file_view',\n    (await import('./pages/instructorFileBrowser/instructorFileBrowser.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/file_download',\n    (await import('./pages/instructorFileDownload/instructorFileDownload.js')).default,\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/grading_job',\n    (await import('./pages/instructorGradingJob/instructorGradingJob.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/jobSequence',\n    (await import('./pages/jobSequence/jobSequence.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/loadFromDisk',\n    (await import('./pages/instructorLoadFromDisk/instructorLoadFromDisk.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/edit_error',\n    (await import('./pages/editError/editError.js')).default,\n  );\n\n  // course instance - course admin pages\n  app.use(/^(\\/pl\\/course_instance\\/[0-9]+\\/instructor\\/course_admin)\\/?$/, (req, res, _next) => {\n    res.redirect(`${req.params[0]}/instances`);\n  });\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin',\n    function (req, res, next) {\n      res.locals.navPage = 'course_admin';\n      next();\n    },\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/settings',\n    (await import('./pages/instructorCourseAdminSettings/instructorCourseAdminSettings.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/sharing',\n    (await import('./pages/instructorCourseAdminSharing/instructorCourseAdminSharing.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/staff',\n    (await import('./pages/instructorCourseAdminStaff/instructorCourseAdminStaff.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/sets',\n    (await import('./pages/instructorCourseAdminSets/instructorCourseAdminSets.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/modules',\n    (await import('./pages/instructorCourseAdminModules/instructorCourseAdminModules.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/instances',\n    (await import('./pages/instructorCourseAdminInstances/instructorCourseAdminInstances.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/issues',\n    (await import('./pages/instructorIssues/instructorIssues.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/questions',\n    (await import('./pages/instructorQuestions/instructorQuestions.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/getting_started',\n    (\n      await import(\n        './pages/instructorCourseAdminGettingStarted/instructorCourseAdminGettingStarted.js'\n      )\n    ).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/ai_generate_editor/:question_id(\\\\d+)',\n    (await import('./ee/pages/instructorAiGenerateDraftEditor/instructorAiGenerateDraftEditor.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/ai_generate_question_drafts',\n    (await import('./ee/pages/instructorAiGenerateDrafts/instructorAiGenerateDrafts.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/syncs',\n    (await import('./pages/courseSyncs/courseSyncs.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/topics',\n    (await import('./pages/instructorCourseAdminTopics/instructorCourseAdminTopics.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/tags',\n    (await import('./pages/instructorCourseAdminTags/instructorCourseAdminTags.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/file_edit',\n    (await import('./pages/instructorFileEditor/instructorFileEditor.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/file_view',\n    (await import('./pages/instructorFileBrowser/instructorFileBrowser.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/course_admin/file_download',\n    (await import('./pages/instructorFileDownload/instructorFileDownload.js')).default,\n  );\n\n  // course instance - instance admin pages\n  app.use(/^(\\/pl\\/course_instance\\/[0-9]+\\/instructor\\/instance_admin)\\/?$/, (req, res, _next) => {\n    res.redirect(`${req.params[0]}/assessments`);\n  });\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin',\n    function (req, res, next) {\n      res.locals.navPage = 'instance_admin';\n      next();\n    },\n    asyncHandler(async (req, res, next) => {\n      // The navigation tabs rely on these values to know when to show/hide themselves\n      // so we need to load it for all instance admin pages.\n      const hasCourseInstanceBilling = await features.enabledFromLocals(\n        'course-instance-billing',\n        res.locals,\n      );\n      res.locals.billing_enabled = hasCourseInstanceBilling && isEnterprise();\n\n      const hasLti13CourseInstance = await validateLti13CourseInstance(res.locals);\n      res.locals.lti13_enabled = hasLti13CourseInstance && isEnterprise();\n      next();\n    }),\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/settings',\n    (await import('./pages/instructorInstanceAdminSettings/instructorInstanceAdminSettings.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/access',\n    (await import('./pages/instructorInstanceAdminAccess/instructorInstanceAdminAccess.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/assessments',\n    (await import('./pages/instructorAssessments/instructorAssessments.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/gradebook',\n    (await import('./pages/instructorGradebook/instructorGradebook.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/lti',\n    (await import('./pages/instructorInstanceAdminLti/instructorInstanceAdminLti.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/file_edit',\n    (await import('./pages/instructorFileEditor/instructorFileEditor.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/file_view',\n    (await import('./pages/instructorFileBrowser/instructorFileBrowser.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/file_download',\n    (await import('./pages/instructorFileDownload/instructorFileDownload.js')).default,\n  );\n  if (isEnterprise()) {\n    app.use(\n      '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/instance_admin/billing',\n      (await import('./ee/pages/instructorInstanceAdminBilling/instructorInstanceAdminBilling.js'))\n        .default,\n    );\n    app.use(\n      '/pl/course_instance/:course_instance_id/instructor/instance_admin/lti13_instance',\n      (await import('./ee/pages/instructorInstanceAdminLti13/instructorInstanceAdminLti13.js'))\n        .default,\n    );\n  }\n\n  // Global client files\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/clientFilesCourseInstance',\n    (await import('./pages/clientFilesCourseInstance/clientFilesCourseInstance.js')).default,\n  );\n\n  // Client files for assessments\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/clientFilesCourseInstance',\n    (await import('./pages/clientFilesCourseInstance/clientFilesCourseInstance.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/assessment/:assessment_id(\\\\d+)/clientFilesAssessment',\n    [\n      (await import('./middlewares/selectAndAuthzAssessment.js')).default,\n      (await import('./pages/clientFilesAssessment/clientFilesAssessment.js')).default,\n    ],\n  );\n\n  // Client files for questions\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/clientFilesQuestion',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/clientFilesQuestion/clientFilesQuestion.js')).default(),\n    ],\n  );\n\n  // generatedFiles\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/generatedFilesQuestion',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/generatedFilesQuestion/generatedFilesQuestion.js')).default(),\n    ],\n  );\n\n  // Submission files\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/submission/:unsafe_submission_id(\\\\d+)/file',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/submissionFile/submissionFile.js')).default(),\n    ],\n  );\n\n  // legacy client file paths\n  // handle routes with and without /preview/ in them to handle URLs with and without trailing slashes\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/file',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/legacyQuestionFile/legacyQuestionFile.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/preview/file',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/legacyQuestionFile/legacyQuestionFile.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/text',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/legacyQuestionText/legacyQuestionText.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instructor/question/:question_id(\\\\d+)/preview/text',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/legacyQuestionText/legacyQuestionText.js')).default,\n    ],\n  );\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // Student pages /////////////////////////////////////////////////////\n\n  app.use('/pl/course_instance/:course_instance_id(\\\\d+)/gradebook', [\n    (await import('./pages/studentGradebook/studentGradebook.js')).default,\n  ]);\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessments',\n    (await import('./pages/studentAssessments/studentAssessments.js')).default,\n  );\n\n  // Client files for assessments - These routes must come before the\n  // assessment route (.../assessment/:assessment_id) to avoid hitting the\n  // middleware on that route first. The middleware on that route will redirect\n  // to the student assessment instance if an instance exists and will prevent\n  // reaching the client file route.\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment/:assessment_id(\\\\d+)/clientFilesCourse',\n    [\n      (await import('./middlewares/selectAndAuthzAssessment.js')).default,\n      (await import('./middlewares/studentAssessmentAccess.js')).default,\n      (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment/:assessment_id(\\\\d+)/clientFilesCourseInstance',\n    [\n      (await import('./middlewares/selectAndAuthzAssessment.js')).default,\n      (await import('./middlewares/studentAssessmentAccess.js')).default,\n      (await import('./pages/clientFilesCourseInstance/clientFilesCourseInstance.js')).default,\n    ],\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment/:assessment_id(\\\\d+)/clientFilesAssessment',\n    [\n      (await import('./middlewares/selectAndAuthzAssessment.js')).default,\n      (await import('./middlewares/studentAssessmentAccess.js')).default,\n      (await import('./pages/clientFilesAssessment/clientFilesAssessment.js')).default,\n    ],\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment/:assessment_id(\\\\d+)',\n    (await import('./pages/studentAssessment/studentAssessment.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment_instance/:assessment_instance_id(\\\\d+)/file',\n    (await import('./pages/studentAssessmentInstanceFile/studentAssessmentInstanceFile.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment_instance/:assessment_instance_id(\\\\d+)/time_remaining',\n    (\n      await import(\n        './pages/studentAssessmentInstanceTimeRemaining/studentAssessmentInstanceTimeRemaining.js'\n      )\n    ).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/assessment_instance/:assessment_instance_id(\\\\d+)',\n    (await import('./pages/studentAssessmentInstance/studentAssessmentInstance.js')).default,\n  );\n\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)',\n    (await import('./pages/studentInstanceQuestion/studentInstanceQuestion.js')).default,\n  );\n  if (config.devMode) {\n    app.use(\n      '/pl/course_instance/:course_instance_id(\\\\d+)/loadFromDisk',\n      (await import('./pages/instructorLoadFromDisk/instructorLoadFromDisk.js')).default,\n    );\n    app.use(\n      '/pl/course_instance/:course_instance_id(\\\\d+)/jobSequence',\n      (await import('./pages/jobSequence/jobSequence.js')).default,\n    );\n  }\n\n  // Global client files\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/clientFilesCourseInstance',\n    (await import('./pages/clientFilesCourseInstance/clientFilesCourseInstance.js')).default,\n  );\n\n  // Client files for questions\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)/clientFilesQuestion',\n    (await import('./pages/clientFilesQuestion/clientFilesQuestion.js')).default(),\n  );\n\n  // generatedFiles\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)/generatedFilesQuestion',\n    (await import('./pages/generatedFilesQuestion/generatedFilesQuestion.js')).default(),\n  );\n\n  // Submission files\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)/submission/:unsafe_submission_id(\\\\d+)/file',\n    (await import('./pages/submissionFile/submissionFile.js')).default(),\n  );\n\n  // legacy client file paths\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)/file',\n    (await import('./pages/legacyQuestionFile/legacyQuestionFile.js')).default,\n  );\n  app.use(\n    '/pl/course_instance/:course_instance_id(\\\\d+)/instance_question/:instance_question_id(\\\\d+)/text',\n    (await import('./pages/legacyQuestionText/legacyQuestionText.js')).default,\n  );\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // Course pages //////////////////////////////////////////////////////\n\n  app.use(/^\\/pl\\/course\\/[0-9]+\\/?$/, function (req, res, _next) {\n    res.redirect(res.locals.urlPrefix + '/course_admin');\n  }); // redirect plain course URL to overview page\n\n  // Some course pages only require the authn user to have permission (already checked)\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/effectiveUser',\n    (await import('./pages/instructorEffectiveUser/instructorEffectiveUser.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/news_items',\n    (await import('./pages/newsItems/newsItems.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/news_item',\n    (await import('./pages/newsItem/newsItem.js')).default,\n  );\n\n  // All other course pages require the effective user to have permission\n  app.use(\n    '/pl/course/:course_id(\\\\d+)',\n    (await import('./middlewares/authzHasCoursePreview.js')).default,\n  );\n\n  // single question\n\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)',\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n  );\n  app.use(/^(\\/pl\\/course\\/[0-9]+\\/question\\/[0-9]+)\\/?$/, (req, res, _next) => {\n    // Redirect legacy question URLs to their preview page.\n    // We need to maintain query parameters like `variant_id` so that the\n    // preview page can render the correct variant.\n    res.redirect(\n      url.format({\n        pathname: `${req.params[0]}/preview`,\n        search: getSearchParams(req).toString(),\n      }),\n    );\n  });\n  app.use('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)', function (req, res, next) {\n    res.locals.navPage = 'question';\n    next();\n  });\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/settings',\n    (await import('./pages/instructorQuestionSettings/instructorQuestionSettings.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/preview',\n    (await import('./pages/instructorQuestionPreview/instructorQuestionPreview.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/statistics',\n    (await import('./pages/instructorQuestionStatistics/instructorQuestionStatistics.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file_edit',\n    (await import('./pages/instructorFileEditor/instructorFileEditor.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file_view',\n    (await import('./pages/instructorFileBrowser/instructorFileBrowser.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file_download',\n    (await import('./pages/instructorFileDownload/instructorFileDownload.js')).default,\n  );\n\n  app.use('/pl/course/:course_id(\\\\d+)/file_transfer', [\n    (await import('./pages/instructorFileTransfer/instructorFileTransfer.js')).default,\n  ]);\n\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/edit_error',\n    (await import('./pages/editError/editError.js')).default,\n  );\n\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin',\n    (await import('./pages/instructorCourseAdmin/instructorCourseAdmin.js')).default,\n  );\n  app.use('/pl/course/:course_id(\\\\d+)/course_admin', function (req, res, next) {\n    res.locals.navPage = 'course_admin';\n    next();\n  });\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/settings',\n    (await import('./pages/instructorCourseAdminSettings/instructorCourseAdminSettings.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/sharing',\n    (await import('./pages/instructorCourseAdminSharing/instructorCourseAdminSharing.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/staff',\n    (await import('./pages/instructorCourseAdminStaff/instructorCourseAdminStaff.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/sets',\n    (await import('./pages/instructorCourseAdminSets/instructorCourseAdminSets.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/modules',\n    (await import('./pages/instructorCourseAdminModules/instructorCourseAdminModules.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/instances',\n    (await import('./pages/instructorCourseAdminInstances/instructorCourseAdminInstances.js'))\n      .default,\n  );\n  app.use('/pl/course/:course_id(\\\\d+)/course_admin/getting_started', [\n    (\n      await import(\n        './pages/instructorCourseAdminGettingStarted/instructorCourseAdminGettingStarted.js'\n      )\n    ).default,\n  ]);\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/issues',\n    (await import('./pages/instructorIssues/instructorIssues.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/questions',\n    (await import('./pages/instructorQuestions/instructorQuestions.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/ai_generate_editor/:question_id(\\\\d+)',\n    (await import('./ee/pages/instructorAiGenerateDraftEditor/instructorAiGenerateDraftEditor.js'))\n      .default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/ai_generate_question_drafts',\n    (await import('./ee/pages/instructorAiGenerateDrafts/instructorAiGenerateDrafts.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/syncs',\n    (await import('./pages/courseSyncs/courseSyncs.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/topics',\n    (await import('./pages/instructorCourseAdminTopics/instructorCourseAdminTopics.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/tags',\n    (await import('./pages/instructorCourseAdminTags/instructorCourseAdminTags.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/file_edit',\n    (await import('./pages/instructorFileEditor/instructorFileEditor.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/file_view',\n    (await import('./pages/instructorFileBrowser/instructorFileBrowser.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/course_admin/file_download',\n    (await import('./pages/instructorFileDownload/instructorFileDownload.js')).default,\n  );\n\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/loadFromDisk',\n    (await import('./pages/instructorLoadFromDisk/instructorLoadFromDisk.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/jobSequence',\n    (await import('./pages/jobSequence/jobSequence.js')).default,\n  );\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/grading_job',\n    (await import('./pages/instructorGradingJob/instructorGradingJob.js')).default,\n  );\n\n  // This route is used to initiate a copy of a question with publicly shared source\n  // or a question from a template course.\n  // It is not actually a page; it's just used to initiate the transfer. The reason\n  // that this is a route on the target course and not handled by the source question\n  // pages is that the source question pages are served by chunk servers, but the\n  // question transfer machinery relies on access to course repositories on disk,\n  // which don't exist on chunk servers\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/copy_public_question',\n    (await import('./pages/instructorCopyPublicQuestion/instructorCopyPublicQuestion.js')).default,\n  );\n\n  // Global client files\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n\n  // Client files for questions\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/clientFilesCourse',\n    (await import('./pages/clientFilesCourse/clientFilesCourse.js')).default,\n  );\n  app.use('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/clientFilesQuestion', [\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n    (await import('./pages/clientFilesQuestion/clientFilesQuestion.js')).default(),\n  ]);\n\n  // generatedFiles\n  app.use('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/generatedFilesQuestion', [\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n    (await import('./pages/generatedFilesQuestion/generatedFilesQuestion.js')).default(),\n  ]);\n\n  // Submission files\n  app.use(\n    '/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/submission/:unsafe_submission_id(\\\\d+)/file',\n    [\n      (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n      (await import('./pages/submissionFile/submissionFile.js')).default(),\n    ],\n  );\n\n  // legacy client file paths\n  // handle routes with and without /preview/ in them to handle URLs with and without trailing slashes\n  app.use('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file', [\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n    (await import('./pages/legacyQuestionFile/legacyQuestionFile.js')).default,\n  ]);\n  app.use('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/preview/file', [\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n    (await import('./pages/legacyQuestionFile/legacyQuestionFile.js')).default,\n  ]);\n  app.use('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/text', [\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n    (await import('./pages/legacyQuestionText/legacyQuestionText.js')).default,\n  ]);\n  app.use('/pl/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/preview/text', [\n    (await import('./middlewares/selectAndAuthzInstructorQuestion.js')).default,\n    (await import('./pages/legacyQuestionText/legacyQuestionText.js')).default,\n  ]);\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // Public course pages ///////////////////////////////////////////////\n\n  // Prevent access to public pages when in exam mode.\n  app.use('/pl/public', (await import('./middlewares/forbidAccessInExamMode.js')).default);\n\n  app.use('/pl/public/course/:course_id(\\\\d+)', [\n    function (req: Request, res: Response, next: NextFunction) {\n      res.locals.navbarType = 'public';\n      res.locals.urlPrefix = '/pl/public/course/' + req.params.course_id;\n      next();\n    },\n  ]);\n  app.use('/pl/public/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file_view', [\n    function (req, res, next) {\n      res.locals.navPage = 'public_question';\n      next();\n    },\n    (await import('./pages/publicQuestionFileBrowser/publicQuestionFileBrowser.js')).default,\n  ]);\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/file_download',\n    (await import('./pages/publicQuestionFileDownload/publicQuestionFileDownload.js')).default,\n  );\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/preview',\n    (await import('./pages/publicQuestionPreview/publicQuestionPreview.js')).default,\n  );\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/questions',\n    (await import('./pages/publicQuestions/publicQuestions.js')).default,\n  );\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/cacheableElements/:cachebuster',\n    (await import('./pages/elementFiles/elementFiles.js')).default({\n      publicQuestionEndpoint: true,\n      coreElements: false,\n    }),\n  );\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/elements',\n    (await import('./pages/elementFiles/elementFiles.js')).default({\n      publicQuestionEndpoint: true,\n      coreElements: false,\n    }),\n  );\n  app.use(/^(\\/pl\\/public\\/course_instance\\/[0-9]+\\/assessment\\/[0-9]+)\\/?$/, (req, res, _next) => {\n    res.redirect(`${req.params[0]}/questions`);\n  });\n  app.use(\n    '/pl/public/course_instance/:course_instance_id(\\\\d+)/assessment/:assessment_id(\\\\d+)/questions',\n    (await import('./pages/publicAssessmentQuestions/publicAssessmentQuestions.js')).default,\n  );\n\n  // Client files for questions\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/clientFilesQuestion',\n    (await import('./pages/clientFilesQuestion/clientFilesQuestion.js')).default({\n      publicEndpoint: true,\n    }),\n  );\n\n  // generatedFiles\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/generatedFilesQuestion',\n    (await import('./pages/generatedFilesQuestion/generatedFilesQuestion.js')).default({\n      publicEndpoint: true,\n    }),\n  );\n\n  // Submission files\n  app.use(\n    '/pl/public/course/:course_id(\\\\d+)/question/:question_id(\\\\d+)/submission/:unsafe_submission_id(\\\\d+)/file',\n    [(await import('./pages/submissionFile/submissionFile.js')).default({ publicEndpoint: true })],\n  );\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // Institution administrator pages ///////////////////////////////////\n  if (isEnterprise()) {\n    app.use(\n      '/pl/institution/:institution_id(\\\\d+)/admin',\n      (await import('./ee/routers/institutionAdmin.js')).default,\n    );\n  }\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // Administrator pages ///////////////////////////////////////////////\n\n  app.use('/pl/administrator', (await import('./middlewares/authzIsAdministrator.js')).default);\n\n  app.use(\n    '/pl/administrator',\n    asyncHandler(async (req, res, next) => {\n      const hasEnhancedNavigation = await features.enabled('enhanced-navigation', {\n        user_id: res.locals.authn_user.user_id,\n      });\n      res.locals.has_enhanced_navigation = hasEnhancedNavigation;\n      next();\n    }),\n  );\n\n  app.use(\n    '/pl/administrator/admins',\n    (await import('./pages/administratorAdmins/administratorAdmins.js')).default,\n  );\n  app.use(\n    '/pl/administrator/settings',\n    (await import('./pages/administratorSettings/administratorSettings.js')).default,\n  );\n  app.use(\n    '/pl/administrator/institutions',\n    (await import('./pages/administratorInstitutions/administratorInstitutions.js')).default,\n  );\n  app.use(\n    '/pl/administrator/courses',\n    (await import('./pages/administratorCourses/administratorCourses.js')).default,\n  );\n  app.use(\n    '/pl/administrator/networks',\n    (await import('./pages/administratorNetworks/administratorNetworks.js')).default,\n  );\n  app.use(\n    '/pl/administrator/workspaces',\n    (await import('./pages/administratorWorkspaces/administratorWorkspaces.js')).default,\n  );\n  app.use(\n    '/pl/administrator/features',\n    (await import('./pages/administratorFeatures/administratorFeatures.js')).default,\n  );\n  app.use(\n    '/pl/administrator/queries',\n    (await import('./pages/administratorQueries/administratorQueries.js')).default,\n  );\n  app.use(\n    '/pl/administrator/query',\n    (await import('./pages/administratorQuery/administratorQuery.js')).default,\n  );\n  app.use(\n    '/pl/administrator/jobSequence',\n    (await import('./pages/jobSequence/jobSequence.js')).default,\n  );\n  app.use(\n    '/pl/administrator/courseRequests',\n    (await import('./pages/administratorCourseRequests/administratorCourseRequests.js')).default,\n  );\n  app.use(\n    '/pl/administrator/batchedMigrations',\n    (await import('./pages/administratorBatchedMigrations/administratorBatchedMigrations.js'))\n      .default,\n  );\n\n  if (isEnterprise()) {\n    app.use(\n      '/pl/administrator/institution/:institution_id(\\\\d+)',\n      (await import('./ee/routers/administratorInstitution.js')).default,\n    );\n  }\n\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////\n  // Error handling ////////////////////////////////////////////////////\n\n  // if no earlier routes matched, this will match and generate a 404 error\n  app.use((await import('./middlewares/notFound.js')).default);\n\n  app.use((await import('./middlewares/redirectEffectiveAccessDenied.js')).default);\n\n  // This is not a true error handler; it just implements support for\n  // \"throwing\" redirects.\n  app.use((await import('./lib/redirect.js')).thrownRedirectMiddleware);\n\n  /**\n   * Attempts to extract a numeric status code from a Postgres error object.\n   * The convention we use is to use a `ERRCODE` value of `ST###`, where ###\n   * is the three-digit HTTP status code.\n   *\n   * For example, the following exception would set a 404 status code:\n   *\n   * RAISE EXCEPTION 'Entity not found' USING ERRCODE = 'ST404';\n   *\n   * @returns The extracted HTTP status code\n   */\n  function maybeGetStatusCodeFromSqlError(err: any): number | null {\n    const rawCode = err?.data?.sqlError?.code;\n    if (!rawCode?.startsWith('ST')) return null;\n\n    const parsedCode = Number(rawCode.toString().substring(2));\n    if (Number.isNaN(parsedCode)) return null;\n\n    return parsedCode;\n  }\n\n  // This should come first so that both Sentry and our own error page can\n  // read the error ID and any status code.\n  app.use((err: any, req: Request, res: Response, next: NextFunction) => {\n    const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');\n\n    res.locals.error_id = Array.from({ length: 12 })\n      .map(() => chars[Math.floor(Math.random() * chars.length)])\n      .join('');\n\n    err.status = err.status ?? maybeGetStatusCodeFromSqlError(err) ?? 500;\n\n    next(err);\n  });\n\n  // The Sentry error handler must come before our own.\n  app.use(Sentry.expressErrorHandler());\n\n  app.use((await import('./pages/error/error.js')).default);\n\n  return app;\n}\n\n//////////////////////////////////////////////////////////////////////\n//////////////////////////////////////////////////////////////////////\n//////////////////////////////////////////////////////////////////////\n// Server startup ////////////////////////////////////////////////////\n\nlet server: http.Server | https.Server;\n\nexport async function startServer() {\n  const app = await initExpress();\n\n  if (config.serverType === 'https') {\n    const options: https.ServerOptions = {};\n    if (config.sslKeyFile) {\n      options.key = await fs.promises.readFile(config.sslKeyFile);\n    }\n    if (config.sslCertificateFile) {\n      options.cert = await fs.promises.readFile(config.sslCertificateFile);\n    }\n    if (config.sslCAFile) {\n      options.ca = [await fs.promises.readFile(config.sslCAFile)];\n    }\n    server = https.createServer(options, app);\n    logger.verbose('server listening to HTTPS on port ' + config.serverPort);\n  } else if (config.serverType === 'http') {\n    server = http.createServer(app);\n    logger.verbose('server listening to HTTP on port ' + config.serverPort);\n  } else {\n    throw new Error('unknown serverType: ' + config.serverType);\n  }\n\n  // Capture metrics about the server, including the number of active connections\n  // and the total number of connections that have been started.\n  const meter = opentelemetry.metrics.getMeter('prairielearn');\n\n  const connectionCounter = opentelemetry.getCounter(meter, 'http.connections', {\n    valueType: opentelemetry.ValueType.INT,\n  });\n  server.on('connection', () => connectionCounter.add(1));\n\n  // Hack to get us running in Bun, which doesn't currently support `getConnections`:\n  // https://github.com/oven-sh/bun/issues/4459\n  if (server.getConnections) {\n    opentelemetry.createObservableValueGauges(\n      meter,\n      'http.connections.active',\n      {\n        valueType: opentelemetry.ValueType.INT,\n        interval: 1000,\n      },\n      () => {\n        return util.promisify(server.getConnections.bind(server))();\n      },\n    );\n  }\n\n  const serverSocketActivity = new SocketActivityMetrics(meter, 'http');\n  server.on('connection', (socket) => serverSocketActivity.addSocket(socket));\n  serverSocketActivity.start();\n\n  server.timeout = config.serverTimeout;\n  server.keepAliveTimeout = config.serverKeepAliveTimeout;\n  server.listen(config.serverPort);\n\n  // Wait for the server to either start successfully or error out.\n  await new Promise((resolve, reject) => {\n    let done = false;\n\n    server.on('error', (err) => {\n      if (!done) {\n        done = true;\n        reject(err);\n      }\n    });\n\n    server.on('listening', () => {\n      if (!done) {\n        done = true;\n        resolve(null);\n      }\n    });\n  });\n\n  return server;\n}\n\nexport async function stopServer() {\n  if (!server) throw new Error('cannot stop an undefined server');\n  if (!server.listening) return;\n\n  // This exists mostly for tests, where we might have dangling connections\n  // from `fetch()` requests whose bodies we never read. `server.close()` won't\n  // actually stop the server until all connections are closed, so we need to\n  // manually close said connections.\n  //\n  // In production environments, PrairieLearn should always be deployed behind\n  // a load balancer that will drain and close any open connections before\n  // PrairieLearn is stopped.\n  server.closeAllConnections();\n\n  await util.promisify(server.close.bind(server))();\n}\n\nexport async function insertDevUser() {\n  // add dev user as Administrator\n  const sql =\n    'INSERT INTO users (uid, name)' +\n    \" VALUES ('dev@example.com', 'Dev User')\" +\n    ' ON CONFLICT (uid) DO UPDATE' +\n    ' SET name = EXCLUDED.name' +\n    ' RETURNING user_id;';\n  const result = await sqldb.queryOneRowAsync(sql, []);\n  const user_id = result.rows[0].user_id;\n  const adminSql =\n    'INSERT INTO administrators (user_id)' +\n    ' VALUES ($user_id)' +\n    ' ON CONFLICT (user_id) DO NOTHING;';\n  await sqldb.queryAsync(adminSql, { user_id });\n}\n\nfunction idleErrorHandler(err: Error) {\n  logger.error('idle client error', err);\n  Sentry.captureException(err, {\n    level: 'fatal',\n    tags: {\n      // This may have been set by `@prairielearn/postgres`. We include this in the\n      // Sentry tags to more easily debug idle client errors.\n      last_query: (err as any)?.data?.lastQuery ?? undefined,\n    },\n  });\n  Sentry.close().finally(() => process.exit(1));\n}\n\nif (esMain(import.meta) && config.startServer) {\n  try {\n    logger.verbose('PrairieLearn server start');\n\n    // For backwards compatibility, we'll default to trying to load config\n    // files from both the application and repository root.\n    //\n    // We'll put the app config file second so that it can override anything\n    // in the repository root config file.\n    let configPaths = [\n      path.join(REPOSITORY_ROOT_PATH, 'config.json'),\n      path.join(APP_ROOT_PATH, 'config.json'),\n    ];\n\n    // If a config file was specified on the command line, we'll use that\n    // instead of the default locations.\n    if ('config' in argv) {\n      configPaths = [argv['config']];\n    }\n\n    // Load config immediately so we can use it configure everything else.\n    await loadConfig(configPaths);\n\n    // This should be done as soon as we load our config so that we can\n    // start exporting spans.\n    await opentelemetry.init({\n      ...config,\n      serviceName: 'prairielearn',\n      // For Sentry to work correctly, it needs to hook into our OpenTelemetry setup.\n      // https://docs.sentry.io/platforms/javascript/guides/node/tracing/instrumentation/opentelemetry/\n      //\n      // However, despite what their documentation claims, only the `SentryContextManager`\n      // is necessary if one isn't using Sentry for tracing. In fact, if `SentrySpanProcessor`\n      // is used, 100% of traces will be sent to Sentry, despite us never having set\n      // `tracesSampleRate` in the Sentry configuration.\n      contextManager: config.sentryDsn ? new Sentry.SentryContextManager() : undefined,\n    });\n\n    // Same with Sentry configuration.\n    if (config.sentryDsn) {\n      await Sentry.init({\n        dsn: config.sentryDsn,\n        environment: config.sentryEnvironment,\n\n        // We have our own OpenTelemetry setup, so ensure Sentry doesn't\n        // try to set that up for itself, but only if OpenTelemetry is\n        // enabled. Otherwise, allow Sentry to install its own stuff so\n        // that request isolation works correctly.\n        skipOpenTelemetrySetup: config.openTelemetryEnabled,\n      });\n    }\n\n    // Start capturing profiling information as soon as possible.\n    if (config.pyroscopeEnabled) {\n      if (\n        !config.pyroscopeServerAddress ||\n        !config.pyroscopeBasicAuthUser ||\n        !config.pyroscopeBasicAuthPassword\n      ) {\n        throw new Error('Pyroscope configuration is incomplete');\n      }\n\n      const Pyroscope = await import('@pyroscope/nodejs');\n      Pyroscope.init({\n        appName: 'prairielearn',\n        serverAddress: config.pyroscopeServerAddress,\n        basicAuthUser: config.pyroscopeBasicAuthUser,\n        basicAuthPassword: config.pyroscopeBasicAuthPassword,\n        tags: {\n          instanceId: config.instanceId,\n          ...config.pyroscopeTags,\n        },\n      });\n      Pyroscope.start();\n    }\n\n    if (config.logFilename) {\n      addFileLogging({ filename: config.logFilename });\n    }\n\n    if (config.logErrorFilename) {\n      addFileLogging({ filename: config.logErrorFilename, level: 'error' });\n    }\n\n    if (config.blockedAtWarnEnable) {\n      blockedAt(\n        (time, stack) => {\n          const msg = `BLOCKED-AT: Blocked for ${time}ms`;\n          logger.verbose(msg, { time, stack });\n          console.log(msg + '\\n' + stack.join('\\n'));\n        },\n        { threshold: config.blockedWarnThresholdMS },\n      ); // threshold in milliseconds\n    } else if (config.blockedWarnEnable) {\n      blocked(\n        (time) => {\n          const msg = `BLOCKED: Blocked for ${time}ms (set config.blockedAtWarnEnable for stack trace)`;\n          logger.verbose(msg, { time });\n          console.log(msg);\n        },\n        { threshold: config.blockedWarnThresholdMS },\n      ); // threshold in milliseconds\n    }\n\n    if (isEnterprise() && config.hasAzure) {\n      const { getAzureStrategy } = await import('./ee/auth/azure/index.js');\n      passport.use(getAzureStrategy());\n    }\n\n    if (isEnterprise()) {\n      const { strategy } = await import('./ee/auth/saml/index.js');\n      passport.use(strategy);\n    }\n\n    const pgConfig = {\n      user: config.postgresqlUser,\n      database: config.postgresqlDatabase,\n      host: config.postgresqlHost,\n      password: config.postgresqlPassword ?? undefined,\n      max: config.postgresqlPoolSize,\n      idleTimeoutMillis: config.postgresqlIdleTimeoutMillis,\n      ssl: config.postgresqlSsl,\n      errorOnUnusedParameters: config.devMode,\n    };\n\n    logger.verbose(`Connecting to ${pgConfig.user}@${pgConfig.host}:${pgConfig.database}`);\n\n    await sqldb.initAsync(pgConfig, idleErrorHandler);\n\n    // Our named locks code maintains a separate pool of database connections.\n    // This ensures that we avoid deadlocks.\n    await namedLocks.init(pgConfig, idleErrorHandler, {\n      renewIntervalMs: config.namedLocksRenewIntervalMs,\n    });\n\n    logger.verbose('Successfully connected to database');\n\n    if (argv['refresh-workspace-hosts-and-exit']) {\n      logger.info('option --refresh-workspace-hosts specified, refreshing workspace hosts');\n\n      const hosts = await markAllWorkspaceHostsUnhealthy('refresh-workspace-hosts-and-exit');\n\n      const pluralHosts = hosts.length === 1 ? 'host' : 'hosts';\n      logger.info(`${hosts.length} ${pluralHosts} marked unhealthy`);\n      hosts.forEach((host) => logger.info(`- ${host.instance_id} (${host.hostname})`));\n\n      process.exit(0);\n    }\n\n    // We need to do this before we run migrations, as some migrations will\n    // call `enqueueBatchedMigration` which requires this to be initialized.\n    const runner = initBatchedMigrations({\n      project: 'prairielearn',\n      directories: [path.join(import.meta.dirname, 'batched-migrations')],\n    });\n\n    runner.on('error', (err) => {\n      logger.error('Batched migration runner error', err);\n      Sentry.captureException(err);\n    });\n\n    // Using the `--migrate-and-exit` flag will override the value of\n    // `config.runMigrations`. This allows us to use the same config when\n    // running migrations as we do when we start the server.\n    if (config.runMigrations || argv['migrate-and-exit']) {\n      await migrations.init(\n        [path.join(import.meta.dirname, 'migrations'), SCHEMA_MIGRATIONS_PATH],\n        'prairielearn',\n      );\n\n      if (argv['migrate-and-exit']) {\n        logger.info('option --migrate-and-exit passed, running DB setup and exiting');\n        process.exit(0);\n      }\n    }\n\n    // Collect metrics on our Postgres connection pools.\n    const meter = opentelemetry.metrics.getMeter('prairielearn');\n\n    const pools = [\n      {\n        name: 'default',\n        pool: sqldb.defaultPool,\n      },\n      {\n        name: 'named-locks',\n        pool: namedLocks.pool,\n      },\n    ];\n\n    pools.forEach(({ name, pool }) => {\n      opentelemetry.createObservableValueGauges(\n        meter,\n        `postgres.pool.${name}.total`,\n        { valueType: opentelemetry.ValueType.INT, interval: 1000 },\n        () => pool.totalCount,\n      );\n\n      opentelemetry.createObservableValueGauges(\n        meter,\n        `postgres.pool.${name}.idle`,\n        { valueType: opentelemetry.ValueType.INT, interval: 1000 },\n        () => pool.idleCount,\n      );\n\n      opentelemetry.createObservableValueGauges(\n        meter,\n        `postgres.pool.${name}.waiting`,\n        { valueType: opentelemetry.ValueType.INT, interval: 1000 },\n        () => pool.waitingCount,\n      );\n\n      const queryCounter = opentelemetry.getObservableCounter(\n        meter,\n        `postgres.pool.${name}.query.count`,\n        { valueType: opentelemetry.ValueType.INT },\n      );\n      queryCounter.addCallback((observableResult) => {\n        observableResult.observe(pool.queryCount);\n      });\n    });\n\n    // Collect metrics on our code callers.\n    opentelemetry.createObservableValueGauges(\n      meter,\n      'code-caller.pool.size',\n      { valueType: opentelemetry.ValueType.INT, interval: 1000 },\n      () => codeCaller.getMetrics().size,\n    );\n    opentelemetry.createObservableValueGauges(\n      meter,\n      'code-caller.pool.available',\n      { valueType: opentelemetry.ValueType.INT, interval: 1000 },\n      () => codeCaller.getMetrics().available,\n    );\n    opentelemetry.createObservableValueGauges(\n      meter,\n      'code-caller.pool.borrowed',\n      { valueType: opentelemetry.ValueType.INT, interval: 1000 },\n      () => codeCaller.getMetrics().borrowed,\n    );\n    opentelemetry.createObservableValueGauges(\n      meter,\n      'code-caller.pool.pending',\n      { valueType: opentelemetry.ValueType.INT, interval: 1000 },\n      () => codeCaller.getMetrics().pending,\n    );\n\n    // We create and activate a random DB schema name\n    // (https://www.postgresql.org/docs/current/ddl-schemas.html)\n    // after we have run the migrations but before we create\n    // the sprocs. This means all tables (from migrations) are\n    // in the public schema, but all sprocs are in the random\n    // schema. Every server invocation thus has its own copy\n    // of its sprocs, allowing us to update servers while old\n    // servers are still running. See docs/dev-guide.md for\n    // more info.\n    //\n    // We use the combination of instance ID and port number to uniquely\n    // identify each server; in some cases, we're running multiple instances\n    // on the same physical host.\n    //\n    // The schema prefix should not exceed 28 characters; this is due to\n    // the underlying Postgres limit of 63 characters for schema names.\n    // Currently, EC2 instance IDs are 19 characters long, and we use\n    // 4-digit port numbers, so this will be safe (19+1+4=24). If either\n    // of those ever get longer, we have a little wiggle room. Nonetheless,\n    // we'll check to make sure we don't exceed the limit and fail fast if\n    // we do.\n    const schemaPrefix = `${config.instanceId}:${config.serverPort}`;\n    if (schemaPrefix.length > 28) {\n      throw new Error(`Schema prefix is too long: ${schemaPrefix}`);\n    }\n    await sqldb.setRandomSearchSchemaAsync(schemaPrefix);\n    await sprocs.init();\n\n    if (config.runBatchedMigrations) {\n      // Now that all migrations have been run, we can start executing any\n      // batched migrations that may have been enqueued by migrations.\n      //\n      // Note that we don't do this until sprocs have been created because\n      // some batched migrations may depend on sprocs.\n      startBatchedMigrations({\n        workDurationMs: config.batchedMigrationsWorkDurationMs,\n        sleepDurationMs: config.batchedMigrationsSleepDurationMs,\n      });\n    }\n\n    if ('sync-course' in argv) {\n      logger.info(`option --sync-course passed, syncing course ${argv['sync-course']}...`);\n      const { jobSequenceId, jobPromise } = await pullAndUpdateCourse({\n        courseId: argv['sync-course'],\n        authnUserId: null,\n        userId: null,\n      });\n      logger.info(`Course sync job sequence ${jobSequenceId} created.`);\n      logger.info('Waiting for job to finish...');\n      await jobPromise;\n      (await serverJobs.selectJobsByJobSequenceId(jobSequenceId)).forEach((job) => {\n        logger.info(`Job ${job.id} finished with status '${job.status}'.\\n${job.output}`);\n      });\n      process.exit(0);\n    }\n\n    if (config.initNewsItems) {\n      // We initialize news items asynchronously so that servers can boot up\n      // in production as quickly as possible.\n      news_items.initInBackground({\n        // Always notify in production environments.\n        notifyIfPreviouslyEmpty: !config.devMode,\n      });\n    }\n\n    // We need to initialize these first, as the code callers require these\n    // to be set up.\n    load.initEstimator('request', 1);\n    load.initEstimator('authed_request', 1);\n    load.initEstimator('python', 1, false);\n    load.initEstimator('python_worker_active', 1);\n    load.initEstimator('python_worker_idle', 1, false);\n    load.initEstimator('python_callback_waiting', 1);\n\n    await codeCaller.init();\n    await assets.init();\n    await cache.init({\n      type: config.cacheType,\n      keyPrefix: config.cacheKeyPrefix,\n      redisUrl: config.redisUrl,\n    });\n    await freeformServer.init();\n\n    if (config.devMode) {\n      await insertDevUser();\n    }\n\n    logger.verbose('Starting server...');\n    const server = await startServer();\n\n    await socketServer.init(server);\n\n    externalGradingSocket.init();\n    externalGrader.init();\n\n    await workspace.init();\n    serverJobs.init();\n\n    if (config.runningInEc2 && config.nodeMetricsIntervalSec) {\n      nodeMetrics.start({\n        awsConfig: makeAwsClientConfig(),\n        intervalSeconds: config.nodeMetricsIntervalSec,\n        dimensions: [\n          { Name: 'Server Group', Value: config.groupName },\n          { Name: 'InstanceId', Value: `${config.instanceId}:${config.serverPort}` },\n        ],\n        onError(err) {\n          logger.error('Error reporting Node metrics', err);\n          Sentry.captureException(err);\n        },\n      });\n    }\n\n    // These should be the last things to start before we actually start taking\n    // requests, as they may actually end up executing course code.\n    if (config.externalGradingEnableResults) {\n      await externalGraderResults.init();\n    }\n\n    await cron.init();\n    await lifecycleHooks.completeInstanceLaunch();\n  } catch (err) {\n    logger.error('Error initializing PrairieLearn server:', err);\n    throw err;\n  }\n  logger.info('PrairieLearn server ready, press Control-C to quit');\n  if (config.devMode) {\n    logger.info('Go to ' + config.serverType + '://localhost:' + config.serverPort);\n  }\n\n  // SIGTERM can be used to gracefully shut down the process. This signal\n  // may come from another process, but we also send it to ourselves if\n  // we want to gracefully shut down. This is used below in the ASG\n  // lifecycle handler, and also within the \"terminate\" webhook.\n  process.once('SIGTERM', async () => {\n    // By this point, we should no longer be attached to the load balancer,\n    // so there's no point shutting down the HTTP server or the socket.io\n    // server.\n    //\n    // We use `allSettled()` here to ensure that all tasks can gracefully\n    // shut down, even if some of them fail.\n    logger.info('Shutting down async processing');\n    const results = await Promise.allSettled([\n      externalGraderResults.stop(),\n      cron.stop(),\n      serverJobs.stop(),\n      stopBatchedMigrations(),\n    ]);\n    results.forEach((r) => {\n      if (r.status === 'rejected') {\n        logger.error('Error shutting down async processing', r.reason);\n        Sentry.captureException(r.reason);\n      }\n    });\n\n    try {\n      await lifecycleHooks.completeInstanceTermination();\n    } catch (err) {\n      logger.error('Error completing instance termination', err);\n      Sentry.captureException(err);\n    }\n\n    logger.info('Terminating...');\n    // Shut down OpenTelemetry exporting.\n    try {\n      await opentelemetry.shutdown();\n    } catch (err) {\n      logger.error('Error shutting down OpenTelemetry', err);\n      Sentry.captureException(err);\n    }\n\n    // Flush all events to Sentry.\n    try {\n      await Sentry.flush();\n    } finally {\n      process.exit(0);\n    }\n  });\n}\n"]}