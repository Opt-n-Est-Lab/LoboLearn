{"version":3,"file":"bootstrap4-construct-plugin.js","sourceRoot":"","sources":["../../../src/tests/accessibility/bootstrap4-construct-plugin.ts"],"names":[],"mappings":"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","sourcesContent":["import { type DOMReadyEvent, Rule, type RuleDocumentation, definePlugin } from 'html-validate';\n\nconst BOOTSTRAP_LEGACY_ATTRIBUTES = [\n  'data-animation',\n  'data-autohide',\n  'data-backdrop',\n  'data-boundary',\n  'data-container',\n  'data-content',\n  'data-custom-class',\n  'data-delay',\n  'data-dismiss',\n  'data-display',\n  'data-fallback-placement',\n  'data-flip',\n  'data-focus',\n  'data-interval',\n  'data-keyboard',\n  'data-html',\n  'data-offset',\n  'data-pause',\n  'data-placement',\n  'data-popper-config',\n  'data-reference',\n  'data-ride',\n  'data-selector',\n  'data-show',\n  'data-spy',\n  'data-target',\n  'data-template',\n  'data-title',\n  'data-toggle',\n  'data-touch',\n  'data-trigger',\n  'data-wrap',\n];\n\nconst BOOTSTRAP_BREAKPOINTS = ['sm-', 'md-', 'lg-', 'xl-', 'xxl-'];\nconst BOOTSTRAP_LEGACY_CLASSES = [\n  'thead-light',\n  'thead-dark',\n  'custom-control.custom-checkbox',\n  'custom-control.custom-radio',\n  'custom-control.custom-switch',\n  'custom-control-input',\n  'custom-control-label',\n  'custom-select',\n  'custom-file',\n  'custom-range',\n  'input-group-prepend',\n  'input-group-append',\n  'form-group',\n  'form-row',\n  'form-inline',\n  ...['ml', 'mr', 'pl', 'pr'].flatMap((prefix) =>\n    ['', ...BOOTSTRAP_BREAKPOINTS].flatMap((breakpoint) =>\n      ['0', '1', '2', '3', '4', '5', 'auto'].map((suffix) => `${prefix}-${breakpoint}${suffix}`),\n    ),\n  ),\n  'badge-primary',\n  'badge-secondary',\n  'badge-success',\n  'badge-danger',\n  'badge-warning',\n  'badge-info',\n  'badge-light',\n  'badge-dark',\n  'badge-pill',\n  'btn-block',\n  'dropdown-menu-right',\n  'dropdown-menu-left',\n  'float-left',\n  'float-right',\n  'border-left',\n  'border-right',\n  'border-left-0',\n  'border-right-0',\n  'rounded-left',\n  'rounded-right',\n  ...BOOTSTRAP_BREAKPOINTS.flatMap((breakpoint) =>\n    ['left', 'right'].map((suffix) => `text-${breakpoint}${suffix}`),\n  ),\n  'text-monospace',\n  'font-weight-light',\n  'font-weight-normal',\n  'font-weight-bold',\n  'font-weight-bolder',\n  'font-weight-lighter',\n  'font-italic',\n  'embed-responsive',\n  'embed-responsive-21by9',\n  'embed-responsive-16by9',\n  'embed-responsive-4by3',\n  'embed-responsive-1by1',\n  'embed-responsive-item',\n  'sr-only',\n  'sr-only-focusable',\n];\n\nclass Bootstrap4ConstructRule extends Rule {\n  public documentation(): RuleDocumentation {\n    return {\n      description: 'Bootstrap 4 constructs should not be used',\n    };\n  }\n  public setup() {\n    this.on('dom:ready', (event: DOMReadyEvent) => {\n      const { document } = event;\n\n      BOOTSTRAP_LEGACY_ATTRIBUTES.forEach((attr) => {\n        document.querySelectorAll(`[${attr}]`).forEach((node) => {\n          // `tom-select` uses a `data-content` attribute on `option` elements.\n          // This is unrelated to Bootstrap, so we don't want to do anything with this.\n          if (attr === 'data-content' && node.tagName === 'OPTION') return;\n\n          this.report({\n            node,\n            message: `Bootstrap 4 attribute \"${attr}\" should not be used. Use \"${attr.replace('data-', 'data-bs-')}\" instead.`,\n          });\n        });\n      });\n\n      BOOTSTRAP_LEGACY_CLASSES.forEach((className) => {\n        document.querySelectorAll(`.${className}`).forEach((node) => {\n          // The version of `bootstrap-table` we're locked to uses the old classname for dropdown-menu-* classes.\n          // It was fixed in this PR:\n          // https://github.com/wenzhixin/bootstrap-table/pull/6796\n          // However, we can't upgrade to that version because of this breaking change:\n          // https://github.com/wenzhixin/bootstrap-table/issues/6745\n          // For now, we'll just ignore this, since we don't control this markup.\n          // For float-* classes, bootstrap-table uses its own implementation.\n          if (\n            ['dropdown-menu-left', 'dropdown-menu-right', 'float-left', 'float-right'].includes(\n              className,\n            ) &&\n            node.closest('.bootstrap-table')\n          ) {\n            return;\n          }\n\n          this.report({\n            node,\n            message: `Bootstrap 4 ${className.includes('.') ? 'combination of classes' : 'class'} \".${className}\" should not be used.`,\n          });\n        });\n      });\n\n      // We used `white text/buttons in \"info\"-colored card headers, but that doesn't\n      // provide sufficient contrast in Bootstrap 5. We'll do our best to patch this\n      // by switching to dark text/buttons in this situation.\n      document.querySelectorAll('.card-header.bg-info.text-white').forEach((node) => {\n        this.report({\n          node,\n          message:\n            'Bootstrap 5 no longer provides sufficient contrast for white text on \"info\"-colored card headers.',\n        });\n      });\n\n      document.querySelectorAll('button.close').forEach((node) => {\n        this.report({\n          node,\n          message: 'Bootstrap 5 replaced the \".close\" class in buttons with \".btn-close\".',\n        });\n      });\n    });\n  }\n}\n\nexport default definePlugin({\n  name: 'bootstrap4-construct',\n  rules: { 'bootstrap4-construct': Bootstrap4ConstructRule },\n});\n"]}