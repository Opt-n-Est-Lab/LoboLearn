{"version":3,"file":"aws.js","sourceRoot":"","sources":["../../src/lib/aws.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,qBAAqB,EAAE,MAAM,+BAA+B,CAAC;AAEtE,OAAO,EAAE,qBAAqB,EAAE,MAAM,mBAAmB,CAAC;AAE1D,OAAO,EAAE,MAAM,EAAE,MAAM,aAAa,CAAC;AAErC,MAAM,iBAAiB,GAAG,qBAAqB,CAAC;IAC9C,WAAW,EAAE,qBAAqB,EAAE;IACpC,eAAe,EAAE,GAAG,EAAE,CAAC,CAAC;QACtB,MAAM,EAAE,MAAM,CAAC,SAAS;KACzB,CAAC;IACF,iBAAiB,EAAE,GAAG,EAAE;QACtB,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;YACzB,kFAAkF;YAClF,0DAA0D;YAC1D,OAAO;gBACL,cAAc,EAAE,IAAI;gBACpB,WAAW,EAAE;oBACX,WAAW,EAAE,QAAQ;oBACrB,eAAe,EAAE,QAAQ;iBAC1B;gBACD,QAAQ,EAAE,uBAAuB;aAClC,CAAC;QACJ,CAAC;QAED,OAAO,EAAE,CAAC;IACZ,CAAC;CACF,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,mBAAmB,GAAG,iBAAiB,CAAC,mBAAmB,CAAC;AACzE,MAAM,CAAC,MAAM,kBAAkB,GAAG,iBAAiB,CAAC,kBAAkB,CAAC","sourcesContent":["import { fromNodeProviderChain } from '@aws-sdk/credential-providers';\n\nimport { makeAwsConfigProvider } from '@prairielearn/aws';\n\nimport { config } from './config.js';\n\nconst awsConfigProvider = makeAwsConfigProvider({\n  credentials: fromNodeProviderChain(),\n  getClientConfig: () => ({\n    region: config.awsRegion,\n  }),\n  getS3ClientConfig: () => {\n    if (!config.runningInEc2) {\n      // If we're not running in EC2, assume we're running with a local s3rver instance.\n      // See https://github.com/jamhall/s3rver for more details.\n      return {\n        forcePathStyle: true,\n        credentials: {\n          accessKeyId: 'S3RVER',\n          secretAccessKey: 'S3RVER',\n        },\n        endpoint: 'http://127.0.0.1:5000',\n      };\n    }\n\n    return {};\n  },\n});\n\nexport const makeAwsClientConfig = awsConfigProvider.makeAwsClientConfig;\nexport const makeS3ClientConfig = awsConfigProvider.makeS3ClientConfig;\n"]}