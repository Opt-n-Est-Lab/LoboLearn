{"version":3,"file":"pg-diff.js","sourceRoot":"","sources":["../../src/bin/pg-diff.ts"],"names":[],"mappings":"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","sourcesContent":["#!/usr/bin/env node\n\nimport yargs from 'yargs';\n\nimport {\n  diffDatabaseAndDirectory,\n  diffDatabases,\n  diffDirectories,\n  diffDirectoryAndDatabase,\n} from '../diff.js';\n\nconst args = yargs(process.argv.slice(2))\n  .usage('Usage: $0 [options]')\n  .option('db', {\n    description: 'reads a description from the named database',\n  })\n  .option('dir', {\n    description: \"reads a description from a directory that's been generated by pg-describe\",\n  })\n  .help('h')\n  .alias('h', 'help')\n  .example(\n    '$0 --db postgres --dir db_dump',\n    'Diffs the database \"postgres\" with the description in the directory \"db_dump\"',\n  )\n  .example(\n    '$0 --db postgres --db old_restore',\n    'Diffs the database \"postgres\" with the database \"old_restore\"',\n  )\n  .strict();\n\nconst argv = args.parseSync();\n\nconst options = {\n  outputFormat: 'string',\n  coloredOutput: process.stdout.isTTY,\n};\n\nif (argv.db && typeof argv.db === 'string' && argv.dir && typeof argv.dir === 'string') {\n  // Ensure correct ordering for the sake of diffs\n  if (process.argv.indexOf('--db') < process.argv.indexOf('--dir')) {\n    diffDatabaseAndDirectory(argv.db, argv.dir, options).then(handleResults, handleError);\n  } else {\n    diffDirectoryAndDatabase(argv.dir, argv.db, options).then(handleResults, handleError);\n  }\n} else if (argv.db && Array.isArray(argv.db) && argv.db.length === 2 && !argv.dir) {\n  diffDatabases(argv.db[0], argv.db[1], options).then(handleResults, handleError);\n} else if (argv.dir && Array.isArray(argv.dir) && argv.dir.length === 2 && !argv.db) {\n  diffDirectories(argv.dir[0], argv.dir[1], options).then(handleResults, handleError);\n} else {\n  args.showHelp();\n  process.exit(1);\n}\n\nfunction handleResults(results: string) {\n  process.stdout.write(results);\n  process.exit(0);\n}\n\nfunction handleError(err: any) {\n  console.error(err);\n  process.exit(1);\n}\n"]}